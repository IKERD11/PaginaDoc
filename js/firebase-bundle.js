(()=>{var ph=Object.defineProperty;var DA=Object.getOwnPropertyDescriptor;var NA=Object.getOwnPropertyNames;var VA=Object.prototype.hasOwnProperty;var w_=(n,e)=>()=>(n&&(e=n(n=0)),e);var Ne=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),OA=(n,e)=>{for(var t in e)ph(n,t,{get:e[t],enumerable:!0})},xA=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of NA(e))!VA.call(n,i)&&i!==t&&ph(n,i,{get:()=>e[i],enumerable:!(r=DA(e,i))||r.enumerable});return n};var LA=n=>xA(ph({},"__esModule",{value:!0}),n);var v_=Ne(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});gh.getDefaultsFromPostinstall=()=>{}});var Pt=Ne(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var MA=v_();var Ha={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var R_=function(n,e){if(!n)throw P_(e)},P_=function(n){return new Error("Firebase Database ("+Ha.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var S_=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},FA=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Th={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,l=u?n[i+2]:0,d=s>>2,p=(s&3)<<4|c>>4,m=(c&15)<<2|l>>6,w=l&63;u||(w=64,o||(m=64)),r.push(t[d],t[p],t[m],t[w])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(S_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):FA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let p=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||l==null||p==null)throw new Ka;let m=s<<2|c>>4;if(r.push(m),l!==64){let w=c<<4&240|l>>2;if(r.push(w),p!==64){let k=l<<6&192|p;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ka=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},C_=function(n){let e=S_(n);return Th.encodeByteArray(e,!0)},_h=function(n){return C_(n).replace(/\./g,"")},Qa=function(n){try{return Th.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function UA(n){return wh(void 0,n)}function wh(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!BA(t)||(n[t]=wh(n[t],e[t]));return n}function BA(n){return n!=="__proto__"}function k_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var qA=()=>k_().__FIREBASE_DEFAULTS__,WA=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},zA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Qa(n[1]);return e&&JSON.parse(e)},Ls=()=>{try{return MA.getDefaultsFromPostinstall()||qA()||WA()||zA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},D_=n=>Ls()?.emulatorHosts?.[n],jA=n=>{let e=D_(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},GA=()=>Ls()?.config,$A=n=>Ls()?.[`_${n}`];var Ja=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function N_(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function HA(n){return(await fetch(n,{credentials:"include"})).ok}function KA(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[_h(JSON.stringify(t)),_h(JSON.stringify(o)),""].join(".")}var xs={};function QA(){let n={prod:[],emulator:[]};for(let e of Object.keys(xs))xs[e]?n.emulator.push(e):n.prod.push(e);return n}function JA(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var A_=!1;function YA(n,e){if(typeof window>"u"||typeof document>"u"||!N_(window.location.host)||xs[n]===e||xs[n]||A_)return;xs[n]=e;function t(m){return`__firebase__banner__${m}`}let r="__firebase__banner",s=QA().prod.length>0;function o(){let m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,w){m.setAttribute("width","24"),m.setAttribute("id",w),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function l(){let m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{A_=!0,o()},m}function d(m,w){m.setAttribute("id",w),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){let m=JA(r),w=t("text"),k=document.getElementById(w)||document.createElement("span"),V=t("learnmore"),x=document.getElementById(V)||document.createElement("a"),H=t("preprendIcon"),X=document.getElementById(H)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){let K=m.element;c(K),d(x,V);let te=l();u(X,H),K.append(X,k,x,te),document.body.appendChild(K)}s?(k.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Ms(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function XA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ms())}function vh(){let n=Ls()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ZA(){return typeof window<"u"||V_()}function V_(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function eb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tb(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function nb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rb(){return Ms().indexOf("Electron/")>=0}function ib(){let n=Ms();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function sb(){return Ms().indexOf("MSAppHost/")>=0}function ob(){return Ha.NODE_CLIENT===!0||Ha.NODE_ADMIN===!0}function ab(){return!vh()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cb(){return!vh()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ub(){try{return typeof indexedDB=="object"}catch{return!1}}function lb(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}function hb(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}var db="FirebaseError",Ya=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=db,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xa.prototype.create)}},Xa=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?fb(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ya(i,c,r)}};function fb(n,e){return n.replace(pb,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var pb=/\{\$([^}]+)}/g;function yh(n){return JSON.parse(n)}function gb(n){return JSON.stringify(n)}var Fs=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=yh(Qa(s[0])||""),t=yh(Qa(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},mb=function(n){let e=Fs(n).claims,t=Math.floor(new Date().getTime()/1e3),r=0,i=0;return typeof e=="object"&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),e.hasOwnProperty("exp")?i=e.exp:i=r+86400),!!t&&!!r&&!!i&&t>=r&&t<=i},_b=function(n){let e=Fs(n).claims;return typeof e=="object"&&e.hasOwnProperty("iat")?e.iat:null},yb=function(n){let e=Fs(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Ib=function(n){let e=Fs(n).claims;return typeof e=="object"&&e.admin===!0};function Eb(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Tb(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function wb(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function vb(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function O_(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(b_(s)&&b_(o)){if(!O_(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function b_(n){return n!==null&&typeof n=="object"}function Ab(n,e=2e3){let t=new Ja;return setTimeout(()=>t.reject("timeout!"),e),n.then(t.resolve,t.reject),t.promise}function bb(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Rb(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Pb(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var Ih=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let p=0;p<16;p++)r[p]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let p=0;p<16;p++)r[p]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let p=16;p<80;p++){let m=r[p-3]^r[p-8]^r[p-14]^r[p-16];r[p]=(m<<1|m>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],c=this.chain_[3],u=this.chain_[4],l,d;for(let p=0;p<80;p++){p<40?p<20?(l=c^s&(o^c),d=1518500249):(l=s^o^c,d=1859775393):p<60?(l=s&o|c&(s|o),d=2400959708):(l=s^o^c,d=3395469782);let m=(i<<5|i>>>27)+l+u+d+r[p]&4294967295;u=c,c=o,o=(s<<30|s>>>2)&4294967295,s=i,i=m}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Sb(n,e){let t=new Eh(n,e);return t.subscribe.bind(t)}var Eh=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");kb(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=mh),i.error===void 0&&(i.error=mh),i.complete===void 0&&(i.complete=mh);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Cb(n,e){return(...t)=>{Promise.resolve(!0).then(()=>{n(...t)}).catch(r=>{e&&e(r)})}}function kb(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function mh(){}var Db=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function Za(n,e){return`${n} failed: ${e} argument `}function Nb(n,e,t){if(!(t&&!e)&&typeof e!="string")throw new Error(Za(n,"namespace")+"must be a valid firebase namespace.")}function Vb(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(Za(n,e)+"must be a valid function.")}function Ob(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(Za(n,e)+"must be a valid context object.")}var xb=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,R_(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Lb=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var Mb=1e3,Fb=2,x_=14400*1e3,L_=.5;function Ub(n,e=Mb,t=Fb){let r=e*Math.pow(t,n),i=Math.round(L_*r*(Math.random()-.5)*2);return Math.min(x_,r+i)}function Bb(n){return Number.isFinite(n)?n+qb(n):`${n}`}function qb(n){n=Math.abs(n);let e=n%100;if(e>=10&&e<=20)return"th";let t=n%10;return t===1?"st":t===2?"nd":t===3?"rd":"th"}function Wb(n){return n&&n._delegate?n._delegate:n}Q.CONSTANTS=Ha;Q.DecodeBase64StringError=Ka;Q.Deferred=Ja;Q.ErrorFactory=Xa;Q.FirebaseError=Ya;Q.MAX_VALUE_MILLIS=x_;Q.RANDOM_FACTOR=L_;Q.Sha1=Ih;Q.areCookiesEnabled=hb;Q.assert=R_;Q.assertionError=P_;Q.async=Cb;Q.base64=Th;Q.base64Decode=Qa;Q.base64Encode=C_;Q.base64urlEncodeWithoutPadding=_h;Q.calculateBackoffMillis=Ub;Q.contains=Eb;Q.createMockUserToken=KA;Q.createSubscribe=Sb;Q.decode=Fs;Q.deepCopy=UA;Q.deepEqual=O_;Q.deepExtend=wh;Q.errorPrefix=Za;Q.extractQuerystring=Pb;Q.getDefaultAppConfig=GA;Q.getDefaultEmulatorHost=D_;Q.getDefaultEmulatorHostnameAndPort=jA;Q.getDefaults=Ls;Q.getExperimentalSetting=$A;Q.getGlobal=k_;Q.getModularInstance=Wb;Q.getUA=Ms;Q.isAdmin=Ib;Q.isBrowser=ZA;Q.isBrowserExtension=tb;Q.isCloudWorkstation=N_;Q.isCloudflareWorker=eb;Q.isElectron=rb;Q.isEmpty=wb;Q.isIE=ib;Q.isIndexedDBAvailable=ub;Q.isMobileCordova=XA;Q.isNode=vh;Q.isNodeSdk=ob;Q.isReactNative=nb;Q.isSafari=ab;Q.isSafariOrWebkit=cb;Q.isUWP=sb;Q.isValidFormat=yb;Q.isValidTimestamp=mb;Q.isWebWorker=V_;Q.issuedAtTime=_b;Q.jsonEval=yh;Q.map=vb;Q.ordinal=Bb;Q.pingServer=HA;Q.promiseWithTimeout=Ab;Q.querystring=bb;Q.querystringDecode=Rb;Q.safeGet=Tb;Q.stringLength=Lb;Q.stringToByteArray=xb;Q.stringify=gb;Q.updateEmulatorBanner=YA;Q.validateArgCount=Db;Q.validateCallback=Vb;Q.validateContextObject=Ob;Q.validateIndexedDBOpenable=lb;Q.validateNamespace=Nb});var qt=Ne(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});var zb=Pt(),Ah=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var yr="[DEFAULT]";var ec=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new zb.Deferred;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Gb(e))try{this.getOrInitializeService({instanceIdentifier:yr})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=yr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=yr){return this.instances.has(e)}getOptions(e=yr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:jb(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=yr){return this.component?this.component.multipleInstances?e:yr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function jb(n){return n===yr?void 0:n}function Gb(n){return n.instantiationMode==="EAGER"}var bh=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ec(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};Us.Component=Ah;Us.ComponentContainer=bh;Us.Provider=ec});var Ir=Ne(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});var Ph=[];de.LogLevel=void 0;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(de.LogLevel||(de.LogLevel={}));var M_={debug:de.LogLevel.DEBUG,verbose:de.LogLevel.VERBOSE,info:de.LogLevel.INFO,warn:de.LogLevel.WARN,error:de.LogLevel.ERROR,silent:de.LogLevel.SILENT},$b=de.LogLevel.INFO,Hb={[de.LogLevel.DEBUG]:"log",[de.LogLevel.VERBOSE]:"log",[de.LogLevel.INFO]:"info",[de.LogLevel.WARN]:"warn",[de.LogLevel.ERROR]:"error"},Kb=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Hb[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Rh=class{constructor(e){this.name=e,this._logLevel=$b,this._logHandler=Kb,this._userLogHandler=null,Ph.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de.LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?M_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.LogLevel.DEBUG,...e),this._logHandler(this,de.LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.LogLevel.VERBOSE,...e),this._logHandler(this,de.LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.LogLevel.INFO,...e),this._logHandler(this,de.LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.LogLevel.WARN,...e),this._logHandler(this,de.LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.LogLevel.ERROR,...e),this._logHandler(this,de.LogLevel.ERROR,...e)}};function Qb(n){Ph.forEach(e=>{e.setLogLevel(n)})}function Jb(n,e){for(let t of Ph){let r=null;e&&e.level&&(r=M_[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let c=o.map(u=>{if(u==null)return null;if(typeof u=="string")return u;if(typeof u=="number"||typeof u=="boolean")return u.toString();if(u instanceof Error)return u.message;try{return JSON.stringify(u)}catch{return null}}).filter(u=>u).join(" ");s>=(r??i.logLevel)&&n({level:de.LogLevel[s].toLowerCase(),message:c,args:o,type:i.name})}}}de.Logger=Rh;de.setLogLevel=Qb;de.setUserLogHandler=Jb});function Xb(){return F_||(F_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Zb(){return U_||(U_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}function eR(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Et(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&B_.set(t,n)}).catch(()=>{}),Dh.set(e,n),e}function tR(n){if(Ch.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Ch.set(n,e)}function W_(n){kh=n(kh)}function nR(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Bs(this),e,...t);return q_.set(r,e.sort?e.sort():[e]),Et(r)}:Zb().includes(n)?function(...e){return n.apply(Bs(this),e),Et(B_.get(this))}:function(...e){return Et(n.apply(Bs(this),e))}}function rR(n){return typeof n=="function"?nR(n):(n instanceof IDBTransaction&&tR(n),Yb(n,Xb())?new Proxy(n,kh):n)}function Et(n){if(n instanceof IDBRequest)return eR(n);if(Sh.has(n))return Sh.get(n);let e=rR(n);return e!==n&&(Sh.set(n,e),Dh.set(e,n)),e}var Yb,F_,U_,B_,Ch,q_,Sh,Dh,kh,Bs,Nh=w_(()=>{Yb=(n,e)=>e.some(t=>n instanceof t);B_=new WeakMap,Ch=new WeakMap,q_=new WeakMap,Sh=new WeakMap,Dh=new WeakMap;kh={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ch.get(n);if(e==="objectStoreNames")return n.objectStoreNames||q_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Et(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};Bs=n=>Dh.get(n)});var j_={};OA(j_,{deleteDB:()=>sR,openDB:()=>iR,unwrap:()=>Bs,wrap:()=>Et});function iR(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),c=Et(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Et(o.result),u.oldVersion,u.newVersion,Et(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}function sR(n,{blocked:e}={}){let t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),Et(t).then(()=>{})}function z_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Vh.get(e))return Vh.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=aR.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||oR.includes(t)))return;let s=async function(o,...c){let u=this.transaction(o,i?"readwrite":"readonly"),l=u.store;return r&&(l=l.index(c.shift())),(await Promise.all([l[t](...c),i&&u.done]))[0]};return Vh.set(e,s),s}var oR,aR,Vh,G_=w_(()=>{Nh();Nh();oR=["get","getKey","getAll","getAllKeys","count"],aR=["put","add","delete","clear"],Vh=new Map;W_(n=>({...n,get:(e,t,r)=>z_(e,t)||n.get(e,t,r),has:(e,t)=>!!z_(e,t)||n.has(e,t)}))});var Er=Ne(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});var li=qt(),qh=Ir(),He=Pt(),cR=(G_(),LA(j_));var xh=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(uR(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function uR(n){return n.getComponent()?.type==="VERSION"}var tc="@firebase/app",Lh="0.14.8";var rn=new qh.Logger("@firebase/app"),lR="@firebase/app-compat",hR="@firebase/analytics-compat",dR="@firebase/analytics",fR="@firebase/app-check-compat",pR="@firebase/app-check",gR="@firebase/auth",mR="@firebase/auth-compat",_R="@firebase/database",yR="@firebase/data-connect",IR="@firebase/database-compat",ER="@firebase/functions",TR="@firebase/functions-compat",wR="@firebase/installations",vR="@firebase/installations-compat",AR="@firebase/messaging",bR="@firebase/messaging-compat",RR="@firebase/performance",PR="@firebase/performance-compat",SR="@firebase/remote-config",CR="@firebase/remote-config-compat",kR="@firebase/storage",DR="@firebase/storage-compat",NR="@firebase/firestore",VR="@firebase/ai",OR="@firebase/firestore-compat",xR="firebase",LR="12.9.0";var Ws="[DEFAULT]",MR={[tc]:"fire-core",[lR]:"fire-core-compat",[dR]:"fire-analytics",[hR]:"fire-analytics-compat",[pR]:"fire-app-check",[fR]:"fire-app-check-compat",[gR]:"fire-auth",[mR]:"fire-auth-compat",[_R]:"fire-rtdb",[yR]:"fire-data-connect",[IR]:"fire-rtdb-compat",[ER]:"fire-fn",[TR]:"fire-fn-compat",[wR]:"fire-iid",[vR]:"fire-iid-compat",[AR]:"fire-fcm",[bR]:"fire-fcm-compat",[RR]:"fire-perf",[PR]:"fire-perf-compat",[SR]:"fire-rc",[CR]:"fire-rc-compat",[kR]:"fire-gcs",[DR]:"fire-gcs-compat",[NR]:"fire-fst",[OR]:"fire-fst-compat",[VR]:"fire-vertex","fire-js":"fire-js",[xR]:"fire-js-all"};var Cn=new Map,hi=new Map,di=new Map;function Mh(n,e){try{n.container.addComponent(e)}catch(t){rn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function FR(n,e){n.container.addOrOverwriteComponent(e)}function nc(n){let e=n.name;if(di.has(e))return rn.debug(`There were multiple attempts to register component ${e}.`),!1;di.set(e,n);for(let t of Cn.values())Mh(t,n);for(let t of hi.values())Mh(t,n);return!0}function J_(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function UR(n,e,t=Ws){J_(n,e).clearInstance(t)}function Wh(n){return n.options!==void 0}function Y_(n){return Wh(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function BR(n){return n==null?!1:n.settings!==void 0}function qR(){di.clear()}var WR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},gt=new He.ErrorFactory("app","Firebase",WR);var rc=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new li.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gt.create("app-deleted",{appName:this._name})}};function $_(n,e){let t=He.base64Decode(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}let i=JSON.parse(t).exp*1e3,s=new Date().getTime();i-s<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}var Fh=class extends rc{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let c=e;super(c.options,o,i)}this._serverConfig={automaticDataCollectionEnabled:s,...t},this._serverConfig.authIdToken&&$_(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&$_(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,qs(tc,Lh,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Z_(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw gt.create("server-app-deleted")}};var zR=LR;function X_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r={name:Ws,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw gt.create("bad-app-name",{appName:String(i)});if(t||(t=He.getDefaultAppConfig()),!t)throw gt.create("no-options");let s=Cn.get(i);if(s){if(He.deepEqual(t,s.options)&&He.deepEqual(r,s.config))return s;throw gt.create("duplicate-app",{appName:i})}let o=new li.ComponentContainer(i);for(let u of di.values())o.addComponent(u);let c=new rc(t,r,o);return Cn.set(i,c),c}function jR(n,e={}){if(He.isBrowser()&&!He.isWebWorker())throw gt.create("invalid-server-app-environment");let t,r=e||{};if(n&&(Wh(n)?t=n.options:Y_(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=He.getDefaultAppConfig()),!t)throw gt.create("no-options");let i={...r,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;let s=d=>[...d].reduce((p,m)=>Math.imul(31,p)+m.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw gt.create("finalization-registry-not-supported",{});let o=""+s(JSON.stringify(i)),c=hi.get(o);if(c)return c.incRefCount(r.releaseOnDeref),c;let u=new li.ComponentContainer(o);for(let d of di.values())u.addComponent(d);let l=new Fh(t,r,o,u);return hi.set(o,l),l}function GR(n=Ws){let e=Cn.get(n);if(!e&&n===Ws&&He.getDefaultAppConfig())return X_();if(!e)throw gt.create("no-app",{appName:n});return e}function $R(){return Array.from(Cn.values())}async function Z_(n){let e=!1,t=n.name;Cn.has(t)?(e=!0,Cn.delete(t)):hi.has(t)&&n.decRefCount()<=0&&(hi.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function qs(n,e,t){let r=MR[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rn.warn(o.join(" "));return}nc(new li.Component(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function HR(n,e){if(n!==null&&typeof n!="function")throw gt.create("invalid-log-argument");qh.setUserLogHandler(n,e)}function KR(n){qh.setLogLevel(n)}var QR="firebase-heartbeat-database",JR=1,zs="firebase-heartbeat-store",Oh=null;function ey(){return Oh||(Oh=cR.openDB(QR,JR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zs)}catch(t){console.warn(t)}}}}).catch(n=>{throw gt.create("idb-open",{originalErrorMessage:n.message})})),Oh}async function YR(n){try{let t=(await ey()).transaction(zs),r=await t.objectStore(zs).get(ty(n));return await t.done,r}catch(e){if(e instanceof He.FirebaseError)rn.warn(e.message);else{let t=gt.create("idb-get",{originalErrorMessage:e?.message});rn.warn(t.message)}}}async function H_(n,e){try{let r=(await ey()).transaction(zs,"readwrite");await r.objectStore(zs).put(e,ty(n)),await r.done}catch(t){if(t instanceof He.FirebaseError)rn.warn(t.message);else{let r=gt.create("idb-set",{originalErrorMessage:t?.message});rn.warn(r.message)}}}function ty(n){return`${n.name}!${n.options.appId}`}var XR=1024,ZR=30,Uh=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Bh(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=K_();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>ZR){let i=tP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){rn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=K_(),{heartbeatsToSend:t,unsentEntries:r}=eP(this._heartbeatsCache.heartbeats),i=He.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return rn.warn(e),""}}};function K_(){return new Date().toISOString().substring(0,10)}function eP(n,e=XR){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Q_(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Q_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Bh=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return He.isIndexedDBAvailable()?He.validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await YR(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return H_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return H_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function Q_(n){return He.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:n})).length}function tP(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function nP(n){nc(new li.Component("platform-logger",e=>new xh(e),"PRIVATE")),nc(new li.Component("heartbeat",e=>new Uh(e),"PRIVATE")),qs(tc,Lh,n),qs(tc,Lh,"cjs2020"),qs("fire-js","")}nP("node");Object.defineProperty(_e,"FirebaseError",{enumerable:!0,get:function(){return He.FirebaseError}});_e.SDK_VERSION=zR;_e._DEFAULT_ENTRY_NAME=Ws;_e._addComponent=Mh;_e._addOrOverwriteComponent=FR;_e._apps=Cn;_e._clearComponents=qR;_e._components=di;_e._getProvider=J_;_e._isFirebaseApp=Wh;_e._isFirebaseServerApp=BR;_e._isFirebaseServerAppSettings=Y_;_e._registerComponent=nc;_e._removeServiceInstance=UR;_e._serverApps=hi;_e.deleteApp=Z_;_e.getApp=GR;_e.getApps=$R;_e.initializeApp=X_;_e.initializeServerApp=jR;_e.onLog=HR;_e.registerVersion=qs;_e.setLogLevel=KR});var js=Ne((Ax,sy)=>{"use strict";var sn=Pt(),rP=qt(),Dn=Er(),iP=Ir();function sP(n){if(n&&n.__esModule)return n;var e=Object.create(null);return n&&Object.keys(n).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}}),e.default=n,Object.freeze(e)}var kn=sP(Dn);var zh=class{constructor(e,t){this._delegate=e,this.firebase=t,Dn._addComponent(e,new rP.Component("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Dn.deleteApp(this._delegate)))}_getService(e,t=Dn._DEFAULT_ENTRY_NAME){this._delegate.checkDestroyed();let r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Dn._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Dn._addComponent(this._delegate,e)}_addOrOverwriteComponent(e){Dn._addOrOverwriteComponent(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var oP={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},ny=new sn.ErrorFactory("app-compat","Firebase",oP);function aP(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:kn.registerVersion,setLogLevel:kn.setLogLevel,onLog:kn.onLog,apps:null,SDK_VERSION:kn.SDK_VERSION,INTERNAL:{registerComponent:c,removeApp:r,useAsService:u,modularAPIs:kn}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||kn._DEFAULT_ENTRY_NAME,!sn.contains(e,l))throw ny.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let p=kn.initializeApp(l,d);if(sn.contains(e,p.name))return e[p.name];let m=new n(p,t);return e[p.name]=m,m}function o(){return Object.keys(e).map(l=>e[l])}function c(l){let d=l.name,p=d.replace("-compat","");if(kn._registerComponent(l)&&l.type==="PUBLIC"){let m=(w=i())=>{if(typeof w[p]!="function")throw ny.create("invalid-app-argument",{appName:d});return w[p]()};l.serviceProps!==void 0&&sn.deepExtend(m,l.serviceProps),t[p]=m,n.prototype[p]=function(...w){return this._getService.bind(this,d).apply(this,l.multipleInstances?w:[])}}return l.type==="PUBLIC"?t[p]:null}function u(l,d){return d==="serverAuth"?null:d}return t}function iy(){let n=aP(zh);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:iy,extendNamespace:e,createSubscribe:sn.createSubscribe,ErrorFactory:sn.ErrorFactory,deepExtend:sn.deepExtend};function e(t){sn.deepExtend(n,t)}return n}var cP=iy();var ry=new iP.Logger("@firebase/app-compat"),uP="@firebase/app-compat",lP="0.5.8";function hP(n){Dn.registerVersion(uP,lP,n)}try{let n=sn.getGlobal();if(n.firebase!==void 0){ry.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);let e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&ry.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}var dP=cP;hP();sy.exports=dP});var cy=Ne((bx,ay)=>{"use strict";var fP=js();function pP(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var oy=pP(fP),gP="firebase",mP="12.9.0";oy.default.registerVersion(gP,mP,"app-compat");ay.exports=oy.default});var yI=Ne(L=>{"use strict";var ue=Er(),B=Pt(),Pd=Ir(),uy=qt();var _P={PHONE:"phone",TOTP:"totp"},yP={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},IP={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},EP={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},TP={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function wP(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function Sy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var vP=wP,Cy=Sy,ky=new B.ErrorFactory("auth","Firebase",Sy()),AP={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_PASSWORD:"auth/missing-password",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"};var cc=new Pd.Logger("@firebase/auth");function bP(n,...e){cc.logLevel<=Pd.LogLevel.WARN&&cc.warn(`Auth (${ue.SDK_VERSION}): ${n}`,...e)}function oc(n,...e){cc.logLevel<=Pd.LogLevel.ERROR&&cc.error(`Auth (${ue.SDK_VERSION}): ${n}`,...e)}function rt(n,...e){throw Cd(n,...e)}function Ke(n,...e){return Cd(n,...e)}function Sd(n,e,t){let r={...Cy(),[e]:t};return new B.ErrorFactory("auth","Firebase",r).create(e,{appName:n.name})}function ze(n){return Sd(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mi(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&rt(n,"argument-error"),Sd(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Cd(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ky.create(n,...e)}function W(n,e,...t){if(!n)throw Cd(e,...t)}function Wt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw oc(e),new Error(e)}function jt(n,e){n||Wt(e)}function Zs(){return typeof self<"u"&&self.location?.href||""}function kd(){return ly()==="http:"||ly()==="https:"}function ly(){return typeof self<"u"&&self.location?.protocol||null}function RP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kd()||B.isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function PP(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Tr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,jt(t>e,"Short delay should be less than long delay!"),this.isMobile=B.isMobileCordova()||B.isReactNative()}get(){return RP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Dd(n,e){jt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var eo=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var SP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var CP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],kP=new Tr(3e4,6e4);function ye(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ie(n,e,t,r,i={}){return Dy(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let c=B.querystring({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);let l={method:e,headers:u,...s};return B.isCloudflareWorker()||(l.referrerPolicy="no-referrer"),n.emulatorConfig&&B.isCloudWorkstation(n.emulatorConfig.host)&&(l.credentials="include"),eo.fetch()(await Ny(n,n.config.apiHost,t,c),l)})}async function Dy(n,e,t){n._canInitEmulator=!1;let r={...SP,...e};try{let i=new Yh(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw $s(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[u,l]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw $s(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw $s(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw $s(n,"user-disabled",o);let d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Sd(n,d,l);rt(n,d)}}catch(i){if(i instanceof B.FirebaseError)throw i;rt(n,"network-request-failed",{message:String(i)})}}async function ln(n,e,t,r,i={}){let s=await Ie(n,e,t,r,i);return"mfaPendingCredential"in s&&rt(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Ny(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?Dd(n.config,i):`${n.config.apiScheme}://${i}`;return CP.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function DP(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Yh=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ke(this.auth,"network-request-failed")),kP.get())})}};function $s(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ke(n,e,r);return i.customData._tokenResponse=t,i}function hy(n){return n!==void 0&&n.getResponse!==void 0}function dy(n){return n!==void 0&&n.enterprise!==void 0}var uc=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return DP(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function NP(n){return(await Ie(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Vy(n,e){return Ie(n,"GET","/v2/recaptchaConfig",ye(n,e))}async function VP(n,e){return Ie(n,"POST","/v1/accounts:delete",e)}async function OP(n,e){return Ie(n,"POST","/v1/accounts:update",e)}async function lc(n,e){return Ie(n,"POST","/v1/accounts:lookup",e)}function Hs(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function xP(n,e=!1){return B.getModularInstance(n).getIdToken(e)}async function Oy(n,e=!1){let t=B.getModularInstance(n),r=await t.getIdToken(e),i=Vc(r);W(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Hs(jh(i.auth_time)),issuedAtTime:Hs(jh(i.iat)),expirationTime:Hs(jh(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function jh(n){return Number(n)*1e3}function Vc(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return oc("JWT malformed, contained fewer than 3 sections"),null;try{let i=B.base64Decode(t);return i?JSON.parse(i):(oc("Failed to decode base64 JWT payload"),null)}catch(i){return oc("Caught error parsing JWT payload as JSON",i?.toString()),null}}function fy(n){let e=Vc(n);return W(e,"internal-error"),W(typeof e.exp<"u","internal-error"),W(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function cn(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof B.FirebaseError&&LP(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function LP({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Xh=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var to=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hs(this.lastLoginAt),this.creationTime=Hs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function no(n){let e=n.auth,t=await n.getIdToken(),r=await cn(n,lc(e,{idToken:t}));W(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let s=i.providerUserInfo?.length?Ly(i.providerUserInfo):[],o=MP(n.providerData,s),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,l=c?u:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new to(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(n,d)}async function xy(n){let e=B.getModularInstance(n);await no(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function MP(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Ly(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function FP(n,e){let t=await Dy(n,{},async()=>{let r=B.querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await Ny(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let u={method:"POST",headers:c,body:r};return n.emulatorConfig&&B.isCloudWorkstation(n.emulatorConfig.host)&&(u.credentials="include"),eo.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function UP(n,e){return Ie(n,"POST","/v2/accounts:revokeToken",ye(n,e))}var Ks=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){W(e.idToken,"internal-error"),W(typeof e.idToken<"u","internal-error"),W(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){W(e.length!==0,"internal-error");let t=fy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(W(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await FP(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(W(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(W(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(W(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Wt("not implemented")}};function Nn(n,e){W(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var on=class n{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Xh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new to(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await cn(this,this.stsTokenManager.getToken(this.auth,e));return W(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Oy(this,e)}reload(){return xy(this)}_assign(e){this!==e&&(W(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){W(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await no(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ue._isFirebaseServerApp(this.auth.app))return Promise.reject(ze(this.auth));let e=await this.getIdToken();return await cn(this,VP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,l=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:w,providerData:k,stsTokenManager:V}=t;W(p&&V,e,"internal-error");let x=Ks.fromJSON(this.name,V);W(typeof p=="string",e,"internal-error"),Nn(r,e.name),Nn(i,e.name),W(typeof m=="boolean",e,"internal-error"),W(typeof w=="boolean",e,"internal-error"),Nn(s,e.name),Nn(o,e.name),Nn(c,e.name),Nn(u,e.name),Nn(l,e.name),Nn(d,e.name);let H=new n({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:w,photoURL:o,phoneNumber:s,tenantId:c,stsTokenManager:x,createdAt:l,lastLoginAt:d});return k&&Array.isArray(k)&&(H.providerData=k.map(X=>({...X}))),u&&(H._redirectEventId=u),H}static async _fromIdTokenResponse(e,t,r=!1){let i=new Ks;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await no(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];W(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Ly(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new Ks;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new to(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,l),u}};var py=new Map;function zt(n){jt(n instanceof Function,"Expected a class definition");let e=py.get(n);return e?(jt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,py.set(n,e),e)}var hc=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}};hc.type="NONE";var Zh=hc;function Qs(n,e,t){return`firebase:${n}:${e}:${t}`}var dc=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Qs(this.userKey,i.apiKey,s),this.fullPersistenceKey=Qs("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await lc(this.auth,{idToken:e}).catch(()=>{});return t?on._fromGetAccountInfoResponse(this.auth,t,e):null}return on._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(zt(Zh),e,r);let i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l),s=i[0]||zt(Zh),o=Qs(r,e.config.apiKey,e.name),c=null;for(let l of t)try{let d=await l._get(o);if(d){let p;if(typeof d=="string"){let m=await lc(e,{idToken:d}).catch(()=>{});if(!m)break;p=await on._fromGetAccountInfoResponse(e,m,d)}else p=on._fromJSON(e,d);l!==s&&(c=p),s=l;break}}catch{}let u=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&await s._set(o,c.toJSON()),await Promise.all(t.map(async l=>{if(l!==s)try{await l._remove(o)}catch{}})),new n(s,e,r))}};function gy(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(By(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(My(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qy(e))return"Blackberry";if(Wy(e))return"Webos";if(Fy(e))return"Safari";if((e.includes("chrome/")||Uy(e))&&!e.includes("edge/"))return"Chrome";if(Nd(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function My(n=B.getUA()){return/firefox\//i.test(n)}function Fy(n=B.getUA()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Uy(n=B.getUA()){return/crios\//i.test(n)}function By(n=B.getUA()){return/iemobile/i.test(n)}function Nd(n=B.getUA()){return/android/i.test(n)}function qy(n=B.getUA()){return/blackberry/i.test(n)}function Wy(n=B.getUA()){return/webos/i.test(n)}function Oc(n=B.getUA()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function BP(n=B.getUA()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function qP(n=B.getUA()){return Oc(n)&&!!window.navigator?.standalone}function WP(){return B.isIE()&&document.documentMode===10}function zy(n=B.getUA()){return Oc(n)||Nd(n)||Wy(n)||qy(n)||/windows phone/i.test(n)||By(n)}function Vd(n,e=[]){let t;switch(n){case"Browser":t=gy(B.getUA());break;case"Worker":t=`${gy(B.getUA())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ue.SDK_VERSION}/${r}`}var ed=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let u=e(s);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function zP(n,e={}){return Ie(n,"GET","/v2/passwordPolicy",ye(n,e))}var jP=6,td=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??jP,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var fc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pc(this),this.idTokenSubscription=new pc(this),this.beforeStateQueue=new ed(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ky,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await dc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await lc(this,{idToken:e}),r=await on._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ue._isFirebaseServerApp(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!s||s===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return W(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await no(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ue._isFirebaseServerApp(this.app))return Promise.reject(ze(this));let t=e?B.getModularInstance(e):null;return t&&W(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&W(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ue._isFirebaseServerApp(this.app)?Promise.reject(ze(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ue._isFirebaseServerApp(this.app)?Promise.reject(ze(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await zP(this),t=new td(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new B.ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await UP(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&zt(e)||this._popupRedirectResolver;W(t,this,"argument-error"),this.redirectPersistenceManager=await dc.create(this,[zt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(W(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return W(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Vd(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ue._isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&bP(`Error while retrieving App Check token: ${e.error}`),e?.token}};function be(n){return B.getModularInstance(n)}var pc=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=B.createSubscribe(t=>this.observer=t)}get next(){return W(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var po={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function GP(n){po=n}function Od(n){return po.loadJS(n)}function $P(){return po.recaptchaV2Script}function HP(){return po.recaptchaEnterpriseScript}function KP(){return po.gapiScript}function jy(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var QP=500,JP=6e4,ic=1e12,nd=class{constructor(e){this.auth=e,this.counter=ic,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new sd(e,this.auth.name,t||{})),this.counter++,r}reset(e){let t=e||ic;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){let t=e||ic;return this._widgets.get(t)?.getResponse()||""}async execute(e){let t=e||ic;return this._widgets.get(t)?.execute(),""}},rd=class{constructor(){this.enterprise=new id}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},id=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},sd=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;W(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=YP(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},JP)},QP))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function YP(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var XP="recaptcha-enterprise",Js="NO_RECAPTCHA",gc=class{constructor(e){this.type=XP,this.auth=be(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,c)=>{Vy(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let l=new uc(u);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(u=>{c(u)})})}function i(s,o,c){let u=window.grecaptcha;dy(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(Js)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new rd().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(c=>{if(!t&&dy(window.grecaptcha))i(c,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=HP();u.length!==0&&(u+=c),Od(u).then(()=>{i(c,s,o)}).catch(l=>{o(l)})}}).catch(c=>{o(c)})})}};async function Gs(n,e,t,r=!1,i=!1){let s=new gc(n),o;if(i)o=Js;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}let c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let u=c.phoneEnrollmentInfo.phoneNumber,l=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Vn(n,e,t,r,i){if(i==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=await Gs(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=await Gs(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)});else if(i==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let s=await Gs(n,e,t);return r(n,s).catch(async o=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(o.code==="auth/missing-recaptcha-token"||o.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let c=await Gs(n,e,t,!1,!0);return r(n,c)}return Promise.reject(o)})}else{let s=await Gs(n,e,t,!1,!0);return r(n,s)}else return Promise.reject(i+" provider is not supported.")}async function Gy(n){let e=be(n),t=await Vy(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new uc(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new gc(e).verify()}function $y(n,e){let t=ue._getProvider(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(B.deepEqual(s,e??{}))return i;rt(i,"already-initialized")}return t.initialize({options:e})}function ZP(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(zt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Hy(n,e,t){let r=be(n);W(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Ky(e),{host:o,port:c}=eS(e),u=c===null?"":`:${c}`,l={url:`${s}//${o}${u}/`},d=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){W(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),W(B.deepEqual(l,r.config.emulator)&&B.deepEqual(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,B.isCloudWorkstation(o)?(B.pingServer(`${s}//${o}${u}`),B.updateEmulatorBanner("Auth",!0)):i||tS()}function Ky(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function eS(n){let e=Ky(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:my(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:my(o)}}}function my(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function tS(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var xn=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wt("not implemented")}_getIdTokenResponse(e){return Wt("not implemented")}_linkToIdToken(e,t){return Wt("not implemented")}_getReauthenticationResolver(e){return Wt("not implemented")}};async function Qy(n,e){return Ie(n,"POST","/v1/accounts:resetPassword",ye(n,e))}async function nS(n,e){return Ie(n,"POST","/v1/accounts:update",e)}async function rS(n,e){return Ie(n,"POST","/v1/accounts:signUp",e)}async function iS(n,e){return Ie(n,"POST","/v1/accounts:update",ye(n,e))}async function sS(n,e){return ln(n,"POST","/v1/accounts:signInWithPassword",ye(n,e))}async function xc(n,e){return Ie(n,"POST","/v1/accounts:sendOobCode",ye(n,e))}async function oS(n,e){return xc(n,e)}async function aS(n,e){return xc(n,e)}async function cS(n,e){return xc(n,e)}async function uS(n,e){return xc(n,e)}async function lS(n,e){return ln(n,"POST","/v1/accounts:signInWithEmailLink",ye(n,e))}async function hS(n,e){return ln(n,"POST","/v1/accounts:signInWithEmailLink",ye(n,e))}var ro=class n extends xn{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vn(e,t,"signInWithPassword",sS,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return lS(e,{email:this._email,oobCode:this._password});default:rt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vn(e,r,"signUpPassword",rS,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return hS(e,{idToken:t,email:this._email,oobCode:this._password});default:rt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function an(n,e){return ln(n,"POST","/v1/accounts:signInWithIdp",ye(n,e))}var dS="http://localhost",un=class n extends xn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):rt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return an(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,an(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,an(e,t)}buildRequest(){let e={requestUri:dS,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=B.querystring(t)}return e}};async function _y(n,e){return Ie(n,"POST","/v1/accounts:sendVerificationCode",ye(n,e))}async function fS(n,e){return ln(n,"POST","/v1/accounts:signInWithPhoneNumber",ye(n,e))}async function pS(n,e){let t=await ln(n,"POST","/v1/accounts:signInWithPhoneNumber",ye(n,e));if(t.temporaryProof)throw $s(n,"account-exists-with-different-credential",t);return t}var gS={USER_NOT_FOUND:"user-not-found"};async function mS(n,e){let t={...e,operation:"REAUTH"};return ln(n,"POST","/v1/accounts:signInWithPhoneNumber",ye(n,t),gS)}var fi=class n extends xn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return fS(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return pS(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return mS(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function _S(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yS(n){let e=B.querystringDecode(B.extractQuerystring(n)).link,t=e?B.querystringDecode(B.extractQuerystring(e)).deep_link_id:null,r=B.querystringDecode(B.extractQuerystring(n)).deep_link_id;return(r?B.querystringDecode(B.extractQuerystring(r)).link:null)||r||t||e||n}var pi=class n{constructor(e){let t=B.querystringDecode(B.extractQuerystring(e)),r=t.apiKey??null,i=t.oobCode??null,s=_S(t.mode??null);W(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t=yS(e);try{return new n(t)}catch{return null}}};function IS(n){return pi.parseLink(n)}var Ln=class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,t){return ro._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=pi.parseLink(t);return W(r,"argument-error"),ro._fromEmailAndCode(e,r.code,r.tenantId)}};Ln.PROVIDER_ID="password";Ln.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ln.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var St=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Mn=class extends St{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},od=class n extends Mn{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return W("providerId"in t&&"signInMethod"in t,"argument-error"),un._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return W(e.idToken||e.accessToken,"argument-error"),un._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:c}=e;if(!r&&!i&&!t&&!s||!c)return null;try{return new n(c)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var io=class n extends Mn{constructor(){super("facebook.com")}static credential(e){return un._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return n.credential(e.oauthAccessToken)}catch{return null}}};io.FACEBOOK_SIGN_IN_METHOD="facebook.com";io.PROVIDER_ID="facebook.com";var so=class n extends Mn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return un._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return n.credential(t,r)}catch{return null}}};so.GOOGLE_SIGN_IN_METHOD="google.com";so.PROVIDER_ID="google.com";var oo=class n extends Mn{constructor(){super("github.com")}static credential(e){return un._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return n.credential(e.oauthAccessToken)}catch{return null}}};oo.GITHUB_SIGN_IN_METHOD="github.com";oo.PROVIDER_ID="github.com";var ES="http://localhost",ao=class n extends xn{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return an(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,an(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,an(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:ES,returnSecureToken:!0,pendingToken:this.pendingToken}}};var TS="saml.",ad=class n extends St{constructor(e){W(e.startsWith(TS),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=ao.fromJSON(e);return W(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return ao._create(r,t)}catch{return null}}};var co=class n extends Mn{constructor(){super("twitter.com")}static credential(e,t){return un._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return n.credential(t,r)}catch{return null}}};co.TWITTER_SIGN_IN_METHOD="twitter.com";co.PROVIDER_ID="twitter.com";async function Jy(n,e){return ln(n,"POST","/v1/accounts:signUp",ye(n,e))}var Ct=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await on._fromIdTokenResponse(e,r,i),o=yy(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=yy(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function yy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function wS(n){if(ue._isFirebaseServerApp(n.app))return Promise.reject(ze(n));let e=be(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Ct({user:e.currentUser,providerId:null,operationType:"signIn"});let t=await Jy(e,{returnSecureToken:!0}),r=await Ct._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}var cd=class n extends B.FirebaseError{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Yy(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?cd._fromErrorAndOperation(n,s,e,r):s})}function Xy(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function vS(n,e){let t=B.getModularInstance(n);await Lc(!0,t,e);let{providerUserInfo:r}=await OP(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=Xy(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function xd(n,e,t=!1){let r=await cn(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ct._forOperation(n,"link",r)}async function Lc(n,e,t){await no(e);let r=Xy(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";W(r.has(t)===n,e.auth,i)}async function Zy(n,e,t=!1){let{auth:r}=n;if(ue._isFirebaseServerApp(r.app))return Promise.reject(ze(r));let i="reauthenticate";try{let s=await cn(n,Yy(r,i,e,n),t);W(s.idToken,r,"internal-error");let o=Vc(s.idToken);W(o,r,"internal-error");let{sub:c}=o;return W(n.uid===c,r,"user-mismatch"),Ct._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&rt(r,"user-mismatch"),s}}async function eI(n,e,t=!1){if(ue._isFirebaseServerApp(n.app))return Promise.reject(ze(n));let r="signIn",i=await Yy(n,r,e),s=await Ct._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Mc(n,e){return eI(be(n),e)}async function tI(n,e){let t=B.getModularInstance(n);return await Lc(!1,t,e.providerId),xd(t,e)}async function nI(n,e){return Zy(B.getModularInstance(n),e)}async function AS(n,e){return ln(n,"POST","/v1/accounts:signInWithCustomToken",ye(n,e))}async function bS(n,e){if(ue._isFirebaseServerApp(n.app))return Promise.reject(ze(n));let t=be(n),r=await AS(t,{token:e,returnSecureToken:!0}),i=await Ct._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}var wr=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?ud._fromServerResponse(e,t):"totpInfo"in t?ld._fromServerResponse(e,t):rt(e,"internal-error")}},ud=class n extends wr{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},ld=class n extends wr{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function Fc(n,e,t){W(t.url?.length>0,n,"invalid-continue-uri"),W(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),W(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(W(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(W(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Ld(n){let e=be(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function RS(n,e,t){let r=be(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Fc(r,i,t),await Vn(r,i,"getOobCode",aS,"EMAIL_PASSWORD_PROVIDER")}async function PS(n,e,t){await Qy(B.getModularInstance(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Ld(n),r})}async function SS(n,e){await iS(B.getModularInstance(n),{oobCode:e})}async function rI(n,e){let t=B.getModularInstance(n),r=await Qy(t,{oobCode:e}),i=r.requestType;switch(W(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":W(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":W(r.mfaInfo,t,"internal-error");default:W(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=wr._fromServerResponse(be(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function CS(n,e){let{data:t}=await rI(B.getModularInstance(n),e);return t.email}async function kS(n,e,t){if(ue._isFirebaseServerApp(n.app))return Promise.reject(ze(n));let r=be(n),o=await Vn(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Jy,"EMAIL_PASSWORD_PROVIDER").catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Ld(n),u}),c=await Ct._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function DS(n,e,t){return ue._isFirebaseServerApp(n.app)?Promise.reject(ze(n)):Mc(B.getModularInstance(n),Ln.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Ld(n),r})}async function NS(n,e,t){let r=be(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,c){W(c.handleCodeInApp,r,"argument-error"),c&&Fc(r,o,c)}s(i,t),await Vn(r,i,"getOobCode",cS,"EMAIL_PASSWORD_PROVIDER")}function VS(n,e){return pi.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function OS(n,e,t){if(ue._isFirebaseServerApp(n.app))return Promise.reject(ze(n));let r=B.getModularInstance(n),i=Ln.credentialWithLink(e,t||Zs());return W(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Mc(r,i)}async function xS(n,e){return Ie(n,"POST","/v1/accounts:createAuthUri",ye(n,e))}async function LS(n,e){let t=kd()?Zs():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await xS(B.getModularInstance(n),r);return i||[]}async function MS(n,e){let t=B.getModularInstance(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Fc(t.auth,i,e);let{email:s}=await oS(t.auth,i);s!==n.email&&await n.reload()}async function FS(n,e,t){let r=B.getModularInstance(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Fc(r.auth,s,t);let{email:o}=await uS(r.auth,s);o!==n.email&&await n.reload()}async function US(n,e){return Ie(n,"POST","/v1/accounts:update",e)}async function BS(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let r=B.getModularInstance(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await cn(r,US(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;let c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function qS(n,e){let t=B.getModularInstance(n);return ue._isFirebaseServerApp(t.auth.app)?Promise.reject(ze(t.auth)):iI(t,e,null)}function WS(n,e){return iI(B.getModularInstance(n),null,e)}async function iI(n,e,t){let{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=await cn(n,nS(r,s));await n._updateTokensIfNecessary(o,!0)}function zS(n){if(!n)return null;let{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&n?.idToken){let i=Vc(n.idToken)?.firebase?.sign_in_provider;if(i){let s=i!=="anonymous"&&i!=="custom"?i:null;return new On(r,s)}}if(!e)return null;switch(e){case"facebook.com":return new hd(r,t);case"github.com":return new dd(r,t);case"google.com":return new fd(r,t);case"twitter.com":return new pd(r,t,n.screenName||null);case"custom":case"anonymous":return new On(r,null);default:return new On(r,e,t)}}var On=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},mc=class extends On{constructor(e,t,r,i){super(e,t,r),this.username=i}},hd=class extends On{constructor(e,t){super(e,"facebook.com",t)}},dd=class extends mc{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},fd=class extends On{constructor(e,t){super(e,"google.com",t)}},pd=class extends mc{constructor(e,t,r){super(e,"twitter.com",t,r)}};function jS(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:zS(t)}function GS(n,e){return B.getModularInstance(n).setPersistence(e)}function $S(n){return Gy(n)}async function HS(n,e){return be(n).validatePassword(e)}function sI(n,e,t,r){return B.getModularInstance(n).onIdTokenChanged(e,t,r)}function oI(n,e,t){return B.getModularInstance(n).beforeAuthStateChanged(e,t)}function KS(n,e,t,r){return B.getModularInstance(n).onAuthStateChanged(e,t,r)}function QS(n){B.getModularInstance(n).useDeviceLanguage()}function JS(n,e){return B.getModularInstance(n).updateCurrentUser(e)}function YS(n){return B.getModularInstance(n).signOut()}function XS(n,e){return be(n).revokeAccessToken(e)}async function ZS(n){return B.getModularInstance(n).delete()}var _c=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var gd=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=be(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(c=>wr._fromServerResponse(r,c));W(i.mfaPendingCredential,r,"internal-error");let o=_c._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,async c=>{let u=await c._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l={...i,idToken:u.idToken,refreshToken:u.refreshToken};switch(t.operationType){case"signIn":let d=await Ct._fromIdTokenResponse(r,t.operationType,l);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return W(t.user,r,"internal-error"),Ct._forOperation(t.user,t.operationType,l);default:rt(r,"internal-error")}})}async resolveSignIn(e){let t=e;return this.signInResolver(t)}};function eC(n,e){let t=B.getModularInstance(n),r=e;return W(e.customData.operationType,t,"argument-error"),W(r.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),gd._fromError(t,r)}function Iy(n,e){return Ie(n,"POST","/v2/accounts/mfaEnrollment:start",ye(n,e))}function tC(n,e){return Ie(n,"POST","/v2/accounts/mfaEnrollment:finalize",ye(n,e))}function nC(n,e){return Ie(n,"POST","/v2/accounts/mfaEnrollment:start",ye(n,e))}function rC(n,e){return Ie(n,"POST","/v2/accounts/mfaEnrollment:finalize",ye(n,e))}function iC(n,e){return Ie(n,"POST","/v2/accounts/mfaEnrollment:withdraw",ye(n,e))}var md=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>wr._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}async getSession(){return _c._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){let r=e,i=await this.getSession(),s=await cn(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){let t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{let i=await cn(this.user,iC(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}},Gh=new WeakMap;function sC(n){let e=B.getModularInstance(n);return Gh.has(e)||Gh.set(e,md._fromUser(e)),Gh.get(e)}var yc="__sak";var Ic=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yc,"1"),this.storage.removeItem(yc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var oC=1e3,aC=10,Ec=class extends Ic{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zy(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}let r=e.key;t?this.detachListener():this.stopPolling();let i=()=>{let o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);WP()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,aC):i()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},oC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}};Ec.type="LOCAL";var aI=Ec;var cC=1e3;function $h(n){let e=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),t=RegExp(`${e}=([^;]+)`);return document.cookie.match(t)?.[1]??null}function Hh(n){return`${window.location.protocol==="http:"?"__dev_":"__HOST-"}FIREBASE_${n.split(":")[3]}`}var Tc=class{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(typeof window===void 0)return e;let t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return typeof isSecureContext=="boolean"&&!isSecureContext||typeof navigator>"u"||typeof document>"u"?!1:navigator.cookieEnabled??!0}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;let t=Hh(e);return window.cookieStore?(await window.cookieStore.get(t))?.value:$h(t)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;let r=Hh(e);document.cookie=`${r}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;let r=Hh(e);if(window.cookieStore){let c=(l=>{let d=l.changed.find(m=>m.name===r);d&&t(d.value),l.deleted.find(m=>m.name===r)&&t(null)}),u=()=>window.cookieStore.removeEventListener("change",c);return this.listenerUnsubscribes.set(t,u),window.cookieStore.addEventListener("change",c)}let i=$h(r),s=setInterval(()=>{let c=$h(r);c!==i&&(t(c),i=c)},cC),o=()=>clearInterval(s);this.listenerUnsubscribes.set(t,o)}_removeListener(e,t){let r=this.listenerUnsubscribes.get(t);r&&(r(),this.listenerUnsubscribes.delete(t))}};Tc.type="COOKIE";var uC=Tc;var wc=class extends Ic{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}};wc.type="SESSION";var Md=wc;function lC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var vc=class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;let r=new n(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});let c=Array.from(o).map(async l=>l(t.origin,s)),u=await lC(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};vc.receivers=[];function go(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var _d=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((c,u)=>{let l=go("",20);i.port1.start();let d=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){let m=p;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(m.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function Ve(){return window}function hC(n){Ve().location.href=n}function Fd(){return typeof Ve().WorkerGlobalScope<"u"&&typeof Ve().importScripts=="function"}async function dC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fC(){return navigator?.serviceWorker?.controller||null}function pC(){return Fd()?self:null}var cI="firebaseLocalStorageDb",gC=1,Ac="firebaseLocalStorage",uI="fbase_key",vr=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Uc(n,e){return n.transaction([Ac],e?"readwrite":"readonly").objectStore(Ac)}function mC(){let n=indexedDB.deleteDatabase(cI);return new vr(n).toPromise()}function yd(){let n=indexedDB.open(cI,gC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Ac,{keyPath:uI})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(Ac)?e(r):(r.close(),await mC(),e(await yd()))})})}async function Ey(n,e,t){let r=Uc(n,!0).put({[uI]:e,value:t});return new vr(r).toPromise()}async function _C(n,e){let t=Uc(n,!1).get(e),r=await new vr(t).toPromise();return r===void 0?null:r.value}function Ty(n,e){let t=Uc(n,!0).delete(e);return new vr(t).toPromise()}var yC=800,IC=3,bc=class{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yd(),this.db)}async _withRetries(e){let t=0;for(;;)try{let r=await this._openDb();return await e(r)}catch(r){if(t++>IC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Fd()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vc._getInstance(pC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await dC(),!this.activeServiceWorker)return;this.sender=new _d(this.activeServiceWorker);let e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await yd();return await Ey(e,yc,"1"),await Ty(e,yc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ey(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(r=>_C(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Ty(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(i=>{let s=Uc(i,!1).getAll();return new vr(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];let t=[],r=new Set;if(e.length!==0)for(let{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(let i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};bc.type="LOCAL";var lI=bc;function wy(n,e){return Ie(n,"POST","/v2/accounts/mfaSignIn:start",ye(n,e))}function EC(n,e){return Ie(n,"POST","/v2/accounts/mfaSignIn:finalize",ye(n,e))}function TC(n,e){return Ie(n,"POST","/v2/accounts/mfaSignIn:finalize",ye(n,e))}var Kh=jy("rcb"),wC=new Tr(3e4,6e4),Id=class{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Ve().grecaptcha?.render}load(e,t=""){return W(vC(t),e,"argument-error"),this.shouldResolveImmediately(t)&&hy(Ve().grecaptcha)?Promise.resolve(Ve().grecaptcha):new Promise((r,i)=>{let s=Ve().setTimeout(()=>{i(Ke(e,"network-request-failed"))},wC.get());Ve()[Kh]=()=>{Ve().clearTimeout(s),delete Ve()[Kh];let c=Ve().grecaptcha;if(!c||!hy(c)){i(Ke(e,"internal-error"));return}let u=c.render;c.render=(l,d)=>{let p=u(l,d);return this.counter++,p},this.hostLanguage=t,r(c)};let o=`${$P()}?${B.querystring({onload:Kh,render:"explicit",hl:t})}`;Od(o).catch(()=>{clearTimeout(s),i(Ke(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Ve().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function vC(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var Ed=class{async load(e){return new nd(e)}clearedOneInstance(){}};var Ys="recaptcha",AC={theme:"light",type:"image"},Td=class{constructor(e,t,r={...AC}){this.parameters=r,this.type=Ys,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=be(e),this.isInvisible=this.parameters.size==="invisible",W(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;W(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ed:new Id,this.validateStartingState()}async verify(){this.assertNotDestroyed();let e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){W(!this.parameters.sitekey,this.auth,"argument-error"),W(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),W(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=Ve()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){W(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){W(kd()&&!Fd(),this.auth,"internal-error"),await bC(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=await NP(this.auth);W(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return W(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function bC(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var uo=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=fi._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};async function RC(n,e,t){if(ue._isFirebaseServerApp(n.app))return Promise.reject(ze(n));let r=be(n),i=await Bc(r,e,B.getModularInstance(t));return new uo(i,s=>Mc(r,s))}async function PC(n,e,t){let r=B.getModularInstance(n);await Lc(!1,r,"phone");let i=await Bc(r.auth,e,B.getModularInstance(t));return new uo(i,s=>tI(r,s))}async function SC(n,e,t){let r=B.getModularInstance(n);if(ue._isFirebaseServerApp(r.auth.app))return Promise.reject(ze(r.auth));let i=await Bc(r.auth,e,B.getModularInstance(t));return new uo(i,s=>nI(r,s))}async function Bc(n,e,t){if(!n._getRecaptchaConfig())try{await Gy(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){let i=r.session;if("phoneNumber"in r){W(i.type==="enroll",n,"internal-error");let s={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Vn(n,s,"mfaSmsEnrollment",async(l,d)=>{if(d.phoneEnrollmentInfo.captchaResponse===Js){W(t?.type===Ys,l,"argument-error");let p=await Qh(l,d,t);return Iy(l,p)}return Iy(l,d)},"PHONE_PROVIDER").catch(l=>Promise.reject(l))).phoneSessionInfo.sessionInfo}else{W(i.type==="signin",n,"internal-error");let s=r.multiFactorHint?.uid||r.multiFactorUid;W(s,n,"missing-multi-factor-info");let o={mfaPendingCredential:i.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Vn(n,o,"mfaSmsSignIn",async(d,p)=>{if(p.phoneSignInInfo.captchaResponse===Js){W(t?.type===Ys,d,"argument-error");let m=await Qh(d,p,t);return wy(d,m)}return wy(d,p)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).phoneResponseInfo.sessionInfo}}else{let i={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Vn(n,i,"sendVerificationCode",async(u,l)=>{if(l.captchaResponse===Js){W(t?.type===Ys,u,"argument-error");let d=await Qh(u,l,t);return _y(u,d)}return _y(u,l)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).sessionInfo}}finally{t?._reset()}}async function CC(n,e){let t=B.getModularInstance(n);if(ue._isFirebaseServerApp(t.auth.app))return Promise.reject(ze(t.auth));await xd(t,e)}async function Qh(n,e,t){W(t.type===Ys,n,"argument-error");let r=await t.verify();W(typeof r=="string",n,"argument-error");let i={...e};if("phoneEnrollmentInfo"in i){let s=i.phoneEnrollmentInfo.phoneNumber,o=i.phoneEnrollmentInfo.captchaResponse,c=i.phoneEnrollmentInfo.clientType,u=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r,captchaResponse:o,clientType:c,recaptchaVersion:u}}),i}else if("phoneSignInInfo"in i){let s=i.phoneSignInInfo.captchaResponse,o=i.phoneSignInInfo.clientType,c=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:s,clientType:o,recaptchaVersion:c}}),i}else return Object.assign(i,{recaptchaToken:r}),i}var lo=class n{constructor(e){this.providerId=n.PROVIDER_ID,this.auth=be(e)}verifyPhoneNumber(e,t){return Bc(this.auth,e,B.getModularInstance(t))}static credential(e,t){return fi._fromVerification(e,t)}static credentialFromResult(e){let t=e;return n.credentialFromTaggedObject(t)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?fi._fromTokenResponse(t,r):null}};lo.PROVIDER_ID="phone";lo.PHONE_SIGN_IN_METHOD="phone";function Ar(n,e){return e?zt(e):(W(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var ho=class extends xn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return an(e,this._buildIdpRequest())}_linkToIdToken(e,t){return an(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return an(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function kC(n){return eI(n.auth,new ho(n),n.bypassAuthState)}function DC(n){let{auth:e,user:t}=n;return W(t,e,"internal-error"),Zy(t,new ho(n),n.bypassAuthState)}async function NC(n){let{auth:e,user:t}=n;return W(t,e,"internal-error"),xd(t,new ho(n),n.bypassAuthState)}var Rc=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kC;case"linkViaPopup":case"linkViaRedirect":return NC;case"reauthViaPopup":case"reauthViaRedirect":return DC;default:rt(this.auth,"internal-error")}}resolve(e){jt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){jt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var VC=new Tr(2e3,1e4);async function OC(n,e,t){if(ue._isFirebaseServerApp(n.app))return Promise.reject(Ke(n,"operation-not-supported-in-this-environment"));let r=be(n);mi(n,e,St);let i=Ar(r,t);return new gi(r,"signInViaPopup",e,i).executeNotNull()}async function xC(n,e,t){let r=B.getModularInstance(n);if(ue._isFirebaseServerApp(r.auth.app))return Promise.reject(Ke(r.auth,"operation-not-supported-in-this-environment"));mi(r.auth,e,St);let i=Ar(r.auth,t);return new gi(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function LC(n,e,t){let r=B.getModularInstance(n);mi(r.auth,e,St);let i=Ar(r.auth,t);return new gi(r.auth,"linkViaPopup",e,i,r).executeNotNull()}var gi=class n extends Rc{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return W(e,this.auth,"internal-error"),e}async onExecution(){jt(this.filter.length===1,"Popup operations only handle one event");let e=go();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ke(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ke(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ke(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,VC.get())};e()}};gi.currentPopupAction=null;var MC="pendingRedirect",Xs=new Map,wd=class extends Rc{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Xs.get(this.auth._key());if(!e){try{let r=await FC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Xs.set(this.auth._key(),e)}return this.bypassAuthState||Xs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function FC(n,e){let t=fI(e),r=dI(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}async function Ud(n,e){return dI(n)._set(fI(e),"true")}function UC(){Xs.clear()}function hI(n,e){Xs.set(n._key(),e)}function dI(n){return zt(n._redirectPersistence)}function fI(n){return Qs(MC,n.config.apiKey,n.name)}function BC(n,e,t){return qC(n,e,t)}async function qC(n,e,t){if(ue._isFirebaseServerApp(n.app))return Promise.reject(ze(n));let r=be(n);mi(n,e,St),await r._initializationPromise;let i=Ar(r,t);return await Ud(i,r),i._openRedirect(r,e,"signInViaRedirect")}function WC(n,e,t){return zC(n,e,t)}async function zC(n,e,t){let r=B.getModularInstance(n);if(mi(r.auth,e,St),ue._isFirebaseServerApp(r.auth.app))return Promise.reject(ze(r.auth));await r.auth._initializationPromise;let i=Ar(r.auth,t);await Ud(i,r.auth);let s=await pI(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function jC(n,e,t){return GC(n,e,t)}async function GC(n,e,t){let r=B.getModularInstance(n);mi(r.auth,e,St),await r.auth._initializationPromise;let i=Ar(r.auth,t);await Lc(!1,r,e.providerId),await Ud(i,r.auth);let s=await pI(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function $C(n,e){return await be(n)._initializationPromise,Bd(n,e,!1)}async function Bd(n,e,t=!1){if(ue._isFirebaseServerApp(n.app))return Promise.reject(ze(n));let r=be(n),i=Ar(r,e),o=await new wd(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function pI(n){let e=go(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}var HC=600*1e3,Pc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!gI(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ke(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=HC&&this.cachedEventUids.clear(),this.cachedEventUids.has(vy(e))}saveEventToCache(e){this.cachedEventUids.add(vy(e)),this.lastProcessedEventTime=Date.now()}};function vy(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function gI({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function KC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gI(n);default:return!1}}async function mI(n,e={}){return Ie(n,"GET","/v1/projects",e)}var QC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,JC=/^https?/;async function YC(n){if(n.config.emulator)return;let{authorizedDomains:e}=await mI(n);for(let t of e)try{if(XC(t))return}catch{}rt(n,"unauthorized-domain")}function XC(n){let e=Zs(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!JC.test(t))return!1;if(QC.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var ZC=new Tr(3e4,6e4);function Ay(){let n=Ve().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function ek(n){return new Promise((e,t)=>{function r(){Ay(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ay(),t(Ke(n,"network-request-failed"))},timeout:ZC.get()})}if(Ve().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ve().gapi?.load)r();else{let i=jy("iframefcb");return Ve()[i]=()=>{gapi.load?r():t(Ke(n,"network-request-failed"))},Od(`${KP()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw ac=null,e})}var ac=null;function tk(n){return ac=ac||ek(n),ac}var nk=new Tr(5e3,15e3),rk="__/auth/iframe",ik="emulator/auth/iframe",sk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ok=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ak(n){let e=n.config;W(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Dd(e,ik):`https://${n.config.authDomain}/${rk}`,r={apiKey:e.apiKey,appName:n.name,v:ue.SDK_VERSION},i=ok.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${B.querystring(r).slice(1)}`}async function ck(n){let e=await tk(n),t=Ve().gapi;return W(t,n,"internal-error"),e.open({where:document.body,url:ak(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sk,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=Ke(n,"network-request-failed"),c=Ve().setTimeout(()=>{s(o)},nk.get());function u(){Ve().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{s(o)})}))}var uk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},lk=500,hk=600,dk="_blank",fk="http://localhost",fo=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function pk(n,e,t,r=lk,i=hk){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",u={...uk,width:r.toString(),height:i.toString(),top:s,left:o},l=B.getUA().toLowerCase();t&&(c=Uy(l)?dk:t),My(l)&&(e=e||fk,u.scrollbars="yes");let d=Object.entries(u).reduce((m,[w,k])=>`${m}${w}=${k},`,"");if(qP(l)&&c!=="_self")return gk(e||"",c),new fo(null);let p=window.open(e||"",c,d);W(p,n,"popup-blocked");try{p.focus()}catch{}return new fo(p)}function gk(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var mk="__/auth/handler",_k="emulator/auth/handler",yk=encodeURIComponent("fac");async function vd(n,e,t,r,i,s){W(n.config.authDomain,n,"auth-domain-config-required"),W(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:ue.SDK_VERSION,eventId:i};if(e instanceof St){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",B.isEmpty(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,p]of Object.entries(s||{}))o[d]=p}if(e instanceof Mn){let d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let d of Object.keys(c))c[d]===void 0&&delete c[d];let u=await n._getAppCheckToken(),l=u?`#${yk}=${encodeURIComponent(u)}`:"";return`${Ik(n)}?${B.querystring(c).slice(1)}${l}`}function Ik({config:n}){return n.emulator?Dd(n,_k):`https://${n.authDomain}/${mk}`}var Jh="webStorageSupport",Ad=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Md,this._completeRedirectFn=Bd,this._overrideRedirectResult=hI}async _openPopup(e,t,r,i){jt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let s=await vd(e,t,r,Zs(),i);return pk(e,s,go())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await vd(e,t,r,Zs(),i);return hC(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(jt(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await ck(e),r=new Pc(e);return t.register("authEvent",i=>(W(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Jh,{type:Jh},i=>{let s=i?.[0]?.[Jh];s!==void 0&&t(!!s),rt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return zy()||Fy()||Oc()}},_I=Ad,Sc=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Wt("unexpected MultiFactorSessionType")}}},bd=class n extends Sc{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return tC(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return EC(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},Cc=class{constructor(){}static assertion(e){return bd._fromCredential(e)}};Cc.FACTOR_ID="phone";var kc=class{static assertionForEnrollment(e,t){return Dc._fromSecret(e,t)}static assertionForSignIn(e,t){return Dc._fromEnrollmentId(e,t)}static async generateSecret(e){let t=e;W(typeof t.user?.auth<"u","internal-error");let r=await nC(t.user.auth,{idToken:t.credential,totpEnrollmentInfo:{}});return Nc._fromStartTotpMfaEnrollmentResponse(r,t.user.auth)}};kc.FACTOR_ID="totp";var Dc=class n extends Sc{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new n(t,void 0,e)}static _fromEnrollmentId(e,t){return new n(t,e)}async _finalizeEnroll(e,t,r){return W(typeof this.secret<"u",e,"argument-error"),rC(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){W(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");let r={verificationCode:this.otp};return TC(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}},Nc=class n{constructor(e,t,r,i,s,o,c){this.sessionInfo=o,this.auth=c,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=s}static _fromStartTotpMfaEnrollmentResponse(e,t){return new n(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){let r=!1;return(sc(e)||sc(t))&&(r=!0),r&&(sc(e)&&(e=this.auth.currentUser?.email||"unknownuser"),sc(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}};function sc(n){return typeof n>"u"||n?.length===0}var by="@firebase/auth",Ry="1.12.0";var Rd=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){W(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Ek(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Tk(n){ue._registerComponent(new uy.Component("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;W(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Vd(n)},l=new fc(r,i,s,u);return ZP(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ue._registerComponent(new uy.Component("auth-internal",e=>{let t=be(e.getProvider("auth").getImmediate());return(r=>new Rd(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ue.registerVersion(by,Ry,Ek(n)),ue.registerVersion(by,Ry,"cjs2020")}var wk=300,vk=B.getExperimentalSetting("authIdTokenMaxAge")||wk,Py=null,Ak=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>vk)return;let i=t?.token;Py!==i&&(Py=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function bk(n=ue.getApp()){let e=ue._getProvider(n,"auth");if(e.isInitialized())return e.getImmediate();let t=$y(n,{popupRedirectResolver:_I,persistence:[lI,aI,Md]}),r=B.getExperimentalSetting("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=Ak(s.toString());oI(t,o,()=>o(t.currentUser)),sI(t,c=>o(c))}}let i=B.getDefaultEmulatorHost("auth");return i&&Hy(t,`http://${i}`),t}function Rk(){return document.getElementsByTagName("head")?.[0]??document}GP({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Ke("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Rk().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Tk("Browser");L.AUTH_ERROR_CODES_MAP_DO_NOT_USE_INTERNALLY=AP;L.ActionCodeOperation=TP;L.ActionCodeURL=pi;L.AuthCredential=xn;L.AuthEventManager=Pc;L.AuthImpl=fc;L.AuthPopup=fo;L.EmailAuthCredential=ro;L.EmailAuthProvider=Ln;L.FacebookAuthProvider=io;L.FactorId=_P;L.FetchProvider=eo;L.GithubAuthProvider=oo;L.GoogleAuthProvider=so;L.OAuthCredential=un;L.OAuthProvider=od;L.OperationType=EP;L.PhoneAuthCredential=fi;L.PhoneAuthProvider=lo;L.PhoneMultiFactorGenerator=Cc;L.ProviderId=yP;L.RecaptchaVerifier=Td;L.SAMLAuthCredential=ao;L.SAMLAuthProvider=ad;L.SignInMethod=IP;L.TotpMultiFactorGenerator=kc;L.TotpSecret=Nc;L.TwitterAuthProvider=co;L.UserImpl=on;L._assert=W;L._castAuth=be;L._clearRedirectOutcomes=UC;L._createError=Ke;L._fail=rt;L._generateEventId=go;L._getClientVersion=Vd;L._getInstance=zt;L._getProjectConfig=mI;L._getRedirectResult=Bd;L._getRedirectUrl=vd;L._isAndroid=Nd;L._isIOS=Oc;L._isIOS7Or8=BP;L._overrideRedirectResult=hI;L._persistenceKeyName=Qs;L.applyActionCode=SS;L.beforeAuthStateChanged=oI;L.browserCookiePersistence=uC;L.browserLocalPersistence=aI;L.browserPopupRedirectResolver=_I;L.browserSessionPersistence=Md;L.checkActionCode=rI;L.confirmPasswordReset=PS;L.connectAuthEmulator=Hy;L.createUserWithEmailAndPassword=kS;L.debugAssert=jt;L.debugErrorMap=vP;L.deleteUser=ZS;L.fetchSignInMethodsForEmail=LS;L.getAdditionalUserInfo=jS;L.getAuth=bk;L.getIdToken=xP;L.getIdTokenResult=Oy;L.getMultiFactorResolver=eC;L.getRedirectResult=$C;L.inMemoryPersistence=Zh;L.indexedDBLocalPersistence=lI;L.initializeAuth=$y;L.initializeRecaptchaConfig=$S;L.isSignInWithEmailLink=VS;L.linkWithCredential=tI;L.linkWithPhoneNumber=PC;L.linkWithPopup=LC;L.linkWithRedirect=jC;L.multiFactor=sC;L.onAuthStateChanged=KS;L.onIdTokenChanged=sI;L.parseActionCodeURL=IS;L.prodErrorMap=Cy;L.reauthenticateWithCredential=nI;L.reauthenticateWithPhoneNumber=SC;L.reauthenticateWithPopup=xC;L.reauthenticateWithRedirect=WC;L.reload=xy;L.revokeAccessToken=XS;L.sendEmailVerification=MS;L.sendPasswordResetEmail=RS;L.sendSignInLinkToEmail=NS;L.setPersistence=GS;L.signInAnonymously=wS;L.signInWithCredential=Mc;L.signInWithCustomToken=bS;L.signInWithEmailAndPassword=DS;L.signInWithEmailLink=OS;L.signInWithPhoneNumber=RC;L.signInWithPopup=OC;L.signInWithRedirect=BC;L.signOut=YS;L.unlink=vS;L.updateCurrentUser=JS;L.updateEmail=qS;L.updatePassword=WS;L.updatePhoneNumber=CC;L.updateProfile=BS;L.useDeviceLanguage=QS;L.validatePassword=HS;L.verifyBeforeUpdateEmail=FS;L.verifyPasswordResetCode=CS});var TI=Ne(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});var D=yI(),Pk=Pt();Er();Ir();qt();function br(){return window}var Sk=2e3;async function Ck(n,e,t){let{BuildInfo:r}=br();D.debugAssert(e.sessionId,"AuthEvent did not contain a session ID");let i=await Ok(e.sessionId),s={};return D._isIOS()?s.ibi=r.packageName:D._isAndroid()?s.apn=r.packageName:D._fail(n,"operation-not-supported-in-this-environment"),r.displayName&&(s.appDisplayName=r.displayName),s.sessionId=i,D._getRedirectUrl(n,t,e.type,void 0,e.eventId??void 0,s)}async function kk(n){let{BuildInfo:e}=br(),t={};D._isIOS()?t.iosBundleId=e.packageName:D._isAndroid()?t.androidPackageName=e.packageName:D._fail(n,"operation-not-supported-in-this-environment"),await D._getProjectConfig(n,t)}function Dk(n){let{cordova:e}=br();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,D._isIOS7Or8()?"_blank":"_system","location=yes"),t(i)})})}async function Nk(n,e,t){let{cordova:r}=br(),i=()=>{};try{await new Promise((s,o)=>{let c=null;function u(){s();let p=r.plugins.browsertab?.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function l(){c||(c=window.setTimeout(()=>{o(D._createError(n,"redirect-cancelled-by-user"))},Sk))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(u),document.addEventListener("resume",l,!1),D._isAndroid()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(u),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),c&&window.clearTimeout(c)}})}finally{i()}}function Vk(n){let e=br();D._assert(typeof e?.universalLinks?.subscribe=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),D._assert(typeof e?.BuildInfo?.packageName<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),D._assert(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D._assert(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D._assert(typeof e?.cordova?.InAppBrowser?.open=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function Ok(n){let e=xk(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function xk(n){if(D.debugAssert(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var Lk=20,qd=class extends D.AuthEventManager{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}};function Mk(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:Bk(),postBody:null,tenantId:n.tenantId,error:D._createError(n,"no-auth-event")}}function Fk(n,e){return Wd()._set(zd(n),e)}async function II(n){let e=await Wd()._get(zd(n));return e&&await Wd()._remove(zd(n)),e}function Uk(n,e){let t=Wk(e);if(t.includes("/__/auth/callback")){let r=qc(t),s=(r.firebaseError?qk(decodeURIComponent(r.firebaseError)):null)?.code?.split("auth/")?.[1],o=s?D._createError(s):null;return o?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:o,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function Bk(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<Lk;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Wd(){return D._getInstance(D.browserLocalPersistence)}function zd(n){return D._persistenceKeyName("authEvent",n.config.apiKey,n.name)}function qk(n){try{return JSON.parse(n)}catch{return null}}function Wk(n){let e=qc(n),t=e.link?decodeURIComponent(e.link):void 0,r=qc(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return qc(i).link||i||r||t||n}function qc(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return Pk.querystringDecode(t.join("?"))}var zk=500,jd=class{constructor(){this._redirectPersistence=D.browserSessionPersistence,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=D._getRedirectResult,this._overrideRedirectResult=D._overrideRedirectResult}async _initialize(e){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new qd(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){D._fail(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){Vk(e);let s=await this._initialize(e);await s.initialized(),s.resetRedirect(),D._clearRedirectOutcomes(),await this._originValidation(e);let o=Mk(e,r,i);await Fk(e,o);let c=await Ck(e,o,t),u=await Dk(c);return Nk(e,s,u)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kk(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=br(),o=setTimeout(async()=>{await II(e),t.onEvent(EI())},zk),c=async d=>{clearTimeout(o);let p=await II(e),m=null;p&&d?.url&&(m=Uk(p,d.url)),t.onEvent(m||EI())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,c);let u=i,l=`${s.packageName.toLowerCase()}://`;br().handleOpenURL=async d=>{if(d.toLowerCase().startsWith(l)&&c({url:d}),typeof u=="function")try{u(d)}catch(p){console.error(p)}}}},jk=jd;function EI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:D._createError("no-auth-event")}}function Gk(n,e){D._castAuth(n)._logFramework(e)}U.ActionCodeOperation=D.ActionCodeOperation;U.ActionCodeURL=D.ActionCodeURL;U.AuthCredential=D.AuthCredential;U.AuthErrorCodes=D.AUTH_ERROR_CODES_MAP_DO_NOT_USE_INTERNALLY;U.AuthImpl=D.AuthImpl;U.AuthPopup=D.AuthPopup;U.EmailAuthCredential=D.EmailAuthCredential;U.EmailAuthProvider=D.EmailAuthProvider;U.FacebookAuthProvider=D.FacebookAuthProvider;U.FactorId=D.FactorId;U.FetchProvider=D.FetchProvider;U.GithubAuthProvider=D.GithubAuthProvider;U.GoogleAuthProvider=D.GoogleAuthProvider;U.OAuthCredential=D.OAuthCredential;U.OAuthProvider=D.OAuthProvider;U.OperationType=D.OperationType;U.PhoneAuthCredential=D.PhoneAuthCredential;U.PhoneAuthProvider=D.PhoneAuthProvider;U.PhoneMultiFactorGenerator=D.PhoneMultiFactorGenerator;U.ProviderId=D.ProviderId;U.RecaptchaVerifier=D.RecaptchaVerifier;U.SAMLAuthCredential=D.SAMLAuthCredential;U.SAMLAuthProvider=D.SAMLAuthProvider;U.SignInMethod=D.SignInMethod;U.TotpMultiFactorGenerator=D.TotpMultiFactorGenerator;U.TotpSecret=D.TotpSecret;U.TwitterAuthProvider=D.TwitterAuthProvider;U.UserImpl=D.UserImpl;U._assert=D._assert;U._castAuth=D._castAuth;U._fail=D._fail;U._generateEventId=D._generateEventId;U._getClientVersion=D._getClientVersion;U._getInstance=D._getInstance;U._getRedirectResult=D._getRedirectResult;U._overrideRedirectResult=D._overrideRedirectResult;U._persistenceKeyName=D._persistenceKeyName;U.applyActionCode=D.applyActionCode;U.beforeAuthStateChanged=D.beforeAuthStateChanged;U.browserCookiePersistence=D.browserCookiePersistence;U.browserLocalPersistence=D.browserLocalPersistence;U.browserPopupRedirectResolver=D.browserPopupRedirectResolver;U.browserSessionPersistence=D.browserSessionPersistence;U.checkActionCode=D.checkActionCode;U.confirmPasswordReset=D.confirmPasswordReset;U.connectAuthEmulator=D.connectAuthEmulator;U.createUserWithEmailAndPassword=D.createUserWithEmailAndPassword;U.debugErrorMap=D.debugErrorMap;U.deleteUser=D.deleteUser;U.fetchSignInMethodsForEmail=D.fetchSignInMethodsForEmail;U.getAdditionalUserInfo=D.getAdditionalUserInfo;U.getAuth=D.getAuth;U.getIdToken=D.getIdToken;U.getIdTokenResult=D.getIdTokenResult;U.getMultiFactorResolver=D.getMultiFactorResolver;U.getRedirectResult=D.getRedirectResult;U.inMemoryPersistence=D.inMemoryPersistence;U.indexedDBLocalPersistence=D.indexedDBLocalPersistence;U.initializeAuth=D.initializeAuth;U.initializeRecaptchaConfig=D.initializeRecaptchaConfig;U.isSignInWithEmailLink=D.isSignInWithEmailLink;U.linkWithCredential=D.linkWithCredential;U.linkWithPhoneNumber=D.linkWithPhoneNumber;U.linkWithPopup=D.linkWithPopup;U.linkWithRedirect=D.linkWithRedirect;U.multiFactor=D.multiFactor;U.onAuthStateChanged=D.onAuthStateChanged;U.onIdTokenChanged=D.onIdTokenChanged;U.parseActionCodeURL=D.parseActionCodeURL;U.prodErrorMap=D.prodErrorMap;U.reauthenticateWithCredential=D.reauthenticateWithCredential;U.reauthenticateWithPhoneNumber=D.reauthenticateWithPhoneNumber;U.reauthenticateWithPopup=D.reauthenticateWithPopup;U.reauthenticateWithRedirect=D.reauthenticateWithRedirect;U.reload=D.reload;U.revokeAccessToken=D.revokeAccessToken;U.sendEmailVerification=D.sendEmailVerification;U.sendPasswordResetEmail=D.sendPasswordResetEmail;U.sendSignInLinkToEmail=D.sendSignInLinkToEmail;U.setPersistence=D.setPersistence;U.signInAnonymously=D.signInAnonymously;U.signInWithCredential=D.signInWithCredential;U.signInWithCustomToken=D.signInWithCustomToken;U.signInWithEmailAndPassword=D.signInWithEmailAndPassword;U.signInWithEmailLink=D.signInWithEmailLink;U.signInWithPhoneNumber=D.signInWithPhoneNumber;U.signInWithPopup=D.signInWithPopup;U.signInWithRedirect=D.signInWithRedirect;U.signOut=D.signOut;U.unlink=D.unlink;U.updateCurrentUser=D.updateCurrentUser;U.updateEmail=D.updateEmail;U.updatePassword=D.updatePassword;U.updatePhoneNumber=D.updatePhoneNumber;U.updateProfile=D.updateProfile;U.useDeviceLanguage=D.useDeviceLanguage;U.validatePassword=D.validatePassword;U.verifyBeforeUpdateEmail=D.verifyBeforeUpdateEmail;U.verifyPasswordResetCode=D.verifyPasswordResetCode;U.addFrameworkForLogging=Gk;U.cordovaPopupRedirectResolver=jk});var kI=Ne(()=>{"use strict";var $k=js(),Hk=TI(),Kk=qt(),je=Pt();function Qk(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}function Jk(n){if(n&&n.__esModule)return n;var e=Object.create(null);return n&&Object.keys(n).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}}),e.default=n,Object.freeze(e)}var Jd=Qk($k),M=Jk(Hk),Yk="@firebase/auth-compat",Xk="0.6.2";var Zk=1e3;function yo(){return self?.location?.protocol||null}function e0(){return yo()==="http:"||yo()==="https:"}function vI(n=je.getUA()){return!!((yo()==="file:"||yo()==="ionic:"||yo()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function t0(){return je.isReactNative()||je.isNode()}function n0(){return je.isIE()&&document?.documentMode===11}function r0(n=je.getUA()){return/Edge\/\d+/.test(n)}function i0(n=je.getUA()){return n0()||r0(n)}function AI(){try{let n=self.localStorage,e=M._generateEventId();if(n)return n.setItem(e,"1"),n.removeItem(e),i0()?je.isIndexedDBAvailable():!0}catch{return Yd()&&je.isIndexedDBAvailable()}return!1}function Yd(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Gd(){return(e0()||je.isBrowserExtension()||vI())&&!t0()&&AI()&&!Yd()}function bI(){return vI()&&typeof document<"u"}async function s0(){return bI()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},Zk);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function o0(){return typeof window<"u"?window:null}var mt={LOCAL:"local",NONE:"none",SESSION:"session"},mo=M._assert,RI="persistence";function a0(n,e){if(mo(Object.values(mt).includes(e),n,"invalid-persistence-type"),je.isReactNative()){mo(e!==mt.SESSION,n,"unsupported-persistence-type");return}if(je.isNode()){mo(e===mt.NONE,n,"unsupported-persistence-type");return}if(Yd()){mo(e===mt.NONE||e===mt.LOCAL&&je.isIndexedDBAvailable(),n,"unsupported-persistence-type");return}mo(e===mt.NONE||AI(),n,"unsupported-persistence-type")}async function $d(n){await n._initializationPromise;let e=PI(),t=M._persistenceKeyName(RI,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function c0(n,e){let t=PI();if(!t)return[];let r=M._persistenceKeyName(RI,n,e);switch(t.getItem(r)){case mt.NONE:return[M.inMemoryPersistence];case mt.LOCAL:return[M.indexedDBLocalPersistence,M.browserSessionPersistence];case mt.SESSION:return[M.browserSessionPersistence];default:return[]}}function PI(){try{return o0()?.sessionStorage||null}catch{return null}}var u0=M._assert,Gt=class{constructor(){this.browserResolver=M._getInstance(M.browserPopupRedirectResolver),this.cordovaResolver=M._getInstance(M.cordovaPopupRedirectResolver),this.underlyingResolver=null,this._redirectPersistence=M.browserSessionPersistence,this._completeRedirectFn=M._getRedirectResult,this._overrideRedirectResult=M._overrideRedirectResult}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return bI()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return u0(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;let e=await s0();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}};function SI(n){return n.unwrap()}function l0(n){return n.wrapped()}function h0(n){return CI(n)}function d0(n,e){let t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let r=e;r.resolver=new Kd(n,M.getMultiFactorResolver(n,e))}else if(t){let r=CI(e),i=e;r&&(i.credential=r,i.tenantId=t.tenantId||void 0,i.email=t.email||void 0,i.phoneNumber=t.phoneNumber||void 0)}}function CI(n){let{_tokenResponse:e}=n instanceof je.FirebaseError?n.customData:n;if(!e)return null;if(!(n instanceof je.FirebaseError)&&"temporaryProof"in e&&"phoneNumber"in e)return M.PhoneAuthProvider.credentialFromResult(n);let t=e.providerId;if(!t||t===M.ProviderId.PASSWORD)return null;let r;switch(t){case M.ProviderId.GOOGLE:r=M.GoogleAuthProvider;break;case M.ProviderId.FACEBOOK:r=M.FacebookAuthProvider;break;case M.ProviderId.GITHUB:r=M.GithubAuthProvider;break;case M.ProviderId.TWITTER:r=M.TwitterAuthProvider;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:c,nonce:u}=e;return!s&&!o&&!i&&!c?null:c?t.startsWith("saml.")?M.SAMLAuthCredential._create(t,c):M.OAuthCredential._fromParams({providerId:t,signInMethod:t,pendingToken:c,idToken:i,accessToken:s}):new M.OAuthProvider(t).credential({idToken:i,accessToken:s,rawNonce:u})}return n instanceof je.FirebaseError?r.credentialFromError(n):r.credentialFromResult(n)}function at(n,e){return e.catch(t=>{throw t instanceof je.FirebaseError&&d0(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:h0(t),additionalUserInfo:M.getAdditionalUserInfo(t),user:_i.getOrCreate(i)}})}async function Hd(n,e){let t=await e;return{verificationId:t.verificationId,confirm:r=>at(n,t.confirm(r))}}var Kd=class{constructor(e,t){this.resolver=t,this.auth=l0(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return at(SI(this.auth),this.resolver.resolveSignIn(e))}};var _i=class n{constructor(e){this._delegate=e,this.multiFactor=M.multiFactor(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return at(this.auth,M.linkWithCredential(this._delegate,e))}async linkWithPhoneNumber(e,t){return Hd(this.auth,M.linkWithPhoneNumber(this._delegate,e,t))}async linkWithPopup(e){return at(this.auth,M.linkWithPopup(this._delegate,e,Gt))}async linkWithRedirect(e){return await $d(M._castAuth(this.auth)),M.linkWithRedirect(this._delegate,e,Gt)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return at(this.auth,M.reauthenticateWithCredential(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Hd(this.auth,M.reauthenticateWithPhoneNumber(this._delegate,e,t))}reauthenticateWithPopup(e){return at(this.auth,M.reauthenticateWithPopup(this._delegate,e,Gt))}async reauthenticateWithRedirect(e){return await $d(M._castAuth(this.auth)),M.reauthenticateWithRedirect(this._delegate,e,Gt)}sendEmailVerification(e){return M.sendEmailVerification(this._delegate,e)}async unlink(e){return await M.unlink(this._delegate,e),this}updateEmail(e){return M.updateEmail(this._delegate,e)}updatePassword(e){return M.updatePassword(this._delegate,e)}updatePhoneNumber(e){return M.updatePhoneNumber(this._delegate,e)}updateProfile(e){return M.updateProfile(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return M.verifyBeforeUpdateEmail(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};_i.USER_MAP=new WeakMap;var _o=M._assert,Io=class{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:r}=e.options;_o(r,"invalid-api-key",{appName:e.name}),_o(r,"invalid-api-key",{appName:e.name});let i=typeof window<"u"?Gt:void 0;this._delegate=t.initialize({options:{persistence:f0(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(M.debugErrorMap),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?_i.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){M.connectAuthEmulator(this._delegate,e,t)}applyActionCode(e){return M.applyActionCode(this._delegate,e)}checkActionCode(e){return M.checkActionCode(this._delegate,e)}confirmPasswordReset(e,t){return M.confirmPasswordReset(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return at(this._delegate,M.createUserWithEmailAndPassword(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return M.fetchSignInMethodsForEmail(this._delegate,e)}isSignInWithEmailLink(e){return M.isSignInWithEmailLink(this._delegate,e)}async getRedirectResult(){_o(Gd(),this._delegate,"operation-not-supported-in-this-environment");let e=await M.getRedirectResult(this._delegate,Gt);return e?at(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){M.addFrameworkForLogging(this._delegate,e)}onAuthStateChanged(e,t,r){let{next:i,error:s,complete:o}=wI(e,t,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,t,r){let{next:i,error:s,complete:o}=wI(e,t,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,t){return M.sendSignInLinkToEmail(this._delegate,e,t)}sendPasswordResetEmail(e,t){return M.sendPasswordResetEmail(this._delegate,e,t||void 0)}async setPersistence(e){a0(this._delegate,e);let t;switch(e){case mt.SESSION:t=M.browserSessionPersistence;break;case mt.LOCAL:t=await M._getInstance(M.indexedDBLocalPersistence)._isAvailable()?M.indexedDBLocalPersistence:M.browserLocalPersistence;break;case mt.NONE:t=M.inMemoryPersistence;break;default:return M._fail("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return at(this._delegate,M.signInAnonymously(this._delegate))}signInWithCredential(e){return at(this._delegate,M.signInWithCredential(this._delegate,e))}signInWithCustomToken(e){return at(this._delegate,M.signInWithCustomToken(this._delegate,e))}signInWithEmailAndPassword(e,t){return at(this._delegate,M.signInWithEmailAndPassword(this._delegate,e,t))}signInWithEmailLink(e,t){return at(this._delegate,M.signInWithEmailLink(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Hd(this._delegate,M.signInWithPhoneNumber(this._delegate,e,t))}async signInWithPopup(e){return _o(Gd(),this._delegate,"operation-not-supported-in-this-environment"),at(this._delegate,M.signInWithPopup(this._delegate,e,Gt))}async signInWithRedirect(e){return _o(Gd(),this._delegate,"operation-not-supported-in-this-environment"),await $d(this._delegate),M.signInWithRedirect(this._delegate,e,Gt)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return M.verifyPasswordResetCode(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}};Io.Persistence=mt;function wI(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&_i.getOrCreate(o)),error:e,complete:t}}function f0(n,e){let t=c0(n,e);if(typeof self<"u"&&!t.includes(M.indexedDBLocalPersistence)&&t.push(M.indexedDBLocalPersistence),typeof window<"u")for(let r of[M.browserLocalPersistence,M.browserSessionPersistence])t.includes(r)||t.push(r);return t.includes(M.inMemoryPersistence)||t.push(M.inMemoryPersistence),t}var Eo=class{static credential(e,t){return M.PhoneAuthProvider.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new M.PhoneAuthProvider(SI(Jd.default.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};Eo.PHONE_SIGN_IN_METHOD=M.PhoneAuthProvider.PHONE_SIGN_IN_METHOD;Eo.PROVIDER_ID=M.PhoneAuthProvider.PROVIDER_ID;var p0=M._assert,Qd=class{constructor(e,t,r=Jd.default.app()){p0(r.options?.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new M.RecaptchaVerifier(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var g0="auth-compat";function m0(n){n.INTERNAL.registerComponent(new Kk.Component(g0,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Io(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:M.ActionCodeOperation.EMAIL_SIGNIN,PASSWORD_RESET:M.ActionCodeOperation.PASSWORD_RESET,RECOVER_EMAIL:M.ActionCodeOperation.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:M.ActionCodeOperation.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:M.ActionCodeOperation.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:M.ActionCodeOperation.VERIFY_EMAIL}},EmailAuthProvider:M.EmailAuthProvider,FacebookAuthProvider:M.FacebookAuthProvider,GithubAuthProvider:M.GithubAuthProvider,GoogleAuthProvider:M.GoogleAuthProvider,OAuthProvider:M.OAuthProvider,SAMLAuthProvider:M.SAMLAuthProvider,PhoneAuthProvider:Eo,PhoneMultiFactorGenerator:M.PhoneMultiFactorGenerator,RecaptchaVerifier:Qd,TwitterAuthProvider:M.TwitterAuthProvider,Auth:Io,AuthCredential:M.AuthCredential,Error:je.FirebaseError}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(Yk,Xk)}m0(Jd.default)});var DI=Ne(()=>{"use strict";kI()});var Zd=Ne((Nx,Xd)=>{(function(){"use strict";var n;function e(T,y){function E(){}E.prototype=y.prototype,T.F=y.prototype,T.prototype=new E,T.prototype.constructor=T,T.D=function(A,v,R){for(var I=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)I[ot-2]=arguments[ot];return y.prototype[v].apply(A,I)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,y,E){E||(E=0);let A=Array(16);if(typeof y=="string")for(var v=0;v<16;++v)A[v]=y.charCodeAt(E++)|y.charCodeAt(E++)<<8|y.charCodeAt(E++)<<16|y.charCodeAt(E++)<<24;else for(v=0;v<16;++v)A[v]=y[E++]|y[E++]<<8|y[E++]<<16|y[E++]<<24;y=T.g[0],E=T.g[1],v=T.g[2];let R=T.g[3],I;I=y+(R^E&(v^R))+A[0]+3614090360&4294967295,y=E+(I<<7&4294967295|I>>>25),I=R+(v^y&(E^v))+A[1]+3905402710&4294967295,R=y+(I<<12&4294967295|I>>>20),I=v+(E^R&(y^E))+A[2]+606105819&4294967295,v=R+(I<<17&4294967295|I>>>15),I=E+(y^v&(R^y))+A[3]+3250441966&4294967295,E=v+(I<<22&4294967295|I>>>10),I=y+(R^E&(v^R))+A[4]+4118548399&4294967295,y=E+(I<<7&4294967295|I>>>25),I=R+(v^y&(E^v))+A[5]+1200080426&4294967295,R=y+(I<<12&4294967295|I>>>20),I=v+(E^R&(y^E))+A[6]+2821735955&4294967295,v=R+(I<<17&4294967295|I>>>15),I=E+(y^v&(R^y))+A[7]+4249261313&4294967295,E=v+(I<<22&4294967295|I>>>10),I=y+(R^E&(v^R))+A[8]+1770035416&4294967295,y=E+(I<<7&4294967295|I>>>25),I=R+(v^y&(E^v))+A[9]+2336552879&4294967295,R=y+(I<<12&4294967295|I>>>20),I=v+(E^R&(y^E))+A[10]+4294925233&4294967295,v=R+(I<<17&4294967295|I>>>15),I=E+(y^v&(R^y))+A[11]+2304563134&4294967295,E=v+(I<<22&4294967295|I>>>10),I=y+(R^E&(v^R))+A[12]+1804603682&4294967295,y=E+(I<<7&4294967295|I>>>25),I=R+(v^y&(E^v))+A[13]+4254626195&4294967295,R=y+(I<<12&4294967295|I>>>20),I=v+(E^R&(y^E))+A[14]+2792965006&4294967295,v=R+(I<<17&4294967295|I>>>15),I=E+(y^v&(R^y))+A[15]+1236535329&4294967295,E=v+(I<<22&4294967295|I>>>10),I=y+(v^R&(E^v))+A[1]+4129170786&4294967295,y=E+(I<<5&4294967295|I>>>27),I=R+(E^v&(y^E))+A[6]+3225465664&4294967295,R=y+(I<<9&4294967295|I>>>23),I=v+(y^E&(R^y))+A[11]+643717713&4294967295,v=R+(I<<14&4294967295|I>>>18),I=E+(R^y&(v^R))+A[0]+3921069994&4294967295,E=v+(I<<20&4294967295|I>>>12),I=y+(v^R&(E^v))+A[5]+3593408605&4294967295,y=E+(I<<5&4294967295|I>>>27),I=R+(E^v&(y^E))+A[10]+38016083&4294967295,R=y+(I<<9&4294967295|I>>>23),I=v+(y^E&(R^y))+A[15]+3634488961&4294967295,v=R+(I<<14&4294967295|I>>>18),I=E+(R^y&(v^R))+A[4]+3889429448&4294967295,E=v+(I<<20&4294967295|I>>>12),I=y+(v^R&(E^v))+A[9]+568446438&4294967295,y=E+(I<<5&4294967295|I>>>27),I=R+(E^v&(y^E))+A[14]+3275163606&4294967295,R=y+(I<<9&4294967295|I>>>23),I=v+(y^E&(R^y))+A[3]+4107603335&4294967295,v=R+(I<<14&4294967295|I>>>18),I=E+(R^y&(v^R))+A[8]+1163531501&4294967295,E=v+(I<<20&4294967295|I>>>12),I=y+(v^R&(E^v))+A[13]+2850285829&4294967295,y=E+(I<<5&4294967295|I>>>27),I=R+(E^v&(y^E))+A[2]+4243563512&4294967295,R=y+(I<<9&4294967295|I>>>23),I=v+(y^E&(R^y))+A[7]+1735328473&4294967295,v=R+(I<<14&4294967295|I>>>18),I=E+(R^y&(v^R))+A[12]+2368359562&4294967295,E=v+(I<<20&4294967295|I>>>12),I=y+(E^v^R)+A[5]+4294588738&4294967295,y=E+(I<<4&4294967295|I>>>28),I=R+(y^E^v)+A[8]+2272392833&4294967295,R=y+(I<<11&4294967295|I>>>21),I=v+(R^y^E)+A[11]+1839030562&4294967295,v=R+(I<<16&4294967295|I>>>16),I=E+(v^R^y)+A[14]+4259657740&4294967295,E=v+(I<<23&4294967295|I>>>9),I=y+(E^v^R)+A[1]+2763975236&4294967295,y=E+(I<<4&4294967295|I>>>28),I=R+(y^E^v)+A[4]+1272893353&4294967295,R=y+(I<<11&4294967295|I>>>21),I=v+(R^y^E)+A[7]+4139469664&4294967295,v=R+(I<<16&4294967295|I>>>16),I=E+(v^R^y)+A[10]+3200236656&4294967295,E=v+(I<<23&4294967295|I>>>9),I=y+(E^v^R)+A[13]+681279174&4294967295,y=E+(I<<4&4294967295|I>>>28),I=R+(y^E^v)+A[0]+3936430074&4294967295,R=y+(I<<11&4294967295|I>>>21),I=v+(R^y^E)+A[3]+3572445317&4294967295,v=R+(I<<16&4294967295|I>>>16),I=E+(v^R^y)+A[6]+76029189&4294967295,E=v+(I<<23&4294967295|I>>>9),I=y+(E^v^R)+A[9]+3654602809&4294967295,y=E+(I<<4&4294967295|I>>>28),I=R+(y^E^v)+A[12]+3873151461&4294967295,R=y+(I<<11&4294967295|I>>>21),I=v+(R^y^E)+A[15]+530742520&4294967295,v=R+(I<<16&4294967295|I>>>16),I=E+(v^R^y)+A[2]+3299628645&4294967295,E=v+(I<<23&4294967295|I>>>9),I=y+(v^(E|~R))+A[0]+4096336452&4294967295,y=E+(I<<6&4294967295|I>>>26),I=R+(E^(y|~v))+A[7]+1126891415&4294967295,R=y+(I<<10&4294967295|I>>>22),I=v+(y^(R|~E))+A[14]+2878612391&4294967295,v=R+(I<<15&4294967295|I>>>17),I=E+(R^(v|~y))+A[5]+4237533241&4294967295,E=v+(I<<21&4294967295|I>>>11),I=y+(v^(E|~R))+A[12]+1700485571&4294967295,y=E+(I<<6&4294967295|I>>>26),I=R+(E^(y|~v))+A[3]+2399980690&4294967295,R=y+(I<<10&4294967295|I>>>22),I=v+(y^(R|~E))+A[10]+4293915773&4294967295,v=R+(I<<15&4294967295|I>>>17),I=E+(R^(v|~y))+A[1]+2240044497&4294967295,E=v+(I<<21&4294967295|I>>>11),I=y+(v^(E|~R))+A[8]+1873313359&4294967295,y=E+(I<<6&4294967295|I>>>26),I=R+(E^(y|~v))+A[15]+4264355552&4294967295,R=y+(I<<10&4294967295|I>>>22),I=v+(y^(R|~E))+A[6]+2734768916&4294967295,v=R+(I<<15&4294967295|I>>>17),I=E+(R^(v|~y))+A[13]+1309151649&4294967295,E=v+(I<<21&4294967295|I>>>11),I=y+(v^(E|~R))+A[4]+4149444226&4294967295,y=E+(I<<6&4294967295|I>>>26),I=R+(E^(y|~v))+A[11]+3174756917&4294967295,R=y+(I<<10&4294967295|I>>>22),I=v+(y^(R|~E))+A[2]+718787259&4294967295,v=R+(I<<15&4294967295|I>>>17),I=E+(R^(v|~y))+A[9]+3951481745&4294967295,T.g[0]=T.g[0]+y&4294967295,T.g[1]=T.g[1]+(v+(I<<21&4294967295|I>>>11))&4294967295,T.g[2]=T.g[2]+v&4294967295,T.g[3]=T.g[3]+R&4294967295}r.prototype.v=function(T,y){y===void 0&&(y=T.length);let E=y-this.blockSize,A=this.C,v=this.h,R=0;for(;R<y;){if(v==0)for(;R<=E;)i(this,T,R),R+=this.blockSize;if(typeof T=="string"){for(;R<y;)if(A[v++]=T.charCodeAt(R++),v==this.blockSize){i(this,A),v=0;break}}else for(;R<y;)if(A[v++]=T[R++],v==this.blockSize){i(this,A),v=0;break}}this.h=v,this.o+=y},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var y=1;y<T.length-8;++y)T[y]=0;y=this.o*8;for(var E=T.length-8;E<T.length;++E)T[E]=y&255,y/=256;for(this.v(T),T=Array(16),y=0,E=0;E<4;++E)for(let A=0;A<32;A+=8)T[y++]=this.g[E]>>>A&255;return T};function s(T,y){var E=c;return Object.prototype.hasOwnProperty.call(E,T)?E[T]:E[T]=y(T)}function o(T,y){this.h=y;let E=[],A=!0;for(let v=T.length-1;v>=0;v--){let R=T[v]|0;A&&R==y||(E[v]=R,A=!1)}this.g=E}var c={};function u(T){return-128<=T&&T<128?s(T,function(y){return new o([y|0],y<0?-1:0)}):new o([T|0],T<0?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return p;if(T<0)return x(l(-T));let y=[],E=1;for(let A=0;T>=E;A++)y[A]=T/E|0,E*=4294967296;return new o(y,0)}function d(T,y){if(T.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(T.charAt(0)=="-")return x(d(T.substring(1),y));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');let E=l(Math.pow(y,8)),A=p;for(let R=0;R<T.length;R+=8){var v=Math.min(8,T.length-R);let I=parseInt(T.substring(R,R+v),y);v<8?(v=l(Math.pow(y,v)),A=A.j(v).add(l(I))):(A=A.j(E),A=A.add(l(I)))}return A}var p=u(0),m=u(1),w=u(16777216);n=o.prototype,n.m=function(){if(V(this))return-x(this).m();let T=0,y=1;for(let E=0;E<this.g.length;E++){let A=this.i(E);T+=(A>=0?A:4294967296+A)*y,y*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(k(this))return"0";if(V(this))return"-"+x(this).toString(T);let y=l(Math.pow(T,6));var E=this;let A="";for(;;){let v=te(E,y).g;E=H(E,v.j(y));let R=((E.g.length>0?E.g[0]:E.h)>>>0).toString(T);if(E=v,k(E))return R+A;for(;R.length<6;)R="0"+R;A=R+A}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function k(T){if(T.h!=0)return!1;for(let y=0;y<T.g.length;y++)if(T.g[y]!=0)return!1;return!0}function V(T){return T.h==-1}n.l=function(T){return T=H(this,T),V(T)?-1:k(T)?0:1};function x(T){let y=T.g.length,E=[];for(let A=0;A<y;A++)E[A]=~T.g[A];return new o(E,~T.h).add(m)}n.abs=function(){return V(this)?x(this):this},n.add=function(T){let y=Math.max(this.g.length,T.g.length),E=[],A=0;for(let v=0;v<=y;v++){let R=A+(this.i(v)&65535)+(T.i(v)&65535),I=(R>>>16)+(this.i(v)>>>16)+(T.i(v)>>>16);A=I>>>16,R&=65535,I&=65535,E[v]=I<<16|R}return new o(E,E[E.length-1]&-2147483648?-1:0)};function H(T,y){return T.add(x(y))}n.j=function(T){if(k(this)||k(T))return p;if(V(this))return V(T)?x(this).j(x(T)):x(x(this).j(T));if(V(T))return x(this.j(x(T)));if(this.l(w)<0&&T.l(w)<0)return l(this.m()*T.m());let y=this.g.length+T.g.length,E=[];for(var A=0;A<2*y;A++)E[A]=0;for(A=0;A<this.g.length;A++)for(let v=0;v<T.g.length;v++){let R=this.i(A)>>>16,I=this.i(A)&65535,ot=T.i(v)>>>16,wn=T.i(v)&65535;E[2*A+2*v]+=I*wn,X(E,2*A+2*v),E[2*A+2*v+1]+=R*wn,X(E,2*A+2*v+1),E[2*A+2*v+1]+=I*ot,X(E,2*A+2*v+1),E[2*A+2*v+2]+=R*ot,X(E,2*A+2*v+2)}for(T=0;T<y;T++)E[T]=E[2*T+1]<<16|E[2*T];for(T=y;T<2*y;T++)E[T]=0;return new o(E,0)};function X(T,y){for(;(T[y]&65535)!=T[y];)T[y+1]+=T[y]>>>16,T[y]&=65535,y++}function K(T,y){this.g=T,this.h=y}function te(T,y){if(k(y))throw Error("division by zero");if(k(T))return new K(p,p);if(V(T))return y=te(x(T),y),new K(x(y.g),x(y.h));if(V(y))return y=te(T,x(y)),new K(x(y.g),y.h);if(T.g.length>30){if(V(T)||V(y))throw Error("slowDivide_ only works with positive integers.");for(var E=m,A=y;A.l(T)<=0;)E=ae(E),A=ae(A);var v=ie(E,1),R=ie(A,1);for(A=ie(A,2),E=ie(E,2);!k(A);){var I=R.add(A);I.l(T)<=0&&(v=v.add(E),R=I),A=ie(A,1),E=ie(E,1)}return y=H(T,v.j(y)),new K(v,y)}for(v=p;T.l(y)>=0;){for(E=Math.max(1,Math.floor(T.m()/y.m())),A=Math.ceil(Math.log(E)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),R=l(E),I=R.j(y);V(I)||I.l(T)>0;)E-=A,R=l(E),I=R.j(y);k(R)&&(R=m),v=v.add(R),T=H(T,I)}return new K(v,T)}n.B=function(T){return te(this,T).h},n.and=function(T){let y=Math.max(this.g.length,T.g.length),E=[];for(let A=0;A<y;A++)E[A]=this.i(A)&T.i(A);return new o(E,this.h&T.h)},n.or=function(T){let y=Math.max(this.g.length,T.g.length),E=[];for(let A=0;A<y;A++)E[A]=this.i(A)|T.i(A);return new o(E,this.h|T.h)},n.xor=function(T){let y=Math.max(this.g.length,T.g.length),E=[];for(let A=0;A<y;A++)E[A]=this.i(A)^T.i(A);return new o(E,this.h^T.h)};function ae(T){let y=T.g.length+1,E=[];for(let A=0;A<y;A++)E[A]=T.i(A)<<1|T.i(A-1)>>>31;return new o(E,T.h)}function ie(T,y){let E=y>>5;y%=32;let A=T.g.length-E,v=[];for(let R=0;R<A;R++)v[R]=y>0?T.i(R+E)>>>y|T.i(R+E+1)<<32-y:T.i(R+E);return new o(v,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Xd.exports.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Xd.exports.Integer=o}).apply(typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})});var ef=Ne((Vx,$t)=>{(function(){"use strict";var n,e=Object.defineProperty;function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof global=="object"&&global];for(var h=0;h<a.length;++h){var f=a[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(a,h){if(h)e:{var f=r;a=a.split(".");for(var _=0;_<a.length-1;_++){var b=a[_];if(!(b in f))break e;f=f[b]}a=a[a.length-1],_=f[a],h=h(_),h!=_&&h!=null&&e(f,a,{configurable:!0,writable:!0,value:h})}}i("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(a){return a||function(h){var f=[],_;for(_ in h)Object.prototype.hasOwnProperty.call(h,_)&&f.push([_,h[_]]);return f}});var s=s||{},o=this||self;function c(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function u(a,h,f){return a.call.apply(a.bind,arguments)}function l(a,h,f){return l=u,l.apply(null,arguments)}function d(a,h){var f=Array.prototype.slice.call(arguments,1);return function(){var _=f.slice();return _.push.apply(_,arguments),a.apply(this,_)}}function p(a,h){function f(){}f.prototype=h.prototype,a.Z=h.prototype,a.prototype=new f,a.prototype.constructor=a,a.Ob=function(_,b,S){for(var G=Array(arguments.length-2),se=2;se<arguments.length;se++)G[se-2]=arguments[se];return h.prototype[b].apply(_,G)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function w(a){let h=a.length;if(h>0){let f=Array(h);for(let _=0;_<h;_++)f[_]=a[_];return f}return[]}function k(a,h){for(let _=1;_<arguments.length;_++){let b=arguments[_];var f=typeof b;if(f=f!="object"?f:b?Array.isArray(b)?"array":f:"null",f=="array"||f=="object"&&typeof b.length=="number"){f=a.length||0;let S=b.length||0;a.length=f+S;for(let G=0;G<S;G++)a[f+G]=b[G]}else a.push(b)}}class V{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function x(a){o.setTimeout(()=>{throw a},0)}function H(){var a=T;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class X{constructor(){this.h=this.g=null}add(h,f){let _=K.get();_.set(h,f),this.h?this.h.next=_:this.g=_,this.h=_}}var K=new V(()=>new te,a=>a.reset());class te{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,ie=!1,T=new X,y=()=>{let a=Promise.resolve(void 0);ae=()=>{a.then(E)}};function E(){for(var a;a=H();){try{a.h.call(a.g)}catch(f){x(f)}var h=K;h.j(a),h.h<100&&(h.h++,a.next=h.g,h.g=a)}ie=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function v(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}v.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let f=()=>{};o.addEventListener("test",f,h),o.removeEventListener("test",f,h)}catch{}return a})();function I(a){return/^[\s\xa0]*$/.test(a)}function ot(a,h){v.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,h)}p(ot,v),ot.prototype.init=function(a,h){let f=this.type=a.type,_=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget,h||(f=="mouseover"?h=a.fromElement:f=="mouseout"&&(h=a.toElement)),this.relatedTarget=h,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&ot.Z.h.call(this)},ot.prototype.h=function(){ot.Z.h.call(this);let a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var wn="closure_listenable_"+(Math.random()*1e6|0),eA=0;function tA(a,h,f,_,b){this.listener=a,this.proxy=null,this.src=h,this.type=f,this.capture=!!_,this.ha=b,this.key=++eA,this.da=this.fa=!1}function Da(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Na(a,h,f){for(let _ in a)h.call(f,a[_],_,a)}function nA(a,h){for(let f in a)h.call(void 0,a[f],f,a)}function Im(a){let h={};for(let f in a)h[f]=a[f];return h}let Em="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Tm(a,h){let f,_;for(let b=1;b<arguments.length;b++){_=arguments[b];for(f in _)a[f]=_[f];for(let S=0;S<Em.length;S++)f=Em[S],Object.prototype.hasOwnProperty.call(_,f)&&(a[f]=_[f])}}function Va(a){this.src=a,this.g={},this.h=0}Va.prototype.add=function(a,h,f,_,b){let S=a.toString();a=this.g[S],a||(a=this.g[S]=[],this.h++);let G=Gl(a,h,_,b);return G>-1?(h=a[G],f||(h.fa=!1)):(h=new tA(h,this.src,S,!!_,b),h.fa=f,a.push(h)),h};function jl(a,h){let f=h.type;if(f in a.g){var _=a.g[f],b=Array.prototype.indexOf.call(_,h,void 0),S;(S=b>=0)&&Array.prototype.splice.call(_,b,1),S&&(Da(h),a.g[f].length==0&&(delete a.g[f],a.h--))}}function Gl(a,h,f,_){for(let b=0;b<a.length;++b){let S=a[b];if(!S.da&&S.listener==h&&S.capture==!!f&&S.ha==_)return b}return-1}var $l="closure_lm_"+(Math.random()*1e6|0),Hl={},wm=0;function vm(a,h,f,_,b){if(_&&_.once)return bm(a,h,f,_,b);if(Array.isArray(h)){for(let S=0;S<h.length;S++)vm(a,h[S],f,_,b);return null}return f=Yl(f),a&&a[wn]?a.J(h,f,c(_)?!!_.capture:!!_,b):Am(a,h,f,!1,_,b)}function Am(a,h,f,_,b,S){if(!h)throw Error("Invalid event type");let G=c(b)?!!b.capture:!!b,se=Ql(a);if(se||(a[$l]=se=new Va(a)),f=se.add(h,f,_,G,S),f.proxy)return f;if(_=rA(),f.proxy=_,_.src=a,_.listener=f,a.addEventListener)R||(b=G),b===void 0&&(b=!1),a.addEventListener(h.toString(),_,b);else if(a.attachEvent)a.attachEvent(Pm(h.toString()),_);else if(a.addListener&&a.removeListener)a.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return wm++,f}function rA(){function a(f){return h.call(a.src,a.listener,f)}let h=iA;return a}function bm(a,h,f,_,b){if(Array.isArray(h)){for(let S=0;S<h.length;S++)bm(a,h[S],f,_,b);return null}return f=Yl(f),a&&a[wn]?a.K(h,f,c(_)?!!_.capture:!!_,b):Am(a,h,f,!0,_,b)}function Rm(a,h,f,_,b){if(Array.isArray(h))for(var S=0;S<h.length;S++)Rm(a,h[S],f,_,b);else _=c(_)?!!_.capture:!!_,f=Yl(f),a&&a[wn]?(a=a.i,S=String(h).toString(),S in a.g&&(h=a.g[S],f=Gl(h,f,_,b),f>-1&&(Da(h[f]),Array.prototype.splice.call(h,f,1),h.length==0&&(delete a.g[S],a.h--)))):a&&(a=Ql(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Gl(h,f,_,b)),(f=a>-1?h[a]:null)&&Kl(f))}function Kl(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[wn])jl(h.i,a);else{var f=a.type,_=a.proxy;h.removeEventListener?h.removeEventListener(f,_,a.capture):h.detachEvent?h.detachEvent(Pm(f),_):h.addListener&&h.removeListener&&h.removeListener(_),wm--,(f=Ql(h))?(jl(f,a),f.h==0&&(f.src=null,h[$l]=null)):Da(a)}}}function Pm(a){return a in Hl?Hl[a]:Hl[a]="on"+a}function iA(a,h){if(a.da)a=!0;else{h=new ot(h,this);let f=a.listener,_=a.ha||a.src;a.fa&&Kl(a),a=f.call(_,h)}return a}function Ql(a){return a=a[$l],a instanceof Va?a:null}var Jl="__closure_events_fn_"+(Math.random()*1e9>>>0);function Yl(a){return typeof a=="function"?a:(a[Jl]||(a[Jl]=function(h){return a.handleEvent(h)}),a[Jl])}function $e(){A.call(this),this.i=new Va(this),this.M=this,this.G=null}p($e,A),$e.prototype[wn]=!0,$e.prototype.removeEventListener=function(a,h,f,_){Rm(this,a,h,f,_)};function tt(a,h){var f,_=a.G;if(_)for(f=[];_;_=_.G)f.push(_);if(a=a.M,_=h.type||h,typeof h=="string")h=new v(h,a);else if(h instanceof v)h.target=h.target||a;else{var b=h;h=new v(_,a),Tm(h,b)}b=!0;let S,G;if(f)for(G=f.length-1;G>=0;G--)S=h.g=f[G],b=Oa(S,_,!0,h)&&b;if(S=h.g=a,b=Oa(S,_,!0,h)&&b,b=Oa(S,_,!1,h)&&b,f)for(G=0;G<f.length;G++)S=h.g=f[G],b=Oa(S,_,!1,h)&&b}$e.prototype.N=function(){if($e.Z.N.call(this),this.i){var a=this.i;let h=0;for(let f in a.g){let _=a.g[f];for(let b=0;b<_.length;b++)++h,Da(_[b]);delete a.g[f],a.h--}}this.G=null},$e.prototype.J=function(a,h,f,_){return this.i.add(String(a),h,!1,f,_)},$e.prototype.K=function(a,h,f,_){return this.i.add(String(a),h,!0,f,_)};function Oa(a,h,f,_){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();let b=!0;for(let S=0;S<h.length;++S){let G=h[S];if(G&&!G.da&&G.capture==f){let se=G.listener,Ue=G.ha||G.src;G.fa&&jl(a.i,G),b=se.call(Ue,_)!==!1&&b}}return b&&!_.defaultPrevented}function sA(a,h){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=l(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(a,h||0)}function Sm(a){a.g=sA(()=>{a.g=null,a.i&&(a.i=!1,Sm(a))},a.l);let h=a.h;a.h=null,a.m.apply(null,h)}class oA extends A{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Sm(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Es(a){A.call(this),this.h=a,this.g={}}p(Es,A);var Cm=[];function km(a){Na(a.g,function(h,f){this.g.hasOwnProperty(f)&&Kl(h)},a),a.g={}}Es.prototype.N=function(){Es.Z.N.call(this),km(this)},Es.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xl=o.JSON.stringify,aA=o.JSON.parse,cA=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function Dm(){}function Nm(){}var Ts={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Zl(){v.call(this,"d")}p(Zl,v);function eh(){v.call(this,"c")}p(eh,v);var fr={},Vm=null;function xa(){return Vm=Vm||new $e}fr.Ia="serverreachability";function Om(a){v.call(this,fr.Ia,a)}p(Om,v);function ws(a){let h=xa();tt(h,new Om(h,a))}fr.STAT_EVENT="statevent";function xm(a,h){v.call(this,fr.STAT_EVENT,a),this.stat=h}p(xm,v);function nt(a){let h=xa();tt(h,new xm(h,a))}fr.Ja="timingevent";function Lm(a,h){v.call(this,fr.Ja,a),this.size=h}p(Lm,v);function vs(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},h)}function As(){this.g=!0}As.prototype.ua=function(){this.g=!1};function uA(a,h,f,_,b,S){a.info(function(){if(a.g)if(S){var G="",se=S.split("&");for(let ge=0;ge<se.length;ge++){var Ue=se[ge].split("=");if(Ue.length>1){let We=Ue[0];Ue=Ue[1];let Bt=We.split("_");G=Bt.length>=2&&Bt[1]=="type"?G+(We+"="+Ue+"&"):G+(We+"=redacted&")}}}else G=null;else G=S;return"XMLHTTP REQ ("+_+") [attempt "+b+"]: "+h+`
`+f+`
`+G})}function lA(a,h,f,_,b,S,G){a.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+b+"]: "+h+`
`+f+`
`+S+" "+G})}function oi(a,h,f,_){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+dA(a,f)+(_?" "+_:"")})}function hA(a,h){a.info(function(){return"TIMEOUT: "+h})}As.prototype.info=function(){};function dA(a,h){if(!a.g)return h;if(!h)return null;try{let S=JSON.parse(h);if(S){for(a=0;a<S.length;a++)if(Array.isArray(S[a])){var f=S[a];if(!(f.length<2)){var _=f[1];if(Array.isArray(_)&&!(_.length<1)){var b=_[0];if(b!="noop"&&b!="stop"&&b!="close")for(let G=1;G<_.length;G++)_[G]=""}}}}return Xl(S)}catch{return h}}var La={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Mm={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Fm;function th(){}p(th,Dm),th.prototype.g=function(){return new XMLHttpRequest},Fm=new th;function ai(a){return encodeURIComponent(String(a))}function fA(a){var h=1;a=a.split(":");let f=[];for(;h>0&&a.length;)f.push(a.shift()),h--;return a.length&&f.push(a.join(":")),f}function vn(a,h,f,_){this.j=a,this.i=h,this.l=f,this.S=_||1,this.V=new Es(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Um}function Um(){this.i=null,this.g="",this.h=!1}var Bm={},nh={};function rh(a,h,f){a.M=1,a.A=Fa(Ut(h)),a.u=f,a.R=!0,qm(a,null)}function qm(a,h){a.F=Date.now(),Ma(a),a.B=Ut(a.A);var f=a.B,_=a.S;Array.isArray(_)||(_=[String(_)]),e_(f.i,"t",_),a.C=0,f=a.j.L,a.h=new Um,a.g=y_(a.j,f?h:null,!a.u),a.P>0&&(a.O=new oA(l(a.Y,a,a.g),a.P)),h=a.V,f=a.g,_=a.ba;var b="readystatechange";Array.isArray(b)||(b&&(Cm[0]=b.toString()),b=Cm);for(let S=0;S<b.length;S++){let G=vm(f,b[S],_||h.handleEvent,!1,h.h||h);if(!G)break;h.g[G.key]=G}h=a.J?Im(a.J):{},a.u?(a.v||(a.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,h)):(a.v="GET",a.g.ea(a.B,a.v,null,h)),ws(1),uA(a.i,a.v,a.B,a.l,a.S,a.u)}vn.prototype.ba=function(a){a=a.target;let h=this.O;h&&Rn(a)==3?h.j():this.Y(a)},vn.prototype.Y=function(a){try{if(a==this.g)e:{let se=Rn(this.g),Ue=this.g.ya(),ge=this.g.ca();if(!(se<3)&&(se!=3||this.g&&(this.h.h||this.g.la()||a_(this.g)))){this.K||se!=4||Ue==7||(Ue==8||ge<=0?ws(3):ws(2)),ih(this);var h=this.g.ca();this.X=h;var f=pA(this);if(this.o=h==200,lA(this.i,this.v,this.B,this.l,this.S,se,h),this.o){if(this.U&&!this.L){t:{if(this.g){var _,b=this.g;if((_=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(_)){var S=_;break t}}S=null}if(a=S)oi(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,sh(this,a);else{this.o=!1,this.m=3,nt(12),pr(this),bs(this);break e}}if(this.R){a=!0;let We;for(;!this.K&&this.C<f.length;)if(We=gA(this,f),We==nh){se==4&&(this.m=4,nt(14),a=!1),oi(this.i,this.l,null,"[Incomplete Response]");break}else if(We==Bm){this.m=4,nt(15),oi(this.i,this.l,f,"[Invalid Chunk]"),a=!1;break}else oi(this.i,this.l,We,null),sh(this,We);if(Wm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),se!=4||f.length!=0||this.h.h||(this.m=1,nt(16),a=!1),this.o=this.o&&a,!a)oi(this.i,this.l,f,"[Invalid Chunked Response]"),pr(this),bs(this);else if(f.length>0&&!this.W){this.W=!0;var G=this.j;G.g==this&&G.aa&&!G.P&&(G.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),dh(G),G.P=!0,nt(11))}}else oi(this.i,this.l,f,null),sh(this,f);se==4&&pr(this),this.o&&!this.K&&(se==4?p_(this.j,this):(this.o=!1,Ma(this)))}else CA(this.g),h==400&&f.indexOf("Unknown SID")>0?(this.m=3,nt(12)):(this.m=0,nt(13)),pr(this),bs(this)}}}catch{}};function pA(a){if(!Wm(a))return a.g.la();let h=a_(a.g);if(h==="")return"";let f="",_=h.length,b=Rn(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return pr(a),bs(a),"";a.h.i=new o.TextDecoder}for(let S=0;S<_;S++)a.h.h=!0,f+=a.h.i.decode(h[S],{stream:!(b&&S==_-1)});return h.length=0,a.h.g+=f,a.C=0,a.h.g}function Wm(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function gA(a,h){var f=a.C,_=h.indexOf(`
`,f);return _==-1?nh:(f=Number(h.substring(f,_)),isNaN(f)?Bm:(_+=1,_+f>h.length?nh:(h=h.slice(_,_+f),a.C=_+f,h)))}vn.prototype.cancel=function(){this.K=!0,pr(this)};function Ma(a){a.T=Date.now()+a.H,zm(a,a.H)}function zm(a,h){if(a.D!=null)throw Error("WatchDog timer not null");a.D=vs(l(a.aa,a),h)}function ih(a){a.D&&(o.clearTimeout(a.D),a.D=null)}vn.prototype.aa=function(){this.D=null;let a=Date.now();a-this.T>=0?(hA(this.i,this.B),this.M!=2&&(ws(3),nt(17)),pr(this),this.m=2,bs(this)):zm(this,this.T-a)};function bs(a){a.j.I==0||a.K||p_(a.j,a)}function pr(a){ih(a);var h=a.O;h&&typeof h.dispose=="function"&&h.dispose(),a.O=null,km(a.V),a.g&&(h=a.g,a.g=null,h.abort(),h.dispose())}function sh(a,h){try{var f=a.j;if(f.I!=0&&(f.g==a||oh(f.h,a))){if(!a.L&&oh(f.h,a)&&f.I==3){try{var _=f.Ba.g.parse(h)}catch{_=null}if(Array.isArray(_)&&_.length==3){var b=_;if(b[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<a.F)ja(f),Wa(f);else break e;hh(f),nt(18)}}else f.xa=b[1],0<f.xa-f.K&&b[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=vs(l(f.Va,f),6e3));$m(f.h)<=1&&f.ta&&(f.ta=void 0)}else mr(f,11)}else if((a.L||f.g==a)&&ja(f),!I(h))for(b=f.Ba.g.parse(h),h=0;h<b.length;h++){let ge=b[h],We=ge[0];if(!(We<=f.K))if(f.K=We,ge=ge[1],f.I==2)if(ge[0]=="c"){f.M=ge[1],f.ba=ge[2];let Bt=ge[3];Bt!=null&&(f.ka=Bt,f.j.info("VER="+f.ka));let _r=ge[4];_r!=null&&(f.za=_r,f.j.info("SVER="+f.za));let Pn=ge[5];Pn!=null&&typeof Pn=="number"&&Pn>0&&(_=1.5*Pn,f.O=_,f.j.info("backChannelRequestTimeoutMs_="+_)),_=f;let Sn=a.g;if(Sn){let $a=Sn.g?Sn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($a){var S=_.h;S.g||$a.indexOf("spdy")==-1&&$a.indexOf("quic")==-1&&$a.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(ah(S,S.h),S.h=null))}if(_.G){let fh=Sn.g?Sn.g.getResponseHeader("X-HTTP-Session-Id"):null;fh&&(_.wa=fh,me(_.J,_.G,fh))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-a.F,f.j.info("Handshake RTT: "+f.T+"ms")),_=f;var G=a;if(_.na=__(_,_.L?_.ba:null,_.W),G.L){Hm(_.h,G);var se=G,Ue=_.O;Ue&&(se.H=Ue),se.D&&(ih(se),Ma(se)),_.g=G}else d_(_);f.i.length>0&&za(f)}else ge[0]!="stop"&&ge[0]!="close"||mr(f,7);else f.I==3&&(ge[0]=="stop"||ge[0]=="close"?ge[0]=="stop"?mr(f,7):lh(f):ge[0]!="noop"&&f.l&&f.l.qa(ge),f.A=0)}}ws(4)}catch{}}var mA=class{constructor(a,h){this.g=a,this.map=h}};function jm(a){this.l=a||10,o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gm(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function $m(a){return a.h?1:a.g?a.g.size:0}function oh(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function ah(a,h){a.g?a.g.add(h):a.h=h}function Hm(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}jm.prototype.cancel=function(){if(this.i=Km(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Km(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let h=a.i;for(let f of a.g.values())h=h.concat(f.G);return h}return w(a.i)}var Qm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _A(a,h){if(a){a=a.split("&");for(let f=0;f<a.length;f++){let _=a[f].indexOf("="),b,S=null;_>=0?(b=a[f].substring(0,_),S=a[f].substring(_+1)):b=a[f],h(b,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function An(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;a instanceof An?(this.l=a.l,Rs(this,a.j),this.o=a.o,this.g=a.g,Ps(this,a.u),this.h=a.h,ch(this,t_(a.i)),this.m=a.m):a&&(h=String(a).match(Qm))?(this.l=!1,Rs(this,h[1]||"",!0),this.o=Ss(h[2]||""),this.g=Ss(h[3]||"",!0),Ps(this,h[4]),this.h=Ss(h[5]||"",!0),ch(this,h[6]||"",!0),this.m=Ss(h[7]||"")):(this.l=!1,this.i=new ks(null,this.l))}An.prototype.toString=function(){let a=[];var h=this.j;h&&a.push(Cs(h,Jm,!0),":");var f=this.g;return(f||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Cs(h,Jm,!0),"@"),a.push(ai(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&a.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(Cs(f,f.charAt(0)=="/"?EA:IA,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",Cs(f,wA)),a.join("")},An.prototype.resolve=function(a){let h=Ut(this),f=!!a.j;f?Rs(h,a.j):f=!!a.o,f?h.o=a.o:f=!!a.g,f?h.g=a.g:f=a.u!=null;var _=a.h;if(f)Ps(h,a.u);else if(f=!!a.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var b=h.h.lastIndexOf("/");b!=-1&&(_=h.h.slice(0,b+1)+_)}if(b=_,b==".."||b==".")_="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){_=b.lastIndexOf("/",0)==0,b=b.split("/");let S=[];for(let G=0;G<b.length;){let se=b[G++];se=="."?_&&G==b.length&&S.push(""):se==".."?((S.length>1||S.length==1&&S[0]!="")&&S.pop(),_&&G==b.length&&S.push("")):(S.push(se),_=!0)}_=S.join("/")}else _=b}return f?h.h=_:f=a.i.toString()!=="",f?ch(h,t_(a.i)):f=!!a.m,f&&(h.m=a.m),h};function Ut(a){return new An(a)}function Rs(a,h,f){a.j=f?Ss(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Ps(a,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);a.u=h}else a.u=null}function ch(a,h,f){h instanceof ks?(a.i=h,vA(a.i,a.l)):(f||(h=Cs(h,TA)),a.i=new ks(h,a.l))}function me(a,h,f){a.i.set(h,f)}function Fa(a){return me(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function Ss(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Cs(a,h,f){return typeof a=="string"?(a=encodeURI(a).replace(h,yA),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function yA(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Jm=/[#\/\?@]/g,IA=/[#\?:]/g,EA=/[#\?]/g,TA=/[#\?@]/g,wA=/#/g;function ks(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function gr(a){a.g||(a.g=new Map,a.h=0,a.i&&_A(a.i,function(h,f){a.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}n=ks.prototype,n.add=function(a,h){gr(this),this.i=null,a=ci(this,a);let f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(h),this.h+=1,this};function Ym(a,h){gr(a),h=ci(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Xm(a,h){return gr(a),h=ci(a,h),a.g.has(h)}n.forEach=function(a,h){gr(this),this.g.forEach(function(f,_){f.forEach(function(b){a.call(h,b,_,this)},this)},this)};function Zm(a,h){gr(a);let f=[];if(typeof h=="string")Xm(a,h)&&(f=f.concat(a.g.get(ci(a,h))));else for(a=Array.from(a.g.values()),h=0;h<a.length;h++)f=f.concat(a[h]);return f}n.set=function(a,h){return gr(this),this.i=null,a=ci(this,a),Xm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},n.get=function(a,h){return a?(a=Zm(this,a),a.length>0?String(a[0]):h):h};function e_(a,h,f){Ym(a,h),f.length>0&&(a.i=null,a.g.set(ci(a,h),w(f)),a.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],h=Array.from(this.g.keys());for(let _=0;_<h.length;_++){var f=h[_];let b=ai(f);f=Zm(this,f);for(let S=0;S<f.length;S++){let G=b;f[S]!==""&&(G+="="+ai(f[S])),a.push(G)}}return this.i=a.join("&")};function t_(a){let h=new ks;return h.i=a.i,a.g&&(h.g=new Map(a.g),h.h=a.h),h}function ci(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function vA(a,h){h&&!a.j&&(gr(a),a.i=null,a.g.forEach(function(f,_){let b=_.toLowerCase();_!=b&&(Ym(this,_),e_(this,b,f))},a)),a.j=h}function AA(a,h){let f=new As;if(o.Image){let _=new Image;_.onload=d(bn,f,"TestLoadImage: loaded",!0,h,_),_.onerror=d(bn,f,"TestLoadImage: error",!1,h,_),_.onabort=d(bn,f,"TestLoadImage: abort",!1,h,_),_.ontimeout=d(bn,f,"TestLoadImage: timeout",!1,h,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=a}else h(!1)}function bA(a,h){let f=new As,_=new AbortController,b=setTimeout(()=>{_.abort(),bn(f,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:_.signal}).then(S=>{clearTimeout(b),S.ok?bn(f,"TestPingServer: ok",!0,h):bn(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(b),bn(f,"TestPingServer: error",!1,h)})}function bn(a,h,f,_,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),_(f)}catch{}}function RA(){this.g=new cA}function Ua(a){this.i=a.Sb||null,this.h=a.ab||!1}p(Ua,Dm),Ua.prototype.g=function(){return new Ba(this.i,this.h)};function Ba(a,h){$e.call(this),this.H=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Ba,$e),n=Ba.prototype,n.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=h,this.readyState=1,Ns(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(h.body=a),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ds(this)),this.readyState=0},n.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ns(this)),this.g&&(this.readyState=3,Ns(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;n_(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function n_(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}n.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Ds(this):Ns(this),this.readyState==3&&n_(this)}},n.Oa=function(a){this.g&&(this.response=this.responseText=a,Ds(this))},n.Na=function(a){this.g&&(this.response=a,Ds(this))},n.ga=function(){this.g&&Ds(this)};function Ds(a){a.readyState=4,a.l=null,a.j=null,a.B=null,Ns(a)}n.setRequestHeader=function(a,h){this.A.append(a,h)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=h.next();return a.join(`\r
`)};function Ns(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ba.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function r_(a){let h="";return Na(a,function(f,_){h+=_,h+=":",h+=f,h+=`\r
`}),h}function uh(a,h,f){e:{for(_ in f){var _=!1;break e}_=!0}_||(f=r_(f),typeof a=="string"?(ai(h),f!=null&&ai(f)):me(a,h,f))}function Se(a){$e.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Se,$e);var PA=/^https?$/i,SA=["POST","PUT"];n=Se.prototype,n.Fa=function(a){this.H=a},n.ea=function(a,h,f,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Fm.g(),this.g.onreadystatechange=m(l(this.Ca,this));try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(S){i_(this,S);return}if(a=f||"",f=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var b in _)f.set(b,_[b]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(let S of _.keys())f.set(S,_.get(S));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(f.keys()).find(S=>S.toLowerCase()=="content-type"),b=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(SA,h,void 0)>=0)||_||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,G]of f)this.g.setRequestHeader(S,G);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(S){i_(this,S)}};function i_(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.o=5,s_(a),qa(a)}function s_(a){a.A||(a.A=!0,tt(a,"complete"),tt(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,tt(this,"complete"),tt(this,"abort"),qa(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qa(this,!0)),Se.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?o_(this):this.Xa())},n.Xa=function(){o_(this)};function o_(a){if(a.h&&typeof s<"u"){if(a.v&&Rn(a)==4)setTimeout(a.Ca.bind(a),0);else if(tt(a,"readystatechange"),Rn(a)==4){a.h=!1;try{let S=a.ca();e:switch(S){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var _;if(_=S===0){let G=String(a.D).match(Qm)[1]||null;!G&&o.self&&o.self.location&&(G=o.self.location.protocol.slice(0,-1)),_=!PA.test(G?G.toLowerCase():"")}f=_}if(f)tt(a,"complete"),tt(a,"success");else{a.o=6;try{var b=Rn(a)>2?a.g.statusText:""}catch{b=""}a.l=b+" ["+a.ca()+"]",s_(a)}}finally{qa(a)}}}}function qa(a,h){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);let f=a.g;a.g=null,h||tt(a,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Rn(a){return a.g?a.g.readyState:0}n.ca=function(){try{return Rn(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),aA(h)}};function a_(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function CA(a){let h={};a=(a.g&&Rn(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<a.length;_++){if(I(a[_]))continue;var f=fA(a[_]);let b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let S=h[b]||[];h[b]=S,S.push(f)}nA(h,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vs(a,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||h}function c_(a){this.za=0,this.i=[],this.j=new As,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vs("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vs("baseRetryDelayMs",5e3,a),this.Za=Vs("retryDelaySeedMs",1e4,a),this.Ta=Vs("forwardChannelMaxRetries",2,a),this.va=Vs("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new jm(a&&a.concurrentRequestLimit),this.Ba=new RA,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=c_.prototype,n.ka=8,n.I=1,n.connect=function(a,h,f,_){nt(0),this.W=a,this.H=h||{},f&&_!==void 0&&(this.H.OSID=f,this.H.OAID=_),this.F=this.X,this.J=__(this,null,this.W),za(this)};function lh(a){if(u_(a),a.I==3){var h=a.V++,f=Ut(a.J);if(me(f,"SID",a.M),me(f,"RID",h),me(f,"TYPE","terminate"),Os(a,f),h=new vn(a,a.j,h),h.M=2,h.A=Fa(Ut(f)),f=!1,o.navigator&&o.navigator.sendBeacon)try{f=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!f&&o.Image&&(new Image().src=h.A,f=!0),f||(h.g=y_(h.j,null),h.g.ea(h.A)),h.F=Date.now(),Ma(h)}m_(a)}function Wa(a){a.g&&(dh(a),a.g.cancel(),a.g=null)}function u_(a){Wa(a),a.v&&(o.clearTimeout(a.v),a.v=null),ja(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&o.clearTimeout(a.m),a.m=null)}function za(a){if(!Gm(a.h)&&!a.m){a.m=!0;var h=a.Ea;ae||y(),ie||(ae(),ie=!0),T.add(h,a),a.D=0}}function kA(a,h){return $m(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=h.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=vs(l(a.Ea,a,h),g_(a,a.D)),a.D++,!0)}n.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;let b=new vn(this,this.j,a),S=this.o;if(this.U&&(S?(S=Im(S),Tm(S,this.U)):S=this.U),this.u!==null||this.R||(b.J=S,S=null),this.S)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var _=this.i[f];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(h+=_,h>4096){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=h_(this,b,h),f=Ut(this.J),me(f,"RID",a),me(f,"CVER",22),this.G&&me(f,"X-HTTP-Session-Id",this.G),Os(this,f),S&&(this.R?h="headers="+ai(r_(S))+"&"+h:this.u&&uh(f,this.u,S)),ah(this.h,b),this.Ra&&me(f,"TYPE","init"),this.S?(me(f,"$req",h),me(f,"SID","null"),b.U=!0,rh(b,f,null)):rh(b,f,h),this.I=2}}else this.I==3&&(a?l_(this,a):this.i.length==0||Gm(this.h)||l_(this))};function l_(a,h){var f;h?f=h.l:f=a.V++;let _=Ut(a.J);me(_,"SID",a.M),me(_,"RID",f),me(_,"AID",a.K),Os(a,_),a.u&&a.o&&uh(_,a.u,a.o),f=new vn(a,a.j,f,a.D+1),a.u===null&&(f.J=a.o),h&&(a.i=h.G.concat(a.i)),h=h_(a,f,1e3),f.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),ah(a.h,f),rh(f,_,h)}function Os(a,h){a.H&&Na(a.H,function(f,_){me(h,_,f)}),a.l&&Na({},function(f,_){me(h,_,f)})}function h_(a,h,f){f=Math.min(a.i.length,f);let _=a.l?l(a.l.Ka,a.l,a):null;e:{var b=a.i;let se=-1;for(;;){let Ue=["count="+f];se==-1?f>0?(se=b[0].g,Ue.push("ofs="+se)):se=0:Ue.push("ofs="+se);let ge=!0;for(let We=0;We<f;We++){var S=b[We].g;let Bt=b[We].map;if(S-=se,S<0)se=Math.max(0,b[We].g-100),ge=!1;else try{S="req"+S+"_"||"";try{var G=Bt instanceof Map?Bt:Object.entries(Bt);for(let[_r,Pn]of G){let Sn=Pn;c(Pn)&&(Sn=Xl(Pn)),Ue.push(S+_r+"="+encodeURIComponent(Sn))}}catch(_r){throw Ue.push(S+"type="+encodeURIComponent("_badmap")),_r}}catch{_&&_(Bt)}}if(ge){G=Ue.join("&");break e}}G=void 0}return a=a.i.splice(0,f),h.G=a,G}function d_(a){if(!a.g&&!a.v){a.Y=1;var h=a.Da;ae||y(),ie||(ae(),ie=!0),T.add(h,a),a.A=0}}function hh(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=vs(l(a.Da,a),g_(a,a.A)),a.A++,!0)}n.Da=function(){if(this.v=null,f_(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=vs(l(this.Wa,this),a)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,nt(10),Wa(this),f_(this))};function dh(a){a.B!=null&&(o.clearTimeout(a.B),a.B=null)}function f_(a){a.g=new vn(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var h=Ut(a.na);me(h,"RID","rpc"),me(h,"SID",a.M),me(h,"AID",a.K),me(h,"CI",a.F?"0":"1"),!a.F&&a.ia&&me(h,"TO",a.ia),me(h,"TYPE","xmlhttp"),Os(a,h),a.u&&a.o&&uh(h,a.u,a.o),a.O&&(a.g.H=a.O);var f=a.g;a=a.ba,f.M=1,f.A=Fa(Ut(h)),f.u=null,f.R=!0,qm(f,a)}n.Va=function(){this.C!=null&&(this.C=null,Wa(this),hh(this),nt(19))};function ja(a){a.C!=null&&(o.clearTimeout(a.C),a.C=null)}function p_(a,h){var f=null;if(a.g==h){ja(a),dh(a),a.g=null;var _=2}else if(oh(a.h,h))f=h.G,Hm(a.h,h),_=1;else return;if(a.I!=0){if(h.o)if(_==1){f=h.u?h.u.length:0,h=Date.now()-h.F;var b=a.D;_=xa(),tt(_,new Lm(_,f,h,b)),za(a)}else d_(a);else if(b=h.m,b==3||b==0&&h.X>0||!(_==1&&kA(a,h)||_==2&&hh(a)))switch(f&&f.length>0&&(h=a.h,h.i=h.i.concat(f)),b){case 1:mr(a,5);break;case 4:mr(a,10);break;case 3:mr(a,6);break;default:mr(a,2)}}}function g_(a,h){let f=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(f*=2),f*h}function mr(a,h){if(a.j.info("Error code "+h),h==2){var f=l(a.bb,a),_=a.Ua;let b=!_;_=new An(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Rs(_,"https"),Fa(_),b?AA(_.toString(),f):bA(_.toString(),f)}else nt(2);a.I=0,a.l&&a.l.pa(h),m_(a),u_(a)}n.bb=function(a){a?(this.j.info("Successfully pinged google.com"),nt(2)):(this.j.info("Failed to ping google.com"),nt(1))};function m_(a){if(a.I=0,a.ja=[],a.l){let h=Km(a.h);(h.length!=0||a.i.length!=0)&&(k(a.ja,h),k(a.ja,a.i),a.h.i.length=0,w(a.i),a.i.length=0),a.l.oa()}}function __(a,h,f){var _=f instanceof An?Ut(f):new An(f);if(_.g!="")h&&(_.g=h+"."+_.g),Ps(_,_.u);else{var b=o.location;_=b.protocol,h=h?h+"."+b.hostname:b.hostname,b=+b.port;let S=new An(null);_&&Rs(S,_),h&&(S.g=h),b&&Ps(S,b),f&&(S.h=f),_=S}return f=a.G,h=a.wa,f&&h&&me(_,f,h),me(_,"VER",a.ka),Os(a,_),_}function y_(a,h,f){if(h&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Aa&&!a.ma?new Se(new Ua({ab:f})):new Se(a.ma),h.Fa(a.L),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function I_(){}n=I_.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ga(){}Ga.prototype.g=function(a,h){return new pt(a,h)};function pt(a,h){$e.call(this),this.g=new c_(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(a?a["X-WebChannel-Client-Profile"]=h.sa:a={"X-WebChannel-Client-Profile":h.sa}),this.g.U=a,(a=h&&h.Qb)&&!I(a)&&(this.g.u=a),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!I(h)&&(this.g.G=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new ui(this)}p(pt,$e),pt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},pt.prototype.close=function(){lh(this.g)},pt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.v&&(f={},f.__data__=Xl(a),a=f);h.i.push(new mA(h.Ya++,a)),h.I==3&&za(h)},pt.prototype.N=function(){this.g.l=null,delete this.j,lh(this.g),delete this.g,pt.Z.N.call(this)};function E_(a){Zl.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(let f in h){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}p(E_,Zl);function T_(){eh.call(this),this.status=1}p(T_,eh);function ui(a){this.g=a}p(ui,I_),ui.prototype.ra=function(){tt(this.g,"a")},ui.prototype.qa=function(a){tt(this.g,new E_(a))},ui.prototype.pa=function(a){tt(this.g,new T_(a))},ui.prototype.oa=function(){tt(this.g,"b")},Ga.prototype.createWebChannel=Ga.prototype.g,pt.prototype.send=pt.prototype.o,pt.prototype.open=pt.prototype.m,pt.prototype.close=pt.prototype.close,$t.exports.createWebChannelTransport=function(){return new Ga},$t.exports.getStatEventTarget=function(){return xa()},$t.exports.Event=fr,$t.exports.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},La.NO_ERROR=0,La.TIMEOUT=8,La.HTTP_ERROR=6,$t.exports.ErrorCode=La,Mm.COMPLETE="complete",$t.exports.EventType=Mm,Nm.EventType=Ts,Ts.OPEN="a",Ts.CLOSE="b",Ts.ERROR="c",Ts.MESSAGE="d",$e.prototype.listen=$e.prototype.J,$t.exports.WebChannel=Nm,$t.exports.FetchXmlHttpFactory=Ua,Se.prototype.listenOnce=Se.prototype.K,Se.prototype.getLastError=Se.prototype.Ha,Se.prototype.getLastErrorCode=Se.prototype.ya,Se.prototype.getStatus=Se.prototype.ca,Se.prototype.getResponseJson=Se.prototype.La,Se.prototype.getResponseText=Se.prototype.la,Se.prototype.send=Se.prototype.ea,Se.prototype.setWithCredentials=Se.prototype.Fa,$t.exports.XhrIo=Se}).apply(typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})});var $w=Ne(C=>{"use strict";var Mo=Er(),he=Pt(),jn=Zd(),Kt=Ir(),ct=ef();var Le=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Le.UNAUTHENTICATED=new Le(null),Le.GOOGLE_CREDENTIALS=new Le("google-credentials-uid"),Le.FIRST_PARTY=new Le("first-party-uid"),Le.MOCK_USER=new Le("mock-user");var Zi="12.9.0";function _0(n){Zi=n}var $n=new Kt.Logger("@firebase/firestore");function Ai(){return $n.logLevel}function y0(n){$n.setLogLevel(n)}function F(n,...e){if($n.logLevel<=Kt.LogLevel.DEBUG){let t=e.map(tg);$n.debug(`Firestore (${Zi}): ${n}`,...t)}}function ke(n,...e){if($n.logLevel<=Kt.LogLevel.ERROR){let t=e.map(tg);$n.error(`Firestore (${Zi}): ${n}`,...t)}}function Vt(n,...e){if($n.logLevel<=Kt.LogLevel.WARN){let t=e.map(tg);$n.warn(`Firestore (${Zi}): ${n}`,...t)}}function tg(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function J(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,qE(n,r,t)}function qE(n,e,t){let r=`FIRESTORE (${Zi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ke(r),new Error(r)}function Y(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||qE(e,i,r)}function I0(n,e){n||J(57014,e)}function j(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},z=class extends he.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var De=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}};var tu=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},nu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Le.UNAUTHENTICATED)))}shutdown(){}},lf=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}},hf=class{constructor(e){this.t=e,this.currentUser=Le.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0,42304);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new De;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new De,e.enqueueRetryable((()=>i(this.currentUser)))};let o=()=>{let u=s;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new De)}}),0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string",31837,{l:r}),new tu(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string",2055,{h:e}),new Le(e)}},df=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Le.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},ff=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new df(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Le.FIRST_PARTY)))}shutdown(){}invalidateToken(){}},Fo=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},pf=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mo._isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Y(this.o===void 0,3512);let r=s=>{s.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,F("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};let i=s=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Fo(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Y(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Fo(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}},gf=class{getToken(){return Promise.resolve(new Fo(""))}invalidateToken(){}start(e,t){}shutdown(){}};function E0(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Uo=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=E0(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function ne(n,e){return n<e?-1:n>e?1:0}function mf(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return tf(i)===tf(s)?ne(i,s):tf(i)?1:-1}return ne(n.length,e.length)}var T0=55296,w0=57343;function tf(n){let e=n.charCodeAt(0);return e>=T0&&e<=w0}function Di(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function v0(n,e,t){return n===void 0&&e===void 0||n!==void 0&&e!==void 0&&t(n,e)}function WE(n){return n+"\0"}var ru="__name__",iu=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&J(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&J(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return ne(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):mf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return jn.Integer.fromString(e.substring(4,e.length-2))}},ce=class n extends iu{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new z(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new n(t)}static emptyPath(){return new n([])}},A0=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Re=class n extends iu{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return A0.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ru}static keyField(){return new n([ru])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new z(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new z(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new z(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new z(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var $=class n{constructor(e){this.path=e}static fromPath(e){return new n(ce.fromString(e))}static fromName(e){return new n(ce.fromString(e).popFirst(5))}static empty(){return new n(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ce(e.slice()))}};function ng(n,e,t){if(!t)throw new z(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function zE(n,e,t,r){if(e===!0&&r===!0)throw new z(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function NI(n){if(!$.isDocumentKey(n))throw new z(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function VI(n){if($.isDocumentKey(n))throw new z(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ul(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ll(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":J(12329,{type:typeof n})}function At(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new z(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ll(n);throw new z(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function b0(n,e){if(e<=0)throw new z(N.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function It(n,e){let t={typeString:n};return e&&(t.value=e),t}function es(n,e){if(!ul(n))throw new z(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new z(N.INVALID_ARGUMENT,t);return!0}var OI=-62135596800,xI=1e6,Ee=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*xI);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new z(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new z(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<OI)throw new z(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new z(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/xI}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(es(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-OI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Ee._jsonSchemaVersion="firestore/timestamp/1.0",Ee._jsonSchema={type:It("string",Ee._jsonSchemaVersion),seconds:It("number"),nanoseconds:It("number")};var Z=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ee(0,0))}static max(){return new n(new Ee(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ni=-1,Fr=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function _f(n){return n.fields.find((e=>e.kind===2))}function Pr(n){return n.fields.filter((e=>e.kind!==2))}function R0(n,e){let t=ne(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=P0(n.fields[r],e.fields[r]),t!==0)return t;return ne(n.fields.length,e.fields.length)}Fr.UNKNOWN_ID=-1;var xr=class{constructor(e,t){this.fieldPath=e,this.kind=t}};function P0(n,e){let t=Re.comparator(n.fieldPath,e.fieldPath);return t!==0?t:ne(n.kind,e.kind)}var Vi=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,wt.min())}};function jE(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Z.fromTimestamp(r===1e9?new Ee(t+1,0):new Ee(t,r));return new wt(i,$.empty(),e)}function GE(n){return new wt(n.readTime,n.key,Ni)}var wt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Z.min(),$.empty(),Ni)}static max(){return new n(Z.max(),$.empty(),Ni)}};function rg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=$.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}var $E="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",su=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}};async function ir(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==$E)throw n;F("LocalStore","Unexpectedly lost primary lease")}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):n.reject(t)}static resolve(e){return new n(((t,r)=>{t(e)}))}static reject(e){return new n(((t,r)=>{r(e)}))}static waitFor(e){return new n(((t,r)=>{let i=0,s=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++s,o&&s===i&&t()}),(u=>r(u)))})),o=!0,s===i&&t()}))}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next((i=>i?n.resolve(i):r()));return t}static forEach(e,t){let r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new n(((r,i)=>{let s=e.length,o=new Array(s),c=0;for(let u=0;u<s;u++){let l=u;t(e[l]).next((d=>{o[l]=d,++c,c===s&&r(o)}),(d=>i(d)))}}))}static doWhile(e,t){return new n(((r,i)=>{let s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}};var _t="SimpleDb",ou=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new Lr(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new De,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Lr(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{let i=ig(r.target.error);this.S.reject(new Lr(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(F(_t,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new If(t)}},Hn=class n{static delete(e){return F(_t,"Removing database:",e),Cr(he.getGlobal().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!he.isIndexedDBAvailable())return!1;if(n.F())return!0;let e=he.getUA(),t=n.M(e),r=0<t&&t<10,i=HE(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,n.M(he.getUA())===12.2&&ke("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(F(_t,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Lr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new z(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new z(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Lr(e,o))},i.onupgradeneeded=s=>{F(_t,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next((()=>{F(_t,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){let s=t==="readonly",o=0;for(;;){++o;try{this.db=await this.L(e);let c=ou.open(this.db,e,s?"readonly":"readwrite",r),u=i(c).next((l=>(c.C(),l))).catch((l=>(c.abort(l),P.reject(l)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){let u=c,l=u.name!=="FirebaseError"&&o<3;if(F(_t,"Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}};function HE(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var yf=class{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Cr(this.U.delete())}},Lr=class extends z{constructor(e,t){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function sr(n){return n.name==="IndexedDbTransactionError"}var If=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(F(_t,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(F(_t,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Cr(r)}add(e){return F(_t,"ADD",this.store.name,e,e),Cr(this.store.add(e))}get(e){return Cr(this.store.get(e)).next((t=>(t===void 0&&(t=null),F(_t,"GET",this.store.name,e,t),t)))}delete(e){return F(_t,"DELETE",this.store.name,e),Cr(this.store.delete(e))}count(){return F(_t,"COUNT",this.store.name),Cr(this.store.count())}H(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new P(((o,c)=>{s.onerror=u=>{c(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{let s=this.cursor(r),o=[];return this.J(s,((c,u)=>{o.push(u)})).next((()=>o))}}Z(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new P(((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}X(e,t){F(_t,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Y=!1;let i=this.cursor(r);return this.J(i,((s,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.J(i,t)}te(e){let t=this.cursor({});return new P(((r,i)=>{t.onerror=s=>{let o=ig(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}J(e,t){let r=[];return new P(((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let c=o.target.result;if(!c)return void i();let u=new yf(c),l=t(c.primaryKey,c.value,u);if(l instanceof P){let d=l.catch((p=>(u.done(),P.reject(p))));r.push(d)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>P.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Cr(n){return new P(((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=ig(r.target.error);t(i)}}))}var LI=!1;function ig(n){let e=Hn.M(he.getUA());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return LI||(LI=!0,setTimeout((()=>{throw r}),0)),r}}return n}var So="IndexBackfiller",Ef=class{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){F(So,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{let t=await this.ne.ie();F(So,`Documents written: ${t}`)}catch(t){sr(t)?F(So,"Ignoring IndexedDB error during index backfill: ",t):await ir(t)}await this.re(6e4)}))}},Tf=class{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){let r=new Set,i=t,s=!0;return P.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return F(So,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,s))).next((c=>(F(So,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{let o=GE(s);rg(o,r)>0&&(r=o)})),new wt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Ye=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}};Ye.ce=-1;var Gn=-1;function da(n){return n==null}function Bo(n){return n===0&&1/n==-1/0}function S0(n){return typeof n=="number"}function KE(n){return typeof n=="number"&&Number.isInteger(n)&&!Bo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function C0(n){return typeof n=="string"}var au="";function Xe(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=MI(e)),e=k0(n.get(t),e);return MI(e)}function k0(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case au:t+="";break;default:t+=s}}return t}function MI(n){return n+au+""}function Qt(n){let e=n.length;if(Y(e>=2,64408,{path:n}),e===2)return Y(n.charAt(0)===au&&n.charAt(1)==="",56145,{path:n}),ce.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf(au,s);switch((o<0||o>t)&&J(50515,{path:n}),n.charAt(o+1)){case"":let c=n.substring(s,o),u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:J(61167,{path:n})}s=o+2}return new ce(r)}var Sr="remoteDocuments",fa="owner",yi="owner",qo="mutationQueues",D0="userId",kt="mutations",FI="batchId",Vr="userMutationsIndex",UI=["userId","batchId"];function Hc(n,e){return[n,Xe(e)]}function QE(n,e,t){return[n,Xe(e),t]}var N0={},Oi="documentMutations",cu="remoteDocumentsV14",V0=["prefixPath","collectionGroup","readTime","documentId"],Kc="documentKeyIndex",O0=["prefixPath","collectionGroup","documentId"],JE="collectionGroupIndex",x0=["collectionGroup","readTime","prefixPath","documentId"],Wo="remoteDocumentGlobal",wf="remoteDocumentGlobalKey",xi="targets",YE="queryTargetsIndex",L0=["canonicalId","targetId"],Li="targetDocuments",M0=["targetId","path"],sg="documentTargetsIndex",F0=["path","targetId"],uu="targetGlobalKey",Mr="targetGlobal",zo="collectionParents",U0=["collectionId","parent"],Mi="clientMetadata",B0="clientId",hl="bundles",q0="bundleId",dl="namedQueries",W0="name",og="indexConfiguration",z0="indexId",vf="collectionGroupIndex",j0="collectionGroup",Co="indexState",G0=["indexId","uid"],XE="sequenceNumberIndex",$0=["uid","sequenceNumber"],ko="indexEntries",H0=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ZE="documentKeyIndex",K0=["indexId","uid","orderedDocumentKey"],fl="documentOverlays",Q0=["userId","collectionPath","documentId"],Af="collectionPathOverlayIndex",J0=["userId","collectionPath","largestBatchId"],eT="collectionGroupOverlayIndex",Y0=["userId","collectionGroup","largestBatchId"],ag="globals",X0="name",tT=[qo,kt,Oi,Sr,xi,fa,Mr,Li,Mi,Wo,zo,hl,dl],Z0=[...tT,fl],nT=[qo,kt,Oi,cu,xi,fa,Mr,Li,Mi,Wo,zo,hl,dl,fl],rT=nT,cg=[...rT,og,Co,ko],eD=cg,iT=[...cg,ag],tD=iT;var jo=class extends su{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}};function qe(n,e){let t=j(n);return Hn.O(t.le,e)}function BI(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function or(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ug(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function sT(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Te=class n{constructor(e,t){this.comparator=e,this.root=t||Yt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Yt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Yt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){let e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Si(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Si(this.root,e,this.comparator,!1)}getReverseIterator(){return new Si(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Si(this.root,e,this.comparator,!0)}},Si=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Yt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}};Yt.EMPTY=null,Yt.RED=!0,Yt.BLACK=!1;Yt.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Yt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var pe=class n{constructor(e){this.comparator=e,this.data=new Te(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new lu(this.data.getIterator())}getIteratorFrom(e){return new lu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach((t=>{e.push(t)})),e}toString(){let e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},lu=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ii(n){return n.hasNext()?n.getNext():void 0}var yt=class n{constructor(e){this.fields=e,e.sort(Re.comparator)}static empty(){return new n([])}unionWith(e){let t=new pe(Re.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Di(this.fields,e.fields,((t,r)=>t.isEqual(r)))}};var hu=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function nD(){return typeof atob<"u"}var Ce=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new hu("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ce.EMPTY_BYTE_STRING=new Ce("");var rD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pn(n){if(Y(!!n,39018),typeof n=="string"){let e=0,t=rD.exec(n);if(Y(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:we(n.seconds),nanos:we(n.nanos)}}function we(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gn(n){return typeof n=="string"?Ce.fromBase64String(n):Ce.fromUint8Array(n)}var oT="server_timestamp",aT="__type__",cT="__previous_value__",uT="__local_write_time__";function pl(n){return(n?.mapValue?.fields||{})[aT]?.stringValue===oT}function gl(n){let e=n.mapValue.fields[cT];return pl(e)?gl(e):e}function Go(n){let e=pn(n.mapValue.fields[uT].timestampValue);return new Ee(e.seconds,e.nanos)}var bf=class{constructor(e,t,r,i,s,o,c,u,l,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=d,this.apiKey=p}},$o="(default)",Ur=class n{constructor(e,t){this.projectId=e,this.database=t||$o}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===$o}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function iD(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new z(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ur(n.options.projectId,e)}var lg="__type__",lT="__max__",zn={mapValue:{fields:{__type__:{stringValue:lT}}}},hg="__vector__",Fi="value",Qc={nullValue:"NULL_VALUE"};function Kn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?pl(n)?4:hT(n)?9007199254740991:_l(n)?10:11:J(28295,{value:n})}function Xt(n,e){if(n===e)return!0;let t=Kn(n);if(t!==Kn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Go(n).isEqual(Go(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=pn(i.timestampValue),c=pn(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return gn(i.bytesValue).isEqual(gn(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return we(i.geoPointValue.latitude)===we(s.geoPointValue.latitude)&&we(i.geoPointValue.longitude)===we(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return we(i.integerValue)===we(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=we(i.doubleValue),c=we(s.doubleValue);return o===c?Bo(o)===Bo(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return Di(n.arrayValue.values||[],e.arrayValue.values||[],Xt);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},c=s.mapValue.fields||{};if(BI(o)!==BI(c))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Xt(o[u],c[u])))return!1;return!0})(n,e);default:return J(52216,{left:n})}}function Ho(n,e){return(n.values||[]).find((t=>Xt(t,e)))!==void 0}function Qn(n,e){if(n===e)return 0;let t=Kn(n),r=Kn(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let c=we(s.integerValue||s.doubleValue),u=we(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return qI(n.timestampValue,e.timestampValue);case 4:return qI(Go(n),Go(e));case 5:return mf(n.stringValue,e.stringValue);case 6:return(function(s,o){let c=gn(s),u=gn(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let c=s.split("/"),u=o.split("/");for(let l=0;l<c.length&&l<u.length;l++){let d=ne(c[l],u[l]);if(d!==0)return d}return ne(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let c=ne(we(s.latitude),we(o.latitude));return c!==0?c:ne(we(s.longitude),we(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return WI(n.arrayValue,e.arrayValue);case 10:return(function(s,o){let c=s.fields||{},u=o.fields||{},l=c[Fi]?.arrayValue,d=u[Fi]?.arrayValue,p=ne(l?.values?.length||0,d?.values?.length||0);return p!==0?p:WI(l,d)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===zn.mapValue&&o===zn.mapValue)return 0;if(s===zn.mapValue)return 1;if(o===zn.mapValue)return-1;let c=s.fields||{},u=Object.keys(c),l=o.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let p=0;p<u.length&&p<d.length;++p){let m=mf(u[p],d[p]);if(m!==0)return m;let w=Qn(c[u[p]],l[d[p]]);if(w!==0)return w}return ne(u.length,d.length)})(n.mapValue,e.mapValue);default:throw J(23264,{he:t})}}function qI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);let t=pn(n),r=pn(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function WI(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Qn(t[i],r[i]);if(s)return s}return ne(t.length,r.length)}function Ui(n){return Rf(n)}function Rf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=pn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return gn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return $.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Rf(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Rf(t.fields[o])}`;return i+"}"})(n.mapValue):J(61005,{value:n})}function Jc(n){switch(Kn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=gl(n);return e?16+Jc(e):16;case 5:return 2*n.stringValue.length;case 6:return gn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+Jc(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return or(r.fields,((s,o)=>{i+=s.length+Jc(o)})),i})(n.mapValue);default:throw J(13486,{value:n})}}function ml(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Pf(n){return!!n&&"integerValue"in n}function Ko(n){return!!n&&"arrayValue"in n}function zI(n){return!!n&&"nullValue"in n}function jI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Yc(n){return!!n&&"mapValue"in n}function _l(n){return(n?.mapValue?.fields||{})[lg]?.stringValue===hg}function Do(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){let e={mapValue:{fields:{}}};return or(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Do(r))),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Do(n.arrayValue.values[t]);return e}return{...n}}function hT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===lT}var dT={mapValue:{fields:{[lg]:{stringValue:hg},[Fi]:{arrayValue:{}}}}};function sD(n){return"nullValue"in n?Qc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ml(Ur.empty(),$.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?_l(n)?dT:{mapValue:{}}:J(35942,{value:n})}function oD(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ml(Ur.empty(),$.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?dT:"mapValue"in n?_l(n)?{mapValue:{}}:zn:J(61959,{value:n})}function GI(n,e){let t=Qn(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function $I(n,e){let t=Qn(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Be=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Yc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Do(t)}setAll(e){let t=Re.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=Do(o):i.push(c.lastSegment())}));let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Yc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Yc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){or(t,((i,s)=>e[i]=s));for(let i of r)delete e[i]}clone(){return new n(Do(this.value))}};function fT(n){let e=[];return or(n.fields,((t,r)=>{let i=new Re([t]);if(Yc(r)){let s=fT(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)})),new yt(e)}var Me=class n{constructor(e,t,r,i,s,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,Z.min(),Z.min(),Z.min(),Be.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Z.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Z.min(),Z.min(),Be.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Z.min(),Z.min(),Be.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Be.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Be.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var mn=class{constructor(e,t){this.position=e,this.inclusive=t}};function HI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=$.comparator($.fromName(o.referenceValue),t.key):r=Qn(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function KI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xt(n.position[t],e.position[t]))return!1;return!0}var Br=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function aD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var du=class{},oe=class n extends du{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new kf(e,t,r):t==="array-contains"?new Vf(e,r):t==="in"?new fu(e,r):t==="not-in"?new Of(e,r):t==="array-contains-any"?new xf(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Df(e,r):new Nf(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Qn(t,this.value)):t!==null&&Kn(this.value)===Kn(t)&&this.matchesComparison(Qn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},fe=class n extends du{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return Bi(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function Bi(n){return n.op==="and"}function Sf(n){return n.op==="or"}function dg(n){return pT(n)&&Bi(n)}function pT(n){for(let e of n.filters)if(e instanceof fe)return!1;return!0}function Cf(n){if(n instanceof oe)return n.field.canonicalString()+n.op.toString()+Ui(n.value);if(dg(n))return n.filters.map((e=>Cf(e))).join(",");{let e=n.filters.map((t=>Cf(t))).join(",");return`${n.op}(${e})`}}function gT(n,e){return n instanceof oe?(function(r,i){return i instanceof oe&&r.op===i.op&&r.field.isEqual(i.field)&&Xt(r.value,i.value)})(n,e):n instanceof fe?(function(r,i){return i instanceof fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,c)=>s&&gT(o,i.filters[c])),!0):!1})(n,e):void J(19439)}function mT(n,e){let t=n.filters.concat(e);return fe.create(t,n.op)}function _T(n){return n instanceof oe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ui(t.value)}`})(n):n instanceof fe?(function(t){return t.op.toString()+" {"+t.getFilters().map(_T).join(" ,")+"}"})(n):"Filter"}var kf=class extends oe{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){let t=$.comparator(e.key,this.key);return this.matchesComparison(t)}},Df=class extends oe{constructor(e,t){super(e,"in",t),this.keys=yT("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}},Nf=class extends oe{constructor(e,t){super(e,"not-in",t),this.keys=yT("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}};function yT(n,e){return(e.arrayValue?.values||[]).map((t=>$.fromName(t.referenceValue)))}var Vf=class extends oe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ko(t)&&Ho(t.arrayValue,this.value)}},fu=class extends oe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ho(this.value.arrayValue,t)}},Of=class extends oe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ho(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ho(this.value.arrayValue,t)}},xf=class extends oe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ko(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Ho(this.value.arrayValue,r)))}};var Lf=class{constructor(e,t=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Te=null}};function Mf(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Lf(n,e,t,r,i,s,o)}function qr(n){let e=j(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Cf(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),da(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Ui(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Ui(r))).join(",")),e.Te=t}return e.Te}function pa(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!aD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!gT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!KI(n.startAt,e.startAt)&&KI(n.endAt,e.endAt)}function pu(n){return $.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function gu(n,e){return n.filters.filter((t=>t instanceof oe&&t.field.isEqual(e)))}function QI(n,e,t){let r=Qc,i=!0;for(let s of gu(n,e)){let o=Qc,c=!0;switch(s.op){case"<":case"<=":o=sD(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,c=!1;break;case"!=":case"not-in":o=Qc}GI({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];GI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function JI(n,e,t){let r=zn,i=!0;for(let s of gu(n,e)){let o=zn,c=!0;switch(s.op){case">=":case">":o=oD(s.value),c=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,c=!1;break;case"!=":case"not-in":o=zn}$I({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];$I({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var Ot=class{constructor(e,t=null,r=[],i=[],s=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function IT(n,e,t,r,i,s,o,c){return new Ot(n,e,t,r,i,s,o,c)}function ts(n){return new Ot(n)}function YI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ET(n){return $.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function TT(n){return n.collectionGroup!==null}function Ci(n){let e=j(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new pe(Re.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((l=>{l.isInequality()&&(c=c.add(l.field))}))})),c})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Br(s,r))})),t.has(Re.keyField().canonicalString())||e.Ie.push(new Br(Re.keyField(),r))}return e.Ie}function Ze(n){let e=j(n);return e.Ee||(e.Ee=vT(e,Ci(n))),e.Ee}function wT(n){let e=j(n);return e.Re||(e.Re=vT(e,n.explicitOrderBy)),e.Re}function vT(n,e){if(n.limitType==="F")return Mf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{let s=i.dir==="desc"?"asc":"desc";return new Br(i.field,s)}));let t=n.endAt?new mn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new mn(n.startAt.position,n.startAt.inclusive):null;return Mf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function cD(n,e){let t=n.filters.concat([e]);return new Ot(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function uD(n,e){let t=n.explicitOrderBy.concat([e]);return new Ot(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function mu(n,e,t){return new Ot(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function lD(n,e){return new Ot(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function hD(n,e){return new Ot(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function ga(n,e){return pa(Ze(n),Ze(e))&&n.limitType===e.limitType}function AT(n){return`${qr(Ze(n))}|lt:${n.limitType}`}function bi(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>_T(i))).join(", ")}]`),da(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Ui(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Ui(i))).join(",")),`Target(${r})`})(Ze(n))}; limitType=${n.limitType})`}function ma(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):$.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of Ci(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){let l=HI(o,c,u);return o.inclusive?l<=0:l<0})(r.startAt,Ci(r),i)||r.endAt&&!(function(o,c,u){let l=HI(o,c,u);return o.inclusive?l>=0:l>0})(r.endAt,Ci(r),i))})(n,e)}function bT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function RT(n){return(e,t)=>{let r=!1;for(let i of Ci(n)){let s=dD(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function dD(n,e,t){let r=n.field.isKeyField()?$.comparator(e.key,t.key):(function(s,o,c){let u=o.data.field(s),l=c.data.field(s);return u!==null&&l!==null?Qn(u,l):J(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:n.dir})}}var xt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){or(this.inner,((t,r)=>{for(let[i,s]of r)e(i,s)}))}isEmpty(){return sT(this.inner)}size(){return this.innerSize}};var fD=new Te($.comparator);function lt(){return fD}var PT=new Te($.comparator);function Ro(...n){let e=PT;for(let t of n)e=e.insert(t.key,t);return e}function ST(n){let e=PT;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Jt(){return No()}function CT(){return No()}function No(){return new xt((n=>n.toString()),((n,e)=>n.isEqual(e)))}var pD=new Te($.comparator),gD=new pe($.comparator);function re(...n){let e=gD;for(let t of n)e=e.add(t);return e}var mD=new pe(ne);function fg(){return mD}function pg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bo(e)?"-0":e}}function kT(n){return{integerValue:""+n}}function gg(n,e){return KE(e)?kT(e):pg(n,e)}var qi=class{constructor(){this._=void 0}};function _D(n,e,t){return n instanceof Jn?(function(i,s){let o={fields:{[aT]:{stringValue:oT},[uT]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&pl(s)&&(s=gl(s)),s&&(o.fields[cT]=s),{mapValue:o}})(t,e):n instanceof _n?NT(n,e):n instanceof yn?VT(n,e):(function(i,s){let o=DT(i,s),c=XI(o)+XI(i.Ae);return Pf(o)&&Pf(i.Ae)?kT(c):pg(i.serializer,c)})(n,e)}function yD(n,e,t){return n instanceof _n?NT(n,e):n instanceof yn?VT(n,e):t}function DT(n,e){return n instanceof Yn?(function(r){return Pf(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var Jn=class extends qi{},_n=class extends qi{constructor(e){super(),this.elements=e}};function NT(n,e){let t=OT(e);for(let r of n.elements)t.some((i=>Xt(i,r)))||t.push(r);return{arrayValue:{values:t}}}var yn=class extends qi{constructor(e){super(),this.elements=e}};function VT(n,e){let t=OT(e);for(let r of n.elements)t=t.filter((i=>!Xt(i,r)));return{arrayValue:{values:t}}}var Yn=class extends qi{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function XI(n){return we(n.integerValue||n.doubleValue)}function OT(n){return Ko(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Wr=class{constructor(e,t){this.field=e,this.transform=t}};function ID(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof _n&&i instanceof _n||r instanceof yn&&i instanceof yn?Di(r.elements,i.elements,Xt):r instanceof Yn&&i instanceof Yn?Xt(r.Ae,i.Ae):r instanceof Jn&&i instanceof Jn})(n.transform,e.transform)}var Ff=class{constructor(e,t){this.version=e,this.transformResults=t}},Je=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Xc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Wi=class{};function xT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new zr(n.key,Je.none()):new Xn(n.key,n.data,Je.none());{let t=n.data,r=Be.empty(),i=new pe(Re.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Lt(n.key,r,new yt(i.toArray()),Je.none())}}function ED(n,e,t){n instanceof Xn?(function(i,s,o){let c=i.value.clone(),u=eE(i.fieldTransforms,s,o.transformResults);c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Lt?(function(i,s,o){if(!Xc(i.precondition,s))return void s.convertToUnknownDocument(o.version);let c=eE(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(LT(i)),u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Vo(n,e,t,r){return n instanceof Xn?(function(s,o,c,u){if(!Xc(s.precondition,o))return c;let l=s.value.clone(),d=tE(s.fieldTransforms,u,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null})(n,e,t,r):n instanceof Lt?(function(s,o,c,u){if(!Xc(s.precondition,o))return c;let l=tE(s.fieldTransforms,u,o),d=o.data;return d.setAll(LT(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(s,o,c){return Xc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function TD(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=DT(r.transform,i||null);s!=null&&(t===null&&(t=Be.empty()),t.set(r.field,s))}return t||null}function ZI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Di(r,i,((s,o)=>ID(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Xn=class extends Wi{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Lt=class extends Wi{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function LT(n){let e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}})),e}function eE(n,e,t){let r=new Map;Y(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,yD(o,c,t[i]))}return r}function tE(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,_D(s,o,e))}return r}var zr=class extends Wi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Qo=class extends Wi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Jo=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&ED(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Vo(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Vo(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=CT();return this.mutations.forEach((i=>{let s=e.get(i.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(i.key)?null:c;let u=xT(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Z.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),re())}isEqual(e){return this.batchId===e.batchId&&Di(this.mutations,e.mutations,((t,r)=>ZI(t,r)))&&Di(this.baseMutations,e.baseMutations,((t,r)=>ZI(t,r)))}},Uf=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Y(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return pD})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Yo=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var _u=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var Bf=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Oe,le;function MT(n){switch(n){case N.OK:return J(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return J(15467,{code:n})}}function FT(n){if(n===void 0)return ke("GRPC error has no .code"),N.UNKNOWN;switch(n){case Oe.OK:return N.OK;case Oe.CANCELLED:return N.CANCELLED;case Oe.UNKNOWN:return N.UNKNOWN;case Oe.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case Oe.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case Oe.INTERNAL:return N.INTERNAL;case Oe.UNAVAILABLE:return N.UNAVAILABLE;case Oe.UNAUTHENTICATED:return N.UNAUTHENTICATED;case Oe.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case Oe.NOT_FOUND:return N.NOT_FOUND;case Oe.ALREADY_EXISTS:return N.ALREADY_EXISTS;case Oe.PERMISSION_DENIED:return N.PERMISSION_DENIED;case Oe.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case Oe.ABORTED:return N.ABORTED;case Oe.OUT_OF_RANGE:return N.OUT_OF_RANGE;case Oe.UNIMPLEMENTED:return N.UNIMPLEMENTED;case Oe.DATA_LOSS:return N.DATA_LOSS;default:return J(39323,{code:n})}}(le=Oe||(Oe={}))[le.OK=0]="OK",le[le.CANCELLED=1]="CANCELLED",le[le.UNKNOWN=2]="UNKNOWN",le[le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",le[le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",le[le.NOT_FOUND=5]="NOT_FOUND",le[le.ALREADY_EXISTS=6]="ALREADY_EXISTS",le[le.PERMISSION_DENIED=7]="PERMISSION_DENIED",le[le.UNAUTHENTICATED=16]="UNAUTHENTICATED",le[le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",le[le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",le[le.ABORTED=10]="ABORTED",le[le.OUT_OF_RANGE=11]="OUT_OF_RANGE",le[le.UNIMPLEMENTED=12]="UNIMPLEMENTED",le[le.INTERNAL=13]="INTERNAL",le[le.UNAVAILABLE=14]="UNAVAILABLE",le[le.DATA_LOSS=15]="DATA_LOSS";var qf=null;function wD(n){if(qf)throw new Error("a TestingHooksSpi instance is already set");qf=n}function UT(){return new TextEncoder}var vD=new jn.Integer([4294967295,4294967295],0);function nE(n){let e=UT().encode(n),t=new jn.Md5;return t.update(e),new Uint8Array(t.digest())}function rE(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new jn.Integer([t,r],0),new jn.Integer([i,s],0)]}var Wf=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Or(`Invalid padding: ${t}`);if(r<0)throw new Or(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Or(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Or(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=jn.Integer.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(jn.Integer.fromNumber(r)));return i.compare(vD)===1&&(i=new jn.Integer([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=nE(e),[r,i]=rE(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;let t=nE(e),[r,i]=rE(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);this.be(o)}}be(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Or=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Xo=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Zo.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Z.min(),i,new Te(ne),lt(),re())}},Zo=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,re(),re(),re())}};var ki=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}},yu=class{constructor(e,t){this.targetId=e,this.Ce=t}},Iu=class{constructor(e,t,r=Ce.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Eu=class{constructor(){this.ve=0,this.Fe=iE(),this.Me=Ce.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=re(),t=re(),r=re();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:J(38017,{changeType:s})}})),new Zo(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=iE()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Y(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},zf=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=lt(),this.He=Wc(),this.Je=Wc(),this.Ze=new Te(ne)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:J(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let s=i.target;if(pu(s))if(r===0){let o=new $(s.path);this.et(t,o,Me.newNoDocument(o,Z.min()))}else Y(r===1,20013,{expectedCount:r});else{let o=this._t(t);if(o!==r){let c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,l)}qf?.lt((function(d,p,m,w,k){let V={localCacheCount:d,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},x=p.unchangedNames;return x&&(V.bloomFilter={applied:k===0,hashCount:x?.hashCount??0,bitmapLength:x?.bits?.bitmap?.length??0,padding:x?.bits?.padding??0,mightContain:H=>w?.mightContain(H)??!1}),V})(o,e.Ce,this.Ge.ht(),c,u))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,c;try{o=gn(r).toUint8Array()}catch(u){if(u instanceof hu)return Vt("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Wf(o,i,s)}catch(u){return Vt(u instanceof Or?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach((s=>{let o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.et(t,s,null),i++)})),i}Tt(e){let t=new Map;this.ze.forEach(((s,o)=>{let c=this.ot(o);if(c){if(s.current&&pu(c.target)){let u=new $(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Me.newNoDocument(u,e))}s.Be&&(t.set(o,s.ke()),s.Ke())}}));let r=re();this.Je.forEach(((s,o)=>{let c=!0;o.forEachWhile((u=>{let l=this.ot(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));let i=new Xo(e,t,this.Ze,this.je,r);return this.je=lt(),this.He=Wc(),this.Je=Wc(),this.Ze=new Te(ne),i}Ye(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Eu,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new pe(ne),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new pe(ne),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Eu),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Wc(){return new Te($.comparator)}function iE(){return new Te($.comparator)}var AD={asc:"ASCENDING",desc:"DESCENDING"},bD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},RD={and:"AND",or:"OR"},jf=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Gf(n,e){return n.useProto3Json||da(e)?e:{value:e}}function zi(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function PD(n,e){return zi(n,e.toTimestamp())}function ve(n){return Y(!!n,49232),Z.fromTimestamp((function(t){let r=pn(t);return new Ee(r.seconds,r.nanos)})(n))}function mg(n,e){return $f(n,e).canonicalString()}function $f(n,e){let t=(function(i){return new ce(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function qT(n){let e=ce.fromString(n);return Y(JT(e),10190,{key:e.toString()}),e}function ea(n,e){return mg(n.databaseId,e.path)}function Dt(n,e){let t=qT(e);if(t.get(1)!==n.databaseId.projectId)throw new z(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new z(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $(jT(t))}function WT(n,e){return mg(n.databaseId,e)}function zT(n){let e=qT(n);return e.length===4?ce.emptyPath():jT(e)}function ta(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function jT(n){return Y(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function sE(n,e,t){return{name:ea(n,e),fields:t.value.mapValue.fields}}function oE(n,e,t){let r={};e.transaction?.length&&(r.transaction=e.transaction);let i=e.executionTime?ve(e.executionTime):void 0;return r.executionTime=i,t&&(r.key=t.name?Dt(n,t.name):void 0,r.fields=new Be({mapValue:{fields:t.fields}}),r.createTime=t.createTime?ve(t.createTime):void 0,r.updateTime=t.updateTime?ve(t.updateTime):void 0),r}function _g(n,e,t){let r=Dt(n,e.name),i=ve(e.updateTime),s=e.createTime?ve(e.createTime):Z.min(),o=new Be({mapValue:{fields:e.fields}}),c=Me.newFoundDocument(r,i,s,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function SD(n,e){return"found"in e?(function(r,i){Y(!!i.found,43571),i.found.name,i.found.updateTime;let s=Dt(r,i.found.name),o=ve(i.found.updateTime),c=i.found.createTime?ve(i.found.createTime):Z.min(),u=new Be({mapValue:{fields:i.found.fields}});return Me.newFoundDocument(s,o,c,u)})(n,e):"missing"in e?(function(r,i){Y(!!i.missing,3894),Y(!!i.readTime,22933);let s=Dt(r,i.missing),o=ve(i.readTime);return Me.newNoDocument(s,o)})(n,e):J(7234,{result:e})}function CD(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:J(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(l,d){return l.useProto3Json?(Y(d===void 0||typeof d=="string",58123),Ce.fromBase64String(d||"")):(Y(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ce.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(l){let d=l.code===void 0?N.UNKNOWN:FT(l.code);return new z(d,l.message||"")})(o);t=new Iu(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Dt(n,r.document.name),s=ve(r.document.updateTime),o=r.document.createTime?ve(r.document.createTime):Z.min(),c=new Be({mapValue:{fields:r.document.fields}}),u=Me.newFoundDocument(i,s,o,c),l=r.targetIds||[],d=r.removedTargetIds||[];t=new ki(l,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Dt(n,r.document),s=r.readTime?ve(r.readTime):Z.min(),o=Me.newNoDocument(i,s),c=r.removedTargetIds||[];t=new ki([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Dt(n,r.document),s=r.removedTargetIds||[];t=new ki([],s,i,null)}else{if(!("filter"in e))return J(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new Bf(i,s),c=r.targetId;t=new yu(c,o)}}return t}function na(n,e){let t;if(e instanceof Xn)t={update:sE(n,e.key,e.value)};else if(e instanceof zr)t={delete:ea(n,e.key)};else if(e instanceof Lt)t={update:sE(n,e.key,e.data),updateMask:xD(e.fieldMask)};else{if(!(e instanceof Qo))return J(16599,{dt:e.type});t={verify:ea(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,o){let c=o.transform;if(c instanceof Jn)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof _n)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof yn)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Yn)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw J(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:PD(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:J(27497)})(n,e.precondition)),t}function Hf(n,e){let t=e.currentDocument?(function(s){return s.updateTime!==void 0?Je.updateTime(ve(s.updateTime)):s.exists!==void 0?Je.exists(s.exists):Je.none()})(e.currentDocument):Je.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)Y(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new Jn;else if("appendMissingElements"in c){let d=c.appendMissingElements.values||[];u=new _n(d)}else if("removeAllFromArray"in c){let d=c.removeAllFromArray.values||[];u=new yn(d)}else"increment"in c?u=new Yn(o,c.increment):J(16584,{proto:c});let l=Re.fromServerFormat(c.fieldPath);return new Wr(l,u)})(n,i))):[];if(e.update){e.update.name;let i=Dt(n,e.update.name),s=new Be({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=(function(u){let l=u.fieldPaths||[];return new yt(l.map((d=>Re.fromServerFormat(d))))})(e.updateMask);return new Lt(i,s,o,t,r)}return new Xn(i,s,t,r)}if(e.delete){let i=Dt(n,e.delete);return new zr(i,t)}if(e.verify){let i=Dt(n,e.verify);return new Qo(i,t)}return J(1463,{proto:e})}function kD(n,e){return n&&n.length>0?(Y(e!==void 0,14353),n.map((t=>(function(i,s){let o=i.updateTime?ve(i.updateTime):ve(s);return o.isEqual(Z.min())&&(o=ve(s)),new Ff(o,i.transformResults||[])})(t,e)))):[]}function GT(n,e){return{documents:[WT(n,e.path)]}}function yl(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=WT(n,i);let s=(function(l){if(l.length!==0)return QT(fe.create(l,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(l){if(l.length!==0)return l.map((d=>(function(m){return{field:qn(m.field),direction:ND(m.dir)}})(d)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=Gf(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{ft:t,parent:i}}function $T(n,e,t,r){let{ft:i,parent:s}=yl(n,e),o={},c=[],u=0;return t.forEach((l=>{let d=r?l.alias:"aggregate_"+u++;o[d]=l.alias,l.aggregateType==="count"?c.push({alias:d,count:{}}):l.aggregateType==="avg"?c.push({alias:d,avg:{field:qn(l.fieldPath)}}):l.aggregateType==="sum"&&c.push({alias:d,sum:{field:qn(l.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:c,structuredQuery:i.structuredQuery},parent:i.parent},gt:o,parent:s}}function HT(n){let e=zT(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Y(r===1,65062);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=(function(p){let m=KT(p);return m instanceof fe&&dg(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((m=>(function(k){return new Br(Ri(k.field),(function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,da(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){let m=!!p.before,w=p.values||[];return new mn(w,m)})(t.startAt));let l=null;return t.endAt&&(l=(function(p){let m=!p.before,w=p.values||[];return new mn(w,m)})(t.endAt)),IT(e,i,o,s,c,"F",u,l)}function DD(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function KT(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Ri(t.unaryFilter.field);return oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ri(t.unaryFilter.field);return oe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ri(t.unaryFilter.field);return oe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Ri(t.unaryFilter.field);return oe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}})(n):n.fieldFilter!==void 0?(function(t){return oe.create(Ri(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return fe.create(t.compositeFilter.filters.map((r=>KT(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return J(1026)}})(t.compositeFilter.op))})(n):J(30097,{filter:n})}function ND(n){return AD[n]}function VD(n){return bD[n]}function OD(n){return RD[n]}function qn(n){return{fieldPath:n.canonicalString()}}function Ri(n){return Re.fromServerFormat(n.fieldPath)}function QT(n){return n instanceof oe?(function(t){if(t.op==="=="){if(jI(t.value))return{unaryFilter:{field:qn(t.field),op:"IS_NAN"}};if(zI(t.value))return{unaryFilter:{field:qn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jI(t.value))return{unaryFilter:{field:qn(t.field),op:"IS_NOT_NAN"}};if(zI(t.value))return{unaryFilter:{field:qn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qn(t.field),op:VD(t.op),value:t.value}}})(n):n instanceof fe?(function(t){let r=t.getFilters().map((i=>QT(i)));return r.length===1?r[0]:{compositeFilter:{op:OD(t.op),filters:r}}})(n):J(54877,{filter:n})}function xD(n){let e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function JT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function YT(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}function LD(n,e){let t={fields:{}};return e.forEach(((r,i)=>{if(typeof i!="string")throw new Error(`Cannot encode map with non-string key: ${i}`);t.fields[i]=r._toProto(n)})),{mapValue:t}}function MD(n){return{stringValue:n}}function FD(n){return{pipelineValue:n}}var ji=class n{constructor(e,t,r,i,s=Z.min(),o=Z.min(),c=Ce.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Tu=class{constructor(e){this.yt=e}};function UD(n,e){let t;if(e.document)t=_g(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=$.fromSegments(e.noDocument.path),i=Gr(e.noDocument.readTime);t=Me.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return J(56709);{let r=$.fromSegments(e.unknownDocument.path),i=Gr(e.unknownDocument.version);t=Me.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){let s=new Ee(i[0],i[1]);return Z.fromTimestamp(s)})(e.readTime)),t}function aE(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:wu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:ea(s,o.key),fields:o.data.value.mapValue.fields,updateTime:zi(s,o.version.toTimestamp()),createTime:zi(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:jr(e.version)};else{if(!e.isUnknownDocument())return J(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:jr(e.version)}}return r}function wu(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function jr(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Gr(n){let e=new Ee(n.seconds,n.nanoseconds);return Z.fromTimestamp(e)}function kr(n,e){let t=(e.baseMutations||[]).map((s=>Hf(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let c=e.mutations[s+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map((s=>Hf(n.yt,s))),i=Ee.fromMillis(e.localWriteTimeMs);return new Jo(e.batchId,i,t,r)}function Po(n){let e=Gr(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Gr(n.lastLimboFreeSnapshotVersion):Z.min(),r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){let o=s.documents.length;return Y(o===1,1966,{count:o}),Ze(ts(zT(s.documents[0])))})(n.query):(function(s){return Ze(HT(s))})(n.query),new ji(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ce.fromBase64String(n.resumeToken))}function XT(n,e){let t=jr(e.snapshotVersion),r=jr(e.lastLimboFreeSnapshotVersion),i;i=pu(e.target)?GT(n.yt,e.target):yl(n.yt,e.target).ft;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:qr(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Il(n){let e=HT({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?mu(e,e.limit,"L"):e}function nf(n,e){return new Yo(e.largestBatchId,Hf(n.yt,e.overlayMutation))}function cE(n,e){let t=e.path.lastSegment();return[n,Xe(e.path.popLast()),t]}function uE(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:jr(r.readTime),documentKey:Xe(r.documentKey.path),largestBatchId:r.largestBatchId}}var Kf=class{getBundleMetadata(e,t){return lE(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:Gr(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return lE(e).put((function(i){return{bundleId:i.id,createTime:jr(ve(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return hE(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:Il(s.bundledQuery),readTime:Gr(s.readTime)}})(r)}))}saveNamedQuery(e,t){return hE(e).put((function(i){return{name:i.name,readTime:jr(ve(i.readTime)),bundledQuery:i.bundledQuery}})(t))}};function lE(n){return qe(n,hl)}function hE(n){return qe(n,dl)}var vu=class n{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return To(e).get(cE(this.userId,t)).next((r=>r?nf(this.serializer,r):null))}getOverlays(e,t){let r=Jt();return P.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){let i=[];return r.forEach(((s,o)=>{let c=new Yo(t,o);i.push(this.bt(e,c))})),P.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach((o=>i.add(Xe(o.getCollectionPath()))));let s=[];return i.forEach((o=>{let c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(To(e).X(Af,c))})),P.waitFor(s)}getOverlaysForCollection(e,t,r){let i=Jt(),s=Xe(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return To(e).H(Af,o).next((c=>{for(let u of c){let l=nf(this.serializer,u);i.set(l.getKey(),l)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){let s=Jt(),o,c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return To(e).ee({index:eT,range:c},((u,l,d)=>{let p=nf(this.serializer,l);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()})).next((()=>s))}bt(e,t){return To(e).put((function(i,s,o){let[c,u,l]=cE(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:na(i.yt,o.mutation)}})(this.serializer,this.userId,t))}};function To(n){return qe(n,fl)}var Qf=class{St(e){return qe(e,ag)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{let r=t?.value;return r?Ce.fromUint8Array(r):Ce.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}};var hn=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(we(e.integerValue));else if("doubleValue"in e){let r=we(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Bo(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=pn(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(gn(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?hT(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):_l(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):J(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=Fi,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(we(s)),this.Ot(i,t),this.Ct(r[i],t)}qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),$.fromName(e).path.forEach((r=>{this.Ft(t,60),this.$t(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};hn.Wt=new hn;var Ei=255;function BD(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function dE(n){let e=64-(function(r){let i=0;for(let s=0;s<8;++s){let o=BD(255&r[s]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}var Jf=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{let i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Xt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{let i=t.codePointAt(0);this.Ht(240|i>>>18),this.Ht(128|63&i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i)}}this.Jt()}Yt(e){let t=this.en(e),r=dE(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){let t=this.en(e),r=dE(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Ei),this.sn(255)}_n(){this.an(Ei),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){let t=(function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){let t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ei?(this.sn(Ei),this.sn(0)):this.sn(t)}Ht(e){let t=255&e;t===0?(this.an(0),this.an(255)):t===Ei?(this.an(Ei),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Yf=class{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}},Xf=class{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}},Dr=class{constructor(){this.cn=new Jf,this.ascending=new Yf(this.cn),this.descending=new Xf(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}};var Nr=class n{constructor(e,t,r,i){this.hn=e,this.Pn=t,this.Tn=r,this.In=i}En(){let e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new n(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:Zc(this.Tn),directionalValue:Zc(this.In),orderedDocumentKey:Zc(t),documentKey:r.path.toArray()}}An(e,t,r){let i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}};function Fn(n,e){let t=n.hn-e.hn;return t!==0?t:(t=fE(n.Tn,e.Tn),t!==0?t:(t=fE(n.In,e.In),t!==0?t:$.comparator(n.Pn,e.Pn)))}function fE(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function Zc(n){return he.isSafariOrWebkit()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function pE(n){return typeof n!="string"?n:(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}var Au=class{constructor(e){this.Vn=new pe(((t,r)=>Re.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(Y(e.collectionGroup===this.collectionId,49279),this.fn)return!1;let t=_f(e);if(t!==void 0&&!this.pn(t))return!1;let r=Pr(e),i=new Set,s=0,o=0;for(;s<r.length&&this.pn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Vn.size>0){let c=this.Vn.getIterator().getNext();if(!i.has(c.field.canonicalString())){let u=r[s];if(!this.yn(c,u)||!this.wn(this.dn[o++],u))return!1}++s}for(;s<r.length;++s){let c=r[s];if(o>=this.dn.length||!this.wn(this.dn[o++],c))return!1}return!0}bn(){if(this.fn)return null;let e=new pe(Re.comparator),t=[];for(let r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new xr(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new xr(r.field,0))}for(let r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new xr(r.field,r.dir==="asc"?0:1)));return new Fr(Fr.UNKNOWN_ID,this.collectionId,t,Vi.empty())}pn(e){for(let t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function ZT(n){if(Y(n instanceof oe||n instanceof fe,20012),n instanceof oe){if(n instanceof fu){let t=n.value.arrayValue?.values?.map((r=>oe.create(n.field,"==",r)))||[];return fe.create(t,"or")}return n}let e=n.filters.map((t=>ZT(t)));return fe.create(e,n.op)}function qD(n){if(n.getFilters().length===0)return[];let e=tp(ZT(n));return Y(ew(e),7391),Zf(e)||ep(e)?[e]:e.getFilters()}function Zf(n){return n instanceof oe}function ep(n){return n instanceof fe&&dg(n)}function ew(n){return Zf(n)||ep(n)||(function(t){if(t instanceof fe&&Sf(t)){for(let r of t.getFilters())if(!Zf(r)&&!ep(r))return!1;return!0}return!1})(n)}function tp(n){if(Y(n instanceof oe||n instanceof fe,34018),n instanceof oe)return n;if(n.filters.length===1)return tp(n.filters[0]);let e=n.filters.map((r=>tp(r))),t=fe.create(e,n.op);return t=bu(t),ew(t)?t:(Y(t instanceof fe,64498),Y(Bi(t),40251),Y(t.filters.length>1,57927),t.filters.reduce(((r,i)=>yg(r,i))))}function yg(n,e){let t;return Y(n instanceof oe||n instanceof fe,38388),Y(e instanceof oe||e instanceof fe,25473),t=n instanceof oe?e instanceof oe?(function(i,s){return fe.create([i,s],"and")})(n,e):gE(n,e):e instanceof oe?gE(e,n):(function(i,s){if(Y(i.filters.length>0&&s.filters.length>0,48005),Bi(i)&&Bi(s))return mT(i,s.getFilters());let o=Sf(i)?i:s,c=Sf(i)?s:i,u=o.filters.map((l=>yg(l,c)));return fe.create(u,"or")})(n,e),bu(t)}function gE(n,e){if(Bi(e))return mT(e,n.getFilters());{let t=e.filters.map((r=>yg(n,r)));return fe.create(t,"or")}}function bu(n){if(Y(n instanceof oe||n instanceof fe,11850),n instanceof oe)return n;let e=n.getFilters();if(e.length===1)return bu(e[0]);if(pT(n))return n;let t=e.map((i=>bu(i))),r=[];return t.forEach((i=>{i instanceof oe?r.push(i):i instanceof fe&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:fe.create(r,n.op)}var np=class{constructor(){this.Sn=new ra}addToCollectionParentIndex(e,t){return this.Sn.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(wt.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(wt.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},ra=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new pe(ce.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new pe(ce.comparator)).toArray()}};var mE="IndexedDbIndexManager",zc=new Uint8Array(0),rp=class{constructor(e,t){this.databaseId=t,this.Dn=new ra,this.Cn=new xt((r=>qr(r)),((r,i)=>pa(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));let s={collectionId:r,parent:Xe(i)};return _E(e).put(s)}return P.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[WE(t),""],!1,!0);return _E(e).H(i).next((s=>{for(let o of s){if(o.collectionId!==t)break;r.push(Qt(o.parent))}return r}))}addFieldIndex(e,t){let r=wo(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=wi(e);return s.next((c=>{o.put(uE(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){let r=wo(e),i=wi(e),s=Ti(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){let t=wo(e),r=Ti(e),i=wi(e);return t.X().next((()=>r.X())).next((()=>i.X()))}createTargetIndexes(e,t){return P.forEach(this.vn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){let s=new Au(r).bn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){let r=Ti(e),i=!0,s=new Map;return P.forEach(this.vn(t),(o=>this.Fn(e,o).next((c=>{i&&(i=!!c),s.set(o,c)})))).next((()=>{if(i){let o=re(),c=[];return P.forEach(s,((u,l)=>{F(mE,`Using index ${(function(K){return`id=${K.indexId}|cg=${K.collectionGroup}|f=${K.fields.map((te=>`${te.fieldPath}:${te.kind}`)).join(",")}`})(u)} to execute ${qr(t)}`);let d=(function(K,te){let ae=_f(te);if(ae===void 0)return null;for(let ie of gu(K,ae.fieldPath))switch(ie.op){case"array-contains-any":return ie.value.arrayValue.values||[];case"array-contains":return[ie.value]}return null})(l,u),p=(function(K,te){let ae=new Map;for(let ie of Pr(te))for(let T of gu(K,ie.fieldPath))switch(T.op){case"==":case"in":ae.set(ie.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return ae.set(ie.fieldPath.canonicalString(),T.value),Array.from(ae.values())}return null})(l,u),m=(function(K,te){let ae=[],ie=!0;for(let T of Pr(te)){let y=T.kind===0?QI(K,T.fieldPath,K.startAt):JI(K,T.fieldPath,K.startAt);ae.push(y.value),ie&&(ie=y.inclusive)}return new mn(ae,ie)})(l,u),w=(function(K,te){let ae=[],ie=!0;for(let T of Pr(te)){let y=T.kind===0?JI(K,T.fieldPath,K.endAt):QI(K,T.fieldPath,K.endAt);ae.push(y.value),ie&&(ie=y.inclusive)}return new mn(ae,ie)})(l,u),k=this.Mn(u,l,m),V=this.Mn(u,l,w),x=this.xn(u,l,p),H=this.On(u.indexId,d,k,m.inclusive,V,w.inclusive,x);return P.forEach(H,(X=>r.Z(X,t.limit).next((K=>{K.forEach((te=>{let ae=$.fromSegments(te.documentKey);o.has(ae)||(o=o.add(ae),c.push(ae))}))}))))})).next((()=>c))}return P.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=qD(fe.create(e.filters,"and")).map((r=>Mf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,r,i,s,o,c){let u=(t!=null?t.length:1)*Math.max(r.length,s.length),l=u/(t!=null?t.length:1),d=[];for(let p=0;p<u;++p){let m=t?this.Nn(t[p/l]):zc,w=this.Bn(e,m,r[p%l],i),k=this.Ln(e,m,s[p%l],o),V=c.map((x=>this.Bn(e,m,x,!0)));d.push(...this.createRange(w,k,V))}return d}Bn(e,t,r,i){let s=new Nr(e,$.empty(),t,r);return i?s:s.En()}Ln(e,t,r,i){let s=new Nr(e,$.empty(),t,r);return i?s.En():s}Fn(e,t){let r=new Au(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let o=null;for(let c of s)r.gn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2,i=this.vn(t);return P.forEach(i,(s=>this.Fn(e,s).next((o=>{o?r!==0&&o.fields.length<(function(u){let l=new pe(Re.comparator),d=!1;for(let p of u.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:l=l.add(m.field));for(let p of u.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(d?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}kn(e,t){let r=new Dr;for(let i of Pr(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.ln(i.kind);hn.Wt.Dt(s,o)}return r.un()}Nn(e){let t=new Dr;return hn.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){let r=new Dr;return hn.Wt.Dt(ml(this.databaseId,t),r.ln((function(s){let o=Pr(s);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}xn(e,t,r){if(r===null)return[];let i=[];i.push(new Dr);let s=0;for(let o of Pr(e)){let c=r[s++];for(let u of i)if(this.qn(t,o.fieldPath)&&Ko(c))i=this.Un(i,o,c);else{let l=u.ln(o.kind);hn.Wt.Dt(c,l)}}return this.$n(i)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let c of i){let u=new Dr;u.seed(c.un()),hn.Wt.Dt(o,u.ln(t.kind)),s.push(u)}return s}qn(e,t){return!!e.filters.find((r=>r instanceof oe&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){let r=wo(e),i=wi(e);return(t?r.H(vf,IDBKeyRange.bound(t,t)):r.H()).next((s=>{let o=[];return P.forEach(s,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(d,p){let m=p?new Vi(p.sequenceNumber,new wt(Gr(p.readTime),new $(Qt(p.documentKey)),p.largestBatchId)):Vi.empty(),w=d.fields.map((([k,V])=>new xr(Re.fromServerFormat(k),V)));return new Fr(d.indexId,d.collectionGroup,w,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){let i=wo(e),s=wi(e);return this.Wn(e).next((o=>i.H(vf,IDBKeyRange.bound(t,t)).next((c=>P.forEach(c,(u=>s.put(uE(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){let r=new Map;return P.forEach(t,((i,s)=>{let o=r.get(i.collectionGroup);return(o?P.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),P.forEach(c,(u=>this.Qn(e,i,u).next((l=>{let d=this.Gn(s,u);return l.isEqual(d)?P.resolve():this.zn(e,s,u,l,d)})))))))}))}jn(e,t,r,i){return Ti(e).put(i.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,i){return Ti(e).delete(i.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){let i=Ti(e),s=new pe(Fn);return i.ee({index:ZE,range:IDBKeyRange.only([r.indexId,this.uid,Zc(this.Kn(r,t))])},((o,c)=>{s=s.add(new Nr(r.indexId,t,pE(c.arrayValue),pE(c.directionalValue)))})).next((()=>s))}Gn(e,t){let r=new pe(Fn),i=this.kn(t,e);if(i==null)return r;let s=_f(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Ko(o))for(let c of o.arrayValue.values||[])r=r.add(new Nr(t.indexId,e.key,this.Nn(c),i))}else r=r.add(new Nr(t.indexId,e.key,zc,i));return r}zn(e,t,r,i,s){F(mE,"Updating index entries for document '%s'",t.key);let o=[];return(function(u,l,d,p,m){let w=u.getIterator(),k=l.getIterator(),V=Ii(w),x=Ii(k);for(;V||x;){let H=!1,X=!1;if(V&&x){let K=d(V,x);K<0?X=!0:K>0&&(H=!0)}else V!=null?X=!0:H=!0;H?(p(x),x=Ii(k)):X?(m(V),V=Ii(w)):(V=Ii(w),x=Ii(k))}})(i,s,Fn,(c=>{o.push(this.jn(e,t,r,c))}),(c=>{o.push(this.Hn(e,t,r,c))})),P.waitFor(o)}Wn(e){let t=1;return wi(e).ee({index:XE,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>Fn(o,c))).filter(((o,c,u)=>!c||Fn(o,u[c-1])!==0));let i=[];i.push(e);for(let o of r){let c=Fn(o,e),u=Fn(o,t);if(c===0)i[0]=e.En();else if(c>0&&u<0)i.push(o),i.push(o.En());else if(u>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Jn(i[o],i[o+1]))return[];let c=i[o].An(this.uid,zc,$.empty()),u=i[o+1].An(this.uid,zc,$.empty());s.push(IDBKeyRange.bound(c,u))}return s}Jn(e,t){return Fn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(yE)}getMinOffset(e,t){return P.mapArray(this.vn(t),(r=>this.Fn(e,r).next((i=>i||J(44426))))).next(yE)}};function _E(n){return qe(n,zo)}function Ti(n){return qe(n,ko)}function wo(n){return qe(n,og)}function wi(n){return qe(n,Co)}function yE(n){Y(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;rg(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new wt(e.readTime,e.documentKey,t)}var IE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tw=41943040,ut=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function nw(n,e,t){let r=n.store(kt),i=n.store(Oi),s=[],o=IDBKeyRange.only(t.batchId),c=0,u=r.ee({range:o},((d,p,m)=>(c++,m.delete())));s.push(u.next((()=>{Y(c===1,47070,{batchId:t.batchId})})));let l=[];for(let d of t.mutations){let p=QE(e,d.key.path,t.batchId);s.push(i.delete(p)),l.push(d.key)}return P.waitFor(s).next((()=>l))}function Ru(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw J(14731);e=n.noDocument}return JSON.stringify(e).length}ut.DEFAULT_COLLECTION_PERCENTILE=10,ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ut.DEFAULT=new ut(tw,ut.DEFAULT_COLLECTION_PERCENTILE,ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ut.DISABLED=new ut(-1,0,0);var Pu=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Zn={}}static wt(e,t,r,i){Y(e.uid!=="",64387);let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Un(e).ee({index:Vr,range:r},((i,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){let s=Pi(e),o=Un(e);return o.add({}).next((c=>{Y(typeof c=="number",49019);let u=new Jo(c,t,r,i),l=(function(w,k,V){let x=V.baseMutations.map((X=>na(w.yt,X))),H=V.mutations.map((X=>na(w.yt,X)));return{userId:k,batchId:V.batchId,localWriteTimeMs:V.localWriteTime.toMillis(),baseMutations:x,mutations:H}})(this.serializer,this.userId,u),d=[],p=new pe(((m,w)=>ne(m.canonicalString(),w.canonicalString())));for(let m of i){let w=QE(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),d.push(o.put(l)),d.push(s.put(w,N0))}return p.forEach((m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Zn[c]=u.keys()})),P.waitFor(d).next((()=>u))}))}lookupMutationBatch(e,t){return Un(e).get(t).next((r=>r?(Y(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),kr(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?P.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){let i=r.keys();return this.Zn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Un(e).ee({index:Vr,range:i},((o,c,u)=>{c.userId===this.userId&&(Y(c.batchId>=r,47524,{Yn:r}),s=kr(this.serializer,c)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=Gn;return Un(e).ee({index:Vr,range:t,reverse:!0},((i,s,o)=>{r=s.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,Gn],[this.userId,Number.POSITIVE_INFINITY]);return Un(e).H(Vr,t).next((r=>r.map((i=>kr(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Hc(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Pi(e).ee({range:i},((o,c,u)=>{let[l,d,p]=o,m=Qt(d);if(l===this.userId&&t.path.isEqual(m))return Un(e).get(p).next((w=>{if(!w)throw J(61480,{er:o,batchId:p});Y(w.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:w.userId,batchId:p}),s.push(kr(this.serializer,w))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pe(ne),i=[];return t.forEach((s=>{let o=Hc(this.userId,s.path),c=IDBKeyRange.lowerBound(o),u=Pi(e).ee({range:c},((l,d,p)=>{let[m,w,k]=l,V=Qt(w);m===this.userId&&s.path.isEqual(V)?r=r.add(k):p.done()}));i.push(u)})),P.waitFor(i).next((()=>this.tr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Hc(this.userId,r),o=IDBKeyRange.lowerBound(s),c=new pe(ne);return Pi(e).ee({range:o},((u,l,d)=>{let[p,m,w]=u,k=Qt(m);p===this.userId&&r.isPrefixOf(k)?k.length===i&&(c=c.add(w)):d.done()})).next((()=>this.tr(e,c)))}tr(e,t){let r=[],i=[];return t.forEach((s=>{i.push(Un(e).get(s).next((o=>{if(o===null)throw J(35274,{batchId:s});Y(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(kr(this.serializer,o))})))})),P.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return nw(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),P.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return P.resolve();let r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Pi(e).ee({range:r},((s,o,c)=>{if(s[0]===this.userId){let u=Qt(s[1]);i.push(u)}else c.done()})).next((()=>{Y(i.length===0,56720,{rr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return rw(e,this.userId,t)}ir(e){return iw(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Gn,lastStreamToken:""}))}};function rw(n,e,t){let r=Hc(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Pi(n).ee({range:s,Y:!0},((c,u,l)=>{let[d,p,m]=c;d===e&&p===i&&(o=!0),l.done()})).next((()=>o))}function Un(n){return qe(n,kt)}function Pi(n){return qe(n,Oi)}function iw(n){return qe(n,qo)}var Gi=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var ip=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{let r=new Gi(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Z.fromTimestamp(new Ee(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.ur(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.cr(e,i))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>vi(e).delete(t.targetId))).next((()=>this.ur(e))).next((r=>(Y(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r))))}removeTargets(e,t,r){let i=0,s=[];return vi(e).ee(((o,c)=>{let u=Po(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))})).next((()=>P.waitFor(s))).next((()=>i))}forEachTarget(e,t){return vi(e).ee(((r,i)=>{let s=Po(i);t(s)}))}ur(e){return EE(e).get(uu).next((t=>(Y(t!==null,2888),t)))}cr(e,t){return EE(e).put(uu,t)}lr(e,t){return vi(e).put(XT(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){let r=qr(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return vi(e).ee({range:i,index:YE},((o,c,u)=>{let l=Po(c);pa(t,l.target)&&(s=l,u.done())})).next((()=>s))}addMatchingKeys(e,t,r){let i=[],s=Wn(e);return t.forEach((o=>{let c=Xe(o.path);i.push(s.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),P.waitFor(i)}removeMatchingKeys(e,t,r){let i=Wn(e);return P.forEach(t,(s=>{let o=Xe(s.path);return P.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){let r=Wn(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Wn(e),s=re();return i.ee({range:r,Y:!0},((o,c,u)=>{let l=Qt(o[1]),d=new $(l);s=s.add(d)})).next((()=>s))}containsKey(e,t){let r=Xe(t.path),i=IDBKeyRange.bound([r],[WE(r)],!1,!0),s=0;return Wn(e).ee({index:sg,Y:!0,range:i},(([o,c],u,l)=>{o!==0&&(s++,l.done())})).next((()=>s>0))}At(e,t){return vi(e).get(t).next((r=>r?Po(r):null))}};function vi(n){return qe(n,xi)}function EE(n){return qe(n,Mr)}function Wn(n){return qe(n,Li)}var TE="LruGarbageCollector",sw=1048576;function wE([n,e],[t,r]){let i=ne(n,t);return i===0?ne(e,r):i}var sp=class{constructor(e){this.Pr=e,this.buffer=new pe(wE),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();wE(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Su=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){F(TE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){sr(t)?F(TE,"Ignoring IndexedDB error during garbage collection: ",t):await ir(t)}await this.Ar(3e5)}))}},op=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return P.resolve(Ye.ce);let r=new sp(t);return this.Vr.forEachTarget(e,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.mr(e,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(IE)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),IE):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,s,o,c,u,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(l=Date.now(),Ai()<=Kt.LogLevel.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${s} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(l-u)+`ms
Total Duration: ${l-d}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p}))))}};function ow(n,e){return new op(n,e)}var ap=class{constructor(e,t){this.db=e,this.garbageCollector=ow(this,t)}dr(e){let t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((r,i)=>t(i)))}addReference(e,t,r){return jc(e,r)}removeReference(e,t,r){return jc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return jc(e,t)}wr(e,t){return(function(i,s){let o=!1;return iw(i).te((c=>rw(i,c,s).next((u=>(u&&(o=!0),P.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.yr(e,((o,c)=>{if(c<=t){let u=this.wr(e,o).next((l=>{if(!l)return s++,r.getEntry(e,o).next((()=>(r.removeEntry(o,Z.min()),Wn(e).delete((function(p){return[0,Xe(p.path)]})(o)))))}));i.push(u)}})).next((()=>P.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return jc(e,t)}yr(e,t){let r=Wn(e),i,s=Ye.ce;return r.ee({index:sg},(([o,c],{path:u,sequenceNumber:l})=>{o===0?(s!==Ye.ce&&t(new $(Qt(i)),s),s=l,i=u):s=Ye.ce})).next((()=>{s!==Ye.ce&&t(new $(Qt(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function jc(n,e){return Wn(n).put((function(r,i){return{targetId:0,path:Xe(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}var Cu=class{constructor(){this.changes=new xt((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Me.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var cp=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Rr(e).put(r)}removeEntry(e,t,r){return Rr(e).delete((function(s,o){let c=s.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],wu(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=Me.newInvalidDocument(t);return Rr(e).ee({index:Kc,range:IDBKeyRange.only(vo(t))},((i,s)=>{r=this.Sr(t,s)})).next((()=>r))}Dr(e,t){let r={size:0,document:Me.newInvalidDocument(t)};return Rr(e).ee({index:Kc,range:IDBKeyRange.only(vo(t))},((i,s)=>{r={document:this.Sr(t,s),size:Ru(s)}})).next((()=>r))}getEntries(e,t){let r=lt();return this.Cr(e,t,((i,s)=>{let o=this.Sr(i,s);r=r.insert(i,o)})).next((()=>r))}vr(e,t){let r=lt(),i=new Te($.comparator);return this.Cr(e,t,((s,o)=>{let c=this.Sr(s,o);r=r.insert(s,c),i=i.insert(s,Ru(o))})).next((()=>({documents:r,Fr:i})))}Cr(e,t,r){if(t.isEmpty())return P.resolve();let i=new pe(bE);t.forEach((u=>i=i.add(u)));let s=IDBKeyRange.bound(vo(i.first()),vo(i.last())),o=i.getIterator(),c=o.getNext();return Rr(e).ee({index:Kc,range:s},((u,l,d)=>{let p=$.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;c&&bE(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,l),c=o.hasNext()?o.getNext():null),c?d.j(vo(c)):d.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,c=[o.popLast().toArray(),o.lastSegment(),wu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Rr(e).H(IDBKeyRange.bound(c,u,!0)).next((l=>{s?.incrementDocumentReadCount(l.length);let d=lt();for(let p of l){let m=this.Sr($.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(ma(t,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d}))}getAllFromCollectionGroup(e,t,r,i){let s=lt(),o=AE(t,r),c=AE(t,wt.max());return Rr(e).ee({index:JE,range:IDBKeyRange.bound(o,c,!0)},((u,l,d)=>{let p=this.Sr($.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(p.key,p),s.size===i&&d.done()})).next((()=>s))}newChangeBuffer(e){return new up(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return vE(e).get(wf).next((t=>(Y(!!t,20021),t)))}br(e,t){return vE(e).put(wf,t)}Sr(e,t){if(t){let r=UD(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Z.min())))return r}return Me.newInvalidDocument(e)}};function aw(n){return new cp(n)}var up=class extends Cu{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new xt((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){let t=[],r=0,i=new pe(((s,o)=>ne(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{let c=this.Or.get(s);if(t.push(this.Mr.removeEntry(e,s,c.readTime)),o.isValidDocument()){let u=aE(this.Mr.serializer,o);i=i.add(s.path.popLast());let l=Ru(u);r+=l-c.size,t.push(this.Mr.addEntry(e,s,u))}else if(r-=c.size,this.trackRemovals){let u=aE(this.Mr.serializer,o.convertToNoDocument(Z.min()));t.push(this.Mr.addEntry(e,s,u))}})),i.forEach((s=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Mr.updateMetadata(e,r)),P.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:r,Fr:i})=>(i.forEach(((s,o)=>{this.Or.set(s,{size:o,readTime:r.get(s).readTime})})),r)))}};function vE(n){return qe(n,Wo)}function Rr(n){return qe(n,cu)}function vo(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function AE(n,e){let t=e.documentKey.path.toArray();return[n,wu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function bE(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ne(t[s],r[s]),i)return i;return i=ne(t.length,r.length),i||(i=ne(t[t.length-2],r[r.length-2]),i||ne(t[t.length-1],r[r.length-1]))}var lp=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var ku=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Vo(r.mutation,i,yt.empty(),Ee.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,re()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=re()){let i=Jt();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let o=Ro();return s.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){let r=Jt();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,re())))}populateOverlays(e,t,r){let i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let s=lt(),o=No(),c=(function(){return No()})();return t.forEach(((u,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Lt)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Vo(d.mutation,l,d.mutation.getFieldMask(),Ee.now())):o.set(l.key,yt.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((l,d)=>o.set(l,d))),t.forEach(((l,d)=>c.set(l,new lp(d,o.get(l)??null)))),c)))}recalculateAndSaveOverlays(e,t){let r=No(),i=new Te(((o,c)=>o-c)),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(let c of o)c.keys().forEach((u=>{let l=t.get(u);if(l===null)return;let d=r.get(u)||yt.empty();d=c.applyToLocalView(l,d),r.set(u,d);let p=(i.get(c.batchId)||re()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{let o=[],c=i.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),l=u.key,d=u.value,p=CT();d.forEach((m=>{if(!s.has(m)){let w=xT(t.get(m),r.get(m));w!==null&&p.set(m,w),s=s.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return P.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return ET(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):TT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(Jt()),c=Ni,u=s;return o.next((l=>P.forEach(l,((d,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),s.get(d)?P.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{u=u.insert(d,m)}))))).next((()=>this.populateOverlays(e,l,s))).next((()=>this.computeViews(e,u,l,re()))).next((d=>({batchId:c,changes:ST(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next((r=>{let i=Ro();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Ro();return this.indexManager.getCollectionParents(e,s).next((c=>P.forEach(c,(u=>{let l=(function(p,m){return new Ot(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next((d=>{d.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((o=>{s.forEach(((u,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,Me.newInvalidDocument(d)))}));let c=Ro();return o.forEach(((u,l)=>{let d=s.get(u);d!==void 0&&Vo(d.mutation,l,yt.empty(),Ee.now()),ma(t,l)&&(c=c.insert(u,l))})),c}))}};var hp=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return P.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:ve(i.createTime)}})(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:Il(i.bundledQuery),readTime:ve(i.readTime)}})(t)),P.resolve()}};var dp=class{constructor(){this.overlays=new Te($.comparator),this.Lr=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Jt();return P.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.bt(e,t,s)})),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Lr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.Lr.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=Jt(),s=t.length+1,o=new $(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let u=c.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Te(((l,d)=>l-d)),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=Jt(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let c=Jt(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((l,d)=>c.set(l,d))),!(c.size()>=i)););return P.resolve(c)}bt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Yo(t,r));let s=this.Lr.get(t);s===void 0&&(s=re(),this.Lr.set(t,s)),this.Lr.set(t,s.add(r.key))}};var fp=class{constructor(){this.sessionToken=Ce.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var ia=class{constructor(){this.kr=new pe(xe.Kr),this.qr=new pe(xe.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let r=new xe(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new xe(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){let t=new $(new ce([])),r=new xe(t,e),i=new xe(t,e+1),s=[];return this.qr.forEachInRange([r,i],(o=>{this.Wr(o),s.push(o.key)})),s}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new $(new ce([])),r=new xe(t,e),i=new xe(t,e+1),s=re();return this.qr.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(e){let t=new xe(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},xe=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return $.comparator(e.key,t.key)||ne(e.Hr,t.Hr)}static Ur(e,t){return ne(e.Hr,t.Hr)||$.comparator(e.key,t.key)}};var pp=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new pe(xe.Kr)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Jo(s,t,r,i);this.mutationQueue.push(o);for(let c of i)this.Jr=this.Jr.add(new xe(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return P.resolve(o)}lookupMutationBatch(e,t){return P.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?Gn:this.Yn-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new xe(t,0),i=new xe(t,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],(o=>{let c=this.Zr(o.Hr);s.push(c)})),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pe(ne);return t.forEach((i=>{let s=new xe(i,0),o=new xe(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],(c=>{r=r.add(c.Hr)}))})),P.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;$.isDocumentKey(s)||(s=s.child(""));let o=new xe(new $(s),0),c=new pe(ne);return this.Jr.forEachWhile((u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(c=c.add(u.Hr)),!0)}),o),P.resolve(this.Yr(c))}Yr(e){let t=[];return e.forEach((r=>{let i=this.Zr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Y(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return P.forEach(t.mutations,(i=>{let s=new xe(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){let r=new xe(t,0),i=this.Jr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var gp=class{constructor(e){this.ti=e,this.docs=(function(){return new Te($.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Me.newInvalidDocument(t))}getEntries(e,t){let r=lt();return t.forEach((i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Me.newInvalidDocument(i))})),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=lt(),o=t.path,c=new $(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:l,value:{document:d}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||rg(GE(d),r)<=0||(i.has(d.key)||ma(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){J(9500)}ni(e,t){return P.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new mp(this)}getSize(e){return P.resolve(this.size)}},mp=class extends Cu{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)})),P.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var _p=class{constructor(e){this.persistence=e,this.ri=new xt((t=>qr(t)),pa),this.lastRemoteSnapshotVersion=Z.min(),this.highestTargetId=0,this.ii=0,this.si=new ia,this.targetCount=0,this.oi=Gi._r()}forEachTarget(e,t){return this.ri.forEach(((r,i)=>t(i))),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),P.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new Gi(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.lr(t),P.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ri.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),P.waitFor(s).next((()=>i))}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.ri.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((o=>{s.push(i.markPotentiallyOrphaned(e,o))})),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.si.jr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.si.containsKey(t))}};var sa=class{constructor(e,t){this._i={},this.overlays={},this.ai=new Ye(0),this.ui=!1,this.ui=!0,this.ci=new fp,this.referenceDelegate=e(this),this.li=new _p(this),this.indexManager=new np,this.remoteDocumentCache=(function(i){return new gp(i)})((r=>this.referenceDelegate.hi(r))),this.serializer=new Tu(t),this.Pi=new hp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new dp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new pp(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);let i=new yp(this.ai.next());return this.referenceDelegate.Ti(),r(i).next((s=>this.referenceDelegate.Ii(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ei(e,t){return P.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}},yp=class extends su{constructor(e){super(),this.currentSequenceNumber=e}},Du=class n{constructor(e){this.persistence=e,this.Ri=new ia,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw J(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),P.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((i=>this.di.add(i.toString())));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.di.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.di,(r=>{let i=$.fromPath(r);return this.mi(e,i).next((s=>{s||t.removeEntry(i,Z.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return P.or([()=>P.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Nu=class n{constructor(e,t){this.persistence=e,this.fi=new xt((r=>Xe(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=ow(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return P.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return P.forEach(this.fi,((r,i)=>this.wr(e,r,i).next((s=>s?P.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(e,(o=>this.wr(e,o,t).next((c=>{c||(r++,s.removeEntry(o,Z.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),P.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),P.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),P.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),P.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Jc(e.data.value)),t}wr(e,t,r){return P.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.fi.get(t);return P.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Ip=class{constructor(e){this.serializer=e}k(e,t,r,i){let s=new ou("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(fa)})(e),(function(u){u.createObjectStore(qo,{keyPath:D0}),u.createObjectStore(kt,{keyPath:FI,autoIncrement:!0}).createIndex(Vr,UI,{unique:!0}),u.createObjectStore(Oi)})(e),RE(e),(function(u){u.createObjectStore(Sr)})(e));let o=P.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(Li),u.deleteObjectStore(xi),u.deleteObjectStore(Mr)})(e),RE(e)),o=o.next((()=>(function(u){let l=u.store(Mr),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Z.min().toTimestamp(),targetCount:0};return l.put(uu,d)})(s)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,l){return l.store(kt).H().next((p=>{u.deleteObjectStore(kt),u.createObjectStore(kt,{keyPath:FI,autoIncrement:!0}).createIndex(Vr,UI,{unique:!0});let m=l.store(kt),w=p.map((k=>m.put(k)));return P.waitFor(w)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(Mi,{keyPath:B0})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.gi(s)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Wo)})(e),this.pi(s))))),r<7&&i>=7&&(o=o.next((()=>this.yi(s)))),r<8&&i>=8&&(o=o.next((()=>this.wi(e,s)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.bi(s)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(hl,{keyPath:q0})})(e),(function(u){u.createObjectStore(dl,{keyPath:W0})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){let l=u.createObjectStore(fl,{keyPath:Q0});l.createIndex(Af,J0,{unique:!1}),l.createIndex(eT,Y0,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){let l=u.createObjectStore(cu,{keyPath:V0});l.createIndex(Kc,O0),l.createIndex(JE,x0)})(e))).next((()=>this.Si(e,s))).next((()=>e.deleteObjectStore(Sr)))),r<14&&i>=14&&(o=o.next((()=>this.Di(e,s)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(og,{keyPath:z0,autoIncrement:!0}).createIndex(vf,j0,{unique:!1}),u.createObjectStore(Co,{keyPath:G0}).createIndex(XE,$0,{unique:!1}),u.createObjectStore(ko,{keyPath:H0}).createIndex(ZE,K0,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(Co).clear()})).next((()=>{t.objectStore(ko).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(ag,{keyPath:X0})})(e)}))),r<18&&i>=18&&he.isSafariOrWebkit()&&(o=o.next((()=>{t.objectStore(Co).clear()})).next((()=>{t.objectStore(ko).clear()}))),o}pi(e){let t=0;return e.store(Sr).ee(((r,i)=>{t+=Ru(i)})).next((()=>{let r={byteSize:t};return e.store(Wo).put(wf,r)}))}gi(e){let t=e.store(qo),r=e.store(kt);return t.H().next((i=>P.forEach(i,(s=>{let o=IDBKeyRange.bound([s.userId,Gn],[s.userId,s.lastAcknowledgedBatchId]);return r.H(Vr,o).next((c=>P.forEach(c,(u=>{Y(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});let l=kr(this.serializer,u);return nw(e,s.userId,l).next((()=>{}))}))))}))))}yi(e){let t=e.store(Li),r=e.store(Sr);return e.store(Mr).get(uu).next((i=>{let s=[];return r.ee(((o,c)=>{let u=new ce(o),l=(function(p){return[0,Xe(p)]})(u);s.push(t.get(l).next((d=>d?P.resolve():(p=>t.put({targetId:0,path:Xe(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>P.waitFor(s)))}))}wi(e,t){e.createObjectStore(zo,{keyPath:U0});let r=t.store(zo),i=new ra,s=o=>{if(i.add(o)){let c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:Xe(u)})}};return t.store(Sr).ee({Y:!0},((o,c)=>{let u=new ce(o);return s(u.popLast())})).next((()=>t.store(Oi).ee({Y:!0},(([o,c,u],l)=>{let d=Qt(c);return s(d.popLast())}))))}bi(e){let t=e.store(xi);return t.ee(((r,i)=>{let s=Po(i),o=XT(this.serializer,s);return t.put(o)}))}Si(e,t){let r=t.store(Sr),i=[];return r.ee(((s,o)=>{let c=t.store(cu),u=(function(p){return p.document?new $(ce.fromString(p.document.name).popFirst(5)):p.noDocument?$.fromSegments(p.noDocument.path):p.unknownDocument?$.fromSegments(p.unknownDocument.path):J(36783)})(o).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(l))})).next((()=>P.waitFor(i)))}Di(e,t){let r=t.store(kt),i=aw(this.serializer),s=new sa(Du.Vi,this.serializer.yt);return r.H().next((o=>{let c=new Map;return o.forEach((u=>{let l=c.get(u.userId)??re();kr(this.serializer,u).keys().forEach((d=>l=l.add(d))),c.set(u.userId,l)})),P.forEach(c,((u,l)=>{let d=new Le(l),p=vu.wt(this.serializer,d),m=s.getIndexManager(d),w=Pu.wt(d,this.serializer,m,s.referenceDelegate);return new ku(i,w,p,m).recalculateAndSaveOverlaysForDocumentKeys(new jo(t,Ye.ce),u).next()}))}))}};function RE(n){n.createObjectStore(Li,{keyPath:M0}).createIndex(sg,F0,{unique:!0}),n.createObjectStore(xi,{keyPath:"targetId"}).createIndex(YE,L0,{unique:!0}),n.createObjectStore(Mr)}var Bn="IndexedDbPersistence",rf=18e5,sf=5e3,of="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",cw="main",Ep=class n{constructor(e,t,r,i,s,o,c,u,l,d,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=s,this.window=o,this.document=c,this.Fi=l,this.Mi=d,this.xi=p,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=m=>Promise.resolve(),!n.v())throw new z(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ap(this,i),this.Ki=t+cw,this.serializer=new Tu(u),this.qi=new Hn(this.Ki,this.xi,new Ip(this.serializer)),this.ci=new Qf,this.li=new ip(this.referenceDelegate,this.serializer),this.remoteDocumentCache=aw(this.serializer),this.Pi=new Kf,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,d===!1&&ke(Bn,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new z(N.FAILED_PRECONDITION,of);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new Ye(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Gc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(sr(e))return F(Bn,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return F(Bn,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Ao(e).get(yi).next((t=>P.resolve(this.Xi(t))))}Yi(e){return Gc(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,rf)){this.Li=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{let r=qe(t,Mi);return r.H().next((i=>{let s=this.ns(i,rf),o=i.filter((c=>s.indexOf(c)===-1));return P.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ui)for(let t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?P.resolve(!0):Ao(e).get(yi).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,sf)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new z(N.FAILED_PRECONDITION,of);return!1}}return!(!this.networkEnabled||!this.inForeground)||Gc(e).H().next((r=>this.ns(r,sf).find((i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(s||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&F(Bn,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[fa,Mi],(e=>{let t=new jo(e,Ye.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Gc(e).H().next((t=>this.ns(t,rf).map((r=>r.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return Pu.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new rp(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vu.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){F(Bn,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?tD:u===17?iT:u===16?eD:u===15?cg:u===14?rT:u===13?nT:u===12?Z0:u===11?tT:void J(60245)})(this.xi),o;return this.qi.runTransaction(e,i,s,(c=>(o=new jo(c,this.ai?this.ai.next():Ye.ce),t==="readwrite-primary"?this.ji(o).next((u=>!!u||this.Hi(o))).next((u=>{if(!u)throw ke(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new z(N.FAILED_PRECONDITION,$E);return r(o)})).next((u=>this.Zi(o).next((()=>u)))):this.Ps(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Ps(e){return Ao(e).get(yi).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,sf)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new z(N.FAILED_PRECONDITION,of)}))}Zi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ao(e).put(yi,t)}static v(){return Hn.v()}Ji(e){let t=Ao(e);return t.get(yi).next((r=>this.Xi(r)?(F(Bn,"Releasing primary lease."),t.delete(yi)):P.resolve()))}ts(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ke(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();let e=/(?:Version|Mobile)\/1[456]/;he.isSafari()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{let t=this.Ui?.getItem(this.rs(e))!==null;return F(Bn,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return ke(Bn,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){ke("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Ao(n){return qe(n,fa)}function Gc(n){return qe(n,Mi)}function Ig(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Tp=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=re(),i=re();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var wp=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Vu=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return he.isSafari()?8:HE(he.getUA())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.gs(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ps(e,t,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;let o=new wp;return this.ys(e,t,o).next((c=>{if(s.result=c,this.As)return this.ws(e,t,o,c.size)}))})).next((()=>s.result))}ws(e,t,r,i){return r.documentReadCount<this.Vs?(Ai()<=Kt.LogLevel.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",bi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),P.resolve()):(Ai()<=Kt.LogLevel.DEBUG&&F("QueryEngine","Query:",bi(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(Ai()<=Kt.LogLevel.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",bi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ze(t))):P.resolve())}gs(e,t){if(YI(t))return P.resolve(null);let r=Ze(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=mu(t,null,"F"),r=Ze(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{let o=re(...s);return this.fs.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{let l=this.bs(t,c);return this.Ss(t,l,o,u.readTime)?this.gs(e,mu(t,null,"F")):this.Ds(e,l,t,u)}))))})))))}ps(e,t,r,i){return YI(t)||i.isEqual(Z.min())?P.resolve(null):this.fs.getDocuments(e,r).next((s=>{let o=this.bs(t,s);return this.Ss(t,o,r,i)?P.resolve(null):(Ai()<=Kt.LogLevel.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bi(t)),this.Ds(e,o,t,jE(i,Ni)).next((c=>c)))}))}bs(e,t){let r=new pe(RT(e));return t.forEach(((i,s)=>{ma(e,s)&&(r=r.add(s))})),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(e,t,r){return Ai()<=Kt.LogLevel.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",bi(t)),this.fs.getDocumentsMatchingQuery(e,t,wt.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}};var Eg="LocalStore",WD=3e8,vp=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new Te(ne),this.Fs=new xt((s=>qr(s)),pa),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ku(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}};function uw(n,e,t,r){return new vp(n,e,t,r)}async function lw(n,e){let t=j(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{let o=[],c=[],u=re();for(let l of i){o.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}for(let l of s){c.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next((l=>({Ns:l,removedBatchIds:o,addedBatchIds:c})))}))}))}function zD(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{let i=e.batch.keys(),s=t.xs.newChangeBuffer({trackRemovals:!0});return(function(c,u,l,d){let p=l.batch,m=p.keys(),w=P.resolve();return m.forEach((k=>{w=w.next((()=>d.getEntry(u,k))).next((V=>{let x=l.docVersions.get(k);Y(x!==null,48541),V.version.compareTo(x)<0&&(p.applyToRemoteDocument(V,l),V.isValidDocument()&&(V.setReadTime(l.commitVersion),d.addEntry(V)))}))})),w.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=re();for(let l=0;l<c.mutationResults.length;++l)c.mutationResults[l].transformResults.length>0&&(u=u.add(c.batch.mutations[l].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function hw(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function jD(n,e){let t=j(n),r=e.snapshotVersion,i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{let o=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;let c=[];e.targetChanges.forEach(((d,p)=>{let m=i.get(p);if(!m)return;c.push(t.li.removeMatchingKeys(s,d.removedDocuments,p).next((()=>t.li.addMatchingKeys(s,d.addedDocuments,p))));let w=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(Ce.EMPTY_BYTE_STRING,Z.min()).withLastLimboFreeSnapshotVersion(Z.min()):d.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(d.resumeToken,r)),i=i.insert(p,w),(function(V,x,H){return V.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=WD?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0})(m,w,d)&&c.push(t.li.updateTargetData(s,w))}));let u=lt(),l=re();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))})),c.push(dw(s,o,e.documentUpdates).next((d=>{u=d.Bs,l=d.Ls}))),!r.isEqual(Z.min())){let d=t.li.getLastRemoteSnapshotVersion(s).next((p=>t.li.setTargetsMetadata(s,s.currentSequenceNumber,r)));c.push(d)}return P.waitFor(c).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,u,l))).next((()=>u))})).then((s=>(t.vs=i,s)))}function dw(n,e,t){let r=re(),i=re();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let o=lt();return t.forEach(((c,u)=>{let l=s.get(c);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Z.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):F(Eg,"Ignoring outdated watch update for ",c,". Current version:",l.version," Watch version:",u.version)})),{Bs:o,Ls:i}}))}function GD(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Gn),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function $i(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.li.getTargetData(r,e).next((s=>s?(i=s,P.resolve(i)):t.li.allocateTargetId(r).next((o=>(i=new ji(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next((()=>i)))))))})).then((r=>{let i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function Hi(n,e,t){let r=j(n),i=r.vs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!sr(o))throw o;F(Eg,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function Ou(n,e,t){let r=j(n),i=Z.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,l,d){let p=j(u),m=p.Fs.get(d);return m!==void 0?P.resolve(p.vs.get(m)):p.li.getTargetData(l,d)})(r,o,Ze(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,c.targetId).next((u=>{s=u}))})).next((()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:Z.min(),t?s:re()))).next((c=>(gw(r,bT(e),c),{documents:c,ks:s})))))}function fw(n,e){let t=j(n),r=j(t.li),i=t.vs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(s=>r.At(s,e).next((o=>o?o.target:null))))}function pw(n,e){let t=j(n),r=t.Ms.get(e)||Z.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.xs.getAllFromCollectionGroup(i,e,jE(r,Ni),Number.MAX_SAFE_INTEGER))).then((i=>(gw(t,e,i),i)))}function gw(n,e,t){let r=n.Ms.get(e)||Z.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Ms.set(e,r)}async function $D(n,e,t,r){let i=j(n),s=re(),o=lt();for(let l of t){let d=e.Ks(l.metadata.name);l.document&&(s=s.add(d));let p=e.qs(l);p.setReadTime(e.Us(l.metadata.readTime)),o=o.insert(d,p)}let c=i.xs.newChangeBuffer({trackRemovals:!0}),u=await $i(i,(function(d){return Ze(ts(ce.fromString(`__bundle__/docs/${d}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(l=>dw(l,c,o).next((d=>(c.apply(l),d))).next((d=>i.li.removeMatchingKeysForTargetId(l,u.targetId).next((()=>i.li.addMatchingKeys(l,s,u.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(l,d.Bs,d.Ls))).next((()=>d.Bs))))))}async function HD(n,e,t=re()){let r=await $i(n,Ze(Il(e.bundledQuery))),i=j(n);return i.persistence.runTransaction("Save named query","readwrite",(s=>{let o=ve(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Pi.saveNamedQuery(s,e);let c=r.withResumeToken(Ce.EMPTY_BYTE_STRING,o);return i.vs=i.vs.insert(c.targetId,c),i.li.updateTargetData(s,c).next((()=>i.li.removeMatchingKeysForTargetId(s,r.targetId))).next((()=>i.li.addMatchingKeys(s,t,r.targetId))).next((()=>i.Pi.saveNamedQuery(s,e)))}))}var mw="firestore_clients";function PE(n,e){return`${mw}_${n}_${e}`}var _w="firestore_mutations";function SE(n,e,t){let r=`${_w}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}var yw="firestore_targets";function af(n,e){return`${yw}_${n}_${e}`}var Ht="SharedClientState",xu=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static $s(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new z(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(ke(Ht,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Oo=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new z(r.error.code,r.error.message))),s?new n(e,r.state,i):(ke(Ht,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Lu=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=fg();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=KE(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(ke(Ht,`Failed to parse client data for instance '${e}': ${t}`),null)}},Ap=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ke(Ht,`Failed to parse online state: ${e}`),null)}},oa=class{constructor(){this.activeTargetIds=fg()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},xo=class{constructor(e,t,r,i,s){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new Te(ne),this.started=!1,this.Zs=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Xs=PE(this.persistenceKey,this.zs),this.Ys=(function(u){return`firestore_sequence_number_${u}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new oa),this.eo=new RegExp(`^${mw}_${o}_([^_]*)$`),this.no=new RegExp(`^${_w}_${o}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${yw}_${o}_(\\d+)$`),this.io=(function(u){return`firestore_online_state_${u}`})(this.persistenceKey),this.so=(function(u){return`firestore_bundle_loaded_v2_${u}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){let e=await this.syncEngine.hs();for(let r of e){if(r===this.zs)continue;let i=this.getItem(PE(this.persistenceKey,r));if(i){let s=Lu.$s(r,i);s&&(this.Js=this.Js.insert(s.clientId,s))}}this.oo();let t=this.storage.getItem(this.io);if(t){let r=this._o(t);r&&this.ao(r)}for(let r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(af(this.persistenceKey,e));if(i){let s=Oo.$s(e,i);s&&(r=s.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(af(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.lo(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return F(Ht,"READ",e,t),t}setItem(e,t){F(Ht,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){F(Ht,"REMOVE",e),this.storage.removeItem(e)}Hs(e){let t=e;if(t.storageArea===this.storage){if(F(Ht,"EVENT",t.key,t.newValue),t.key===this.Xs)return void ke("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){let r=this.Eo(t.key);return this.Ro(r,null)}{let r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){let r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){let r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){let r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){let r=(function(s){let o=Ye.ce;if(s!=null)try{let c=JSON.parse(s);Y(typeof c=="number",30636,{yo:s}),o=c}catch(c){ke(Ht,"Failed to read sequence number from WebStorage",c)}return o})(t.newValue);r!==Ye.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){let r=this.wo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.bo(i))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){let i=new xu(this.currentUser,e,t,r),s=SE(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Ws())}lo(e){let t=SE(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){let t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){let i=af(this.persistenceKey,e),s=new Oo(e,t,r);this.setItem(i,s.Ws())}Io(e){let t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){let t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){let r=this.Eo(e);return Lu.$s(r,t)}Vo(e,t){let r=this.no.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return xu.$s(new Le(s),i,t)}fo(e,t){let r=this.ro.exec(e),i=Number(r[1]);return Oo.$s(i,t)}_o(e){return Ap.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);F(Ht,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){let r=t?this.Js.insert(e,t):this.Js.remove(e),i=this.uo(this.Js),s=this.uo(r),o=[],c=[];return s.forEach((u=>{i.has(u)||o.push(u)})),i.forEach((u=>{s.has(u)||c.push(u)})),this.syncEngine.Co(o,c).then((()=>{this.Js=r}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=fg();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}},Mu=class{constructor(){this.vo=new oa,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new oa,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var bp=class{Mo(e){}shutdown(){}};var CE="ConnectivityMonitor",Fu=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){F(CE,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){F(CE,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var $c=null;function Rp(){return $c===null?$c=(function(){return 268435456+Math.round(2147483648*Math.random())})():$c++,"0x"+$c.toString(16)}var cf="RestConnection",KD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},Pp=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===$o?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let o=Rp(),c=this.Qo(e,t.toUriEncodedString());F(cf,`Sending RPC '${e}' ${o}:`,c,r);let u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(u,i,s);let{host:l}=new URL(c),d=he.isCloudWorkstation(l);return this.zo(e,c,u,r,d).then((p=>(F(cf,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Vt(cf,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Zi})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}Qo(e,t){let r=KD[e],i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}};var Sp=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Qe="WebChannelConnection",bo=(n,e,t)=>{n.listen(e,(r=>{try{t(r)}catch(i){setTimeout((()=>{throw i}),0)}}))},Uu=class n extends Pp{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=ct.getStatEventTarget();bo(e,ct.Event.STAT_EVENT,(t=>{t.stat===ct.Stat.PROXY?F(Qe,"STAT_EVENT: detected buffering proxy"):t.stat===ct.Stat.NOPROXY&&F(Qe,"STAT_EVENT: detected no buffering proxy")})),n.c_=!0}}zo(e,t,r,i,s){let o=Rp();return new Promise(((c,u)=>{let l=new ct.XhrIo;l.setWithCredentials(!0),l.listenOnce(ct.EventType.COMPLETE,(()=>{try{switch(l.getLastErrorCode()){case ct.ErrorCode.NO_ERROR:let p=l.getResponseJson();F(Qe,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case ct.ErrorCode.TIMEOUT:F(Qe,`RPC '${e}' ${o} timed out`),u(new z(N.DEADLINE_EXCEEDED,"Request time out"));break;case ct.ErrorCode.HTTP_ERROR:let m=l.getStatus();if(F(Qe,`RPC '${e}' ${o} failed with status:`,m,"response text:",l.getResponseText()),m>0){let w=l.getResponseJson();Array.isArray(w)&&(w=w[0]);let k=w?.error;if(k&&k.status&&k.message){let V=(function(H){let X=H.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(X)>=0?X:N.UNKNOWN})(k.status);u(new z(V,k.message))}else u(new z(N.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new z(N.UNAVAILABLE,"Connection failed."));break;default:J(9055,{l_:e,streamId:o,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{F(Qe,`RPC '${e}' ${o} completed.`)}}));let d=JSON.stringify(i);F(Qe,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",d,r,15)}))}T_(e,t,r){let i=Rp(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Go(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let l=s.join("");F(Qe,`Creating RPC '${e}' stream ${i}: ${l}`,c);let d=o.createWebChannel(l,c);this.I_(d);let p=!1,m=!1,w=new Sp({Ho:k=>{m?F(Qe,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(p||(F(Qe,`Opening RPC '${e}' stream ${i} transport.`),d.open(),p=!0),F(Qe,`RPC '${e}' stream ${i} sending:`,k),d.send(k))},Jo:()=>d.close()});return bo(d,ct.WebChannel.EventType.OPEN,(()=>{m||(F(Qe,`RPC '${e}' stream ${i} transport opened.`),w.i_())})),bo(d,ct.WebChannel.EventType.CLOSE,(()=>{m||(m=!0,F(Qe,`RPC '${e}' stream ${i} transport closed`),w.o_(),this.E_(d))})),bo(d,ct.WebChannel.EventType.ERROR,(k=>{m||(m=!0,Vt(Qe,`RPC '${e}' stream ${i} transport errored. Name:`,k.name,"Message:",k.message),w.o_(new z(N.UNAVAILABLE,"The operation could not be completed")))})),bo(d,ct.WebChannel.EventType.MESSAGE,(k=>{if(!m){let V=k.data[0];Y(!!V,16349);let x=V,H=x?.error||x[0]?.error;if(H){F(Qe,`RPC '${e}' stream ${i} received error:`,H);let X=H.status,K=(function(ie){let T=Oe[ie];if(T!==void 0)return FT(T)})(X),te=H.message;X==="NOT_FOUND"&&te.includes("database")&&te.includes("does not exist")&&te.includes(this.databaseId.database)&&Vt(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),K===void 0&&(K=N.INTERNAL,te="Unknown error status: "+X+" with message "+H.message),m=!0,w.o_(new z(K,te)),d.close()}else F(Qe,`RPC '${e}' stream ${i} received:`,V),w.__(V)}})),n.u_(),setTimeout((()=>{w.s_()}),0),w}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return ct.createWebChannelTransport()}};function Iw(n){return new Uu(n)}function Ew(){return typeof window<"u"?window:null}function eu(){return typeof document<"u"?document:null}function Qr(n){return new jf(n,!0)}Uu.c_=!1;var aa=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var kE="PersistentStream",Bu=class{constructor(e,t,r,i,s,o,c,u){this.Ci=e,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new aa(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(ke(t.toString()),ke("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{let i=new z(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){let r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return F(kE,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(F(kE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}},Cp=class extends Bu{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=CD(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Z.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Z.min():o.readTime?ve(o.readTime):Z.min()})(e);return this.listener.J_(t,r)}Z_(e){let t={};t.database=ta(this.serializer),t.addTarget=(function(s,o){let c,u=o.target;if(c=pu(u)?{documents:GT(s,u)}:{query:yl(s,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=BT(s,o.resumeToken);let l=Gf(s,o.expectedCount);l!==null&&(c.expectedCount=l)}else if(o.snapshotVersion.compareTo(Z.min())>0){c.readTime=zi(s,o.snapshotVersion.toTimestamp());let l=Gf(s,o.expectedCount);l!==null&&(c.expectedCount=l)}return c})(this.serializer,e);let r=DD(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){let t={};t.database=ta(this.serializer),t.removeTarget=e,this.K_(t)}},kp=class extends Bu{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Y(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Y(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=kD(e.writeResults,e.commitTime),r=ve(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=ta(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map((r=>na(this.serializer,r)))};this.K_(t)}};var Dp=class{},Np=class extends Dp{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new z(N.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Wo(e,$f(t,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new z(N.UNKNOWN,s.toString())}))}jo(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.jo(e,$f(t,r),i,o,c,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new z(N.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}};function Tw(n,e,t,r){return new Np(n,e,t,r)}var Vp=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ke(t),this.aa=!1):F("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var $r="RemoteStore",Op=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo((o=>{r.enqueueAndForget((async()=>{ar(this)&&(F($r,"Restarting streams for network reachability change."),await(async function(u){let l=j(u);l.Ea.add(4),await ns(l),l.Va.set("Unknown"),l.Ea.delete(4),await _a(l)})(this))}))})),this.Va=new Vp(r,i)}};async function _a(n){if(ar(n))for(let e of n.Ra)await e(!0)}async function ns(n){for(let e of n.Ra)await e(!1)}function El(n,e){let t=j(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),vg(t)?wg(t):is(t).O_()&&Tg(t,e))}function Ki(n,e){let t=j(n),r=is(t);t.Ia.delete(e),r.O_()&&ww(t,e),t.Ia.size===0&&(r.O_()?r.L_():ar(t)&&t.Va.set("Unknown"))}function Tg(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Z.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}is(n).Z_(e)}function ww(n,e){n.da.$e(e),is(n).X_(e)}function wg(n){n.da=new zf({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),is(n).start(),n.Va.ua()}function vg(n){return ar(n)&&!is(n).x_()&&n.Ia.size>0}function ar(n){return j(n).Ea.size===0}function vw(n){n.da=void 0}async function QD(n){n.Va.set("Online")}async function JD(n){n.Ia.forEach(((e,t)=>{Tg(n,e)}))}async function YD(n,e){vw(n),vg(n)?(n.Va.ha(e),wg(n)):n.Va.set("Unknown")}async function XD(n,e,t){if(n.Va.set("Online"),e instanceof Iu&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let c of s.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.da.removeTarget(c))})(n,e)}catch(r){F($r,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await qu(n,r)}else if(e instanceof ki?n.da.Xe(e):e instanceof yu?n.da.st(e):n.da.tt(e),!t.isEqual(Z.min()))try{let r=await hw(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let c=s.da.Tt(o);return c.targetChanges.forEach(((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let d=s.Ia.get(l);d&&s.Ia.set(l,d.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,l)=>{let d=s.Ia.get(u);if(!d)return;s.Ia.set(u,d.withResumeToken(Ce.EMPTY_BYTE_STRING,d.snapshotVersion)),ww(s,u);let p=new ji(d.target,u,l,d.sequenceNumber);Tg(s,p)})),s.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){F($r,"Failed to raise snapshot:",r),await qu(n,r)}}async function qu(n,e,t){if(!sr(e))throw e;n.Ea.add(1),await ns(n),n.Va.set("Offline"),t||(t=()=>hw(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{F($r,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await _a(n)}))}function Aw(n,e){return e().catch((t=>qu(n,t,e)))}async function rs(n){let e=j(n),t=Zn(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Gn;for(;ZD(e);)try{let i=await GD(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,eN(e,i)}catch(i){await qu(e,i)}bw(e)&&Rw(e)}function ZD(n){return ar(n)&&n.Ta.length<10}function eN(n,e){n.Ta.push(e);let t=Zn(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function bw(n){return ar(n)&&!Zn(n).x_()&&n.Ta.length>0}function Rw(n){Zn(n).start()}async function tN(n){Zn(n).ra()}async function nN(n){let e=Zn(n);for(let t of n.Ta)e.ea(t.mutations)}async function rN(n,e,t){let r=n.Ta.shift(),i=Uf.from(r,e,t);await Aw(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await rs(n)}async function iN(n,e){e&&Zn(n).Y_&&await(async function(r,i){if((function(o){return MT(o)&&o!==N.ABORTED})(i.code)){let s=r.Ta.shift();Zn(r).B_(),await Aw(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await rs(r)}})(n,e),bw(n)&&Rw(n)}async function DE(n,e){let t=j(n);t.asyncQueue.verifyOperationInProgress(),F($r,"RemoteStore received new credentials");let r=ar(t);t.Ea.add(3),await ns(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await _a(t)}async function xp(n,e){let t=j(n);e?(t.Ea.delete(2),await _a(t)):e||(t.Ea.add(2),await ns(t),t.Va.set("Unknown"))}function is(n){return n.ma||(n.ma=(function(t,r,i){let s=j(t);return s.sa(),new Cp(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:QD.bind(null,n),Yo:JD.bind(null,n),t_:YD.bind(null,n),J_:XD.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),vg(n)?wg(n):n.Va.set("Unknown")):(await n.ma.stop(),vw(n))}))),n.ma}function Zn(n){return n.fa||(n.fa=(function(t,r,i){let s=j(t);return s.sa(),new kp(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:tN.bind(null,n),t_:iN.bind(null,n),ta:nN.bind(null,n),na:rN.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await rs(n)):(await n.fa.stop(),n.Ta.length>0&&(F($r,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}var Lp=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new De,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,c=new n(e,t,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new z(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ss(n,e){if(ke("AsyncQueue",`${e}: ${n}`),sr(n))return new z(N.UNAVAILABLE,`${e}: ${n}`);throw n}var ca=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||$.comparator(t.key,r.key):(t,r)=>$.comparator(t.key,r.key),this.keyedMap=Ro(),this.sortedSet=new Te(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Wu=class{constructor(){this.ga=new Te($.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):J(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}},Hr=class n{constructor(e,t,r,i,s,o,c,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new n(e,t,ca.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ga(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Mp=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}},Fp=class{constructor(){this.queries=NE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=j(t),s=i.queries;i.queries=NE(),s.forEach(((o,c)=>{for(let u of c.ba)u.onError(r)}))})(this,new z(N.ABORTED,"Firestore shutting down"))}};function NE(){return new xt((n=>AT(n)),ga)}async function Ag(n,e){let t=j(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.Da()&&(r=2):(s=new Mp,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let c=ss(o,`Initialization of query '${bi(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.ba.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&Rg(t)}async function bg(n,e){let t=j(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.ba.indexOf(e);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=e.Da()?0:1:!s.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function sN(n,e){let t=j(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let c of o.ba)c.Fa(i)&&(r=!0);o.wa=i}}r&&Rg(t)}function oN(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let s of i.ba)s.onError(t);r.queries.delete(e)}function Rg(n){n.Ca.forEach((e=>{e.next()}))}var Up,VE;(VE=Up||(Up={})).Ma="default",VE.Cache="cache";var ua=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Hr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Hr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Up.Cache}};var zu=class{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}};var ju=class{constructor(e){this.serializer=e}Ks(e){return Dt(this.serializer,e)}qs(e){return e.metadata.exists?_g(this.serializer,e.document,!1):Me.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return ve(e)}},Gu=class{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=Pw(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;let r=ce.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){let t=new Map,r=new ju(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ks(i.metadata.name);for(let o of i.metadata.queries){let c=(t.get(o)||re()).add(s);t.set(o,c)}}return t}async ja(e){let t=await $D(e,new ju(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(let i of this.Wa)await HD(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}};function Pw(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var $u=class{constructor(e){this.key=e}},Hu=class{constructor(e){this.key=e}},Ku=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=re(),this.mutatedKeys=re(),this.eu=RT(e),this.tu=new ca(this.eu)}get nu(){return this.Za}ru(e,t){let r=t?t.iu:new Wu,i=t?t.tu:this.tu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((d,p)=>{let m=i.get(d),w=ma(this.query,p)?p:null,k=!!m&&this.mutatedKeys.has(m.key),V=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),x=!1;m&&w?m.data.isEqual(w.data)?k!==V&&(r.track({type:3,doc:w}),x=!0):this.su(m,w)||(r.track({type:2,doc:w}),x=!0,(u&&this.eu(w,u)>0||l&&this.eu(w,l)<0)&&(c=!0)):!m&&w?(r.track({type:0,doc:w}),x=!0):m&&!w&&(r.track({type:1,doc:m}),x=!0,(u||l)&&(c=!0)),x&&(w?(o=o.add(w),s=V?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Ss:c,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let o=e.iu.ya();o.sort(((d,p)=>(function(w,k){let V=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{Vt:x})}};return V(w)-V(k)})(d.type,p.type)||this.eu(d.doc,p.doc))),this.ou(r),i=i??!1;let c=t&&!i?this._u():[],u=this.Ya.size===0&&this.current&&!i?1:0,l=u!==this.Xa;return this.Xa=u,o.length!==0||l?{snapshot:new Hr(this.query,e.tu,s,o,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Wu,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=re(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));let t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new Hu(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new $u(r))})),t}cu(e){this.Za=e.ks,this.Ya=re();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Hr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},cr="SyncEngine",Bp=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},qp=class{constructor(e){this.key=e,this.hu=!1}},Wp=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new xt((c=>AT(c)),ga),this.Iu=new Map,this.Eu=new Set,this.Ru=new Te($.comparator),this.Au=new Map,this.Vu=new ia,this.du={},this.mu=new Map,this.fu=Gi.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function aN(n,e,t=!0){let r=Tl(n),i,s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Sw(r,e,t,!0),i}async function cN(n,e){let t=Tl(n);await Sw(t,e,!0,!1)}async function Sw(n,e,t,r){let i=await $i(n.localStore,Ze(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=await Pg(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&El(n.remoteStore,i),c}async function Pg(n,e,t,r,i){n.pu=(p,m,w)=>(async function(V,x,H,X){let K=x.view.ru(H);K.Ss&&(K=await Ou(V.localStore,x.query,!1).then((({documents:T})=>x.view.ru(T,K))));let te=X&&X.targetChanges.get(x.targetId),ae=X&&X.targetMismatches.get(x.targetId)!=null,ie=x.view.applyChanges(K,V.isPrimaryClient,te,ae);return zp(V,x.targetId,ie.au),ie.snapshot})(n,p,m,w);let s=await Ou(n.localStore,e,!0),o=new Ku(e,s.ks),c=o.ru(s.documents),u=Zo.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(c,n.isPrimaryClient,u);zp(n,t,l.au);let d=new Bp(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),l.snapshot}async function uN(n,e,t){let r=j(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!ga(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Hi(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Ki(r.remoteStore,i.targetId),Qi(r,i.targetId)})).catch(ir)):(Qi(r,i.targetId),await Hi(r.localStore,i.targetId,!0))}async function lN(n,e){let t=j(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ki(t.remoteStore,r.targetId))}async function hN(n,e,t){let r=Dg(n);try{let i=await(function(o,c){let u=j(o),l=Ee.now(),d=c.reduce(((w,k)=>w.add(k.key)),re()),p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let k=lt(),V=re();return u.xs.getEntries(w,d).next((x=>{k=x,k.forEach(((H,X)=>{X.isValidDocument()||(V=V.add(H))}))})).next((()=>u.localDocuments.getOverlayedDocuments(w,k))).next((x=>{p=x;let H=[];for(let X of c){let K=TD(X,p.get(X.key).overlayedDocument);K!=null&&H.push(new Lt(X.key,K,fT(K.value.mapValue),Je.exists(!0)))}return u.mutationQueue.addMutationBatch(w,l,H,c)})).next((x=>{m=x;let H=x.applyToLocalDocumentSet(p,V);return u.documentOverlayCache.saveOverlays(w,x.batchId,H)}))})).then((()=>({batchId:m.batchId,changes:ST(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let l=o.du[o.currentUser.toKey()];l||(l=new Te(ne)),l=l.insert(c,u),o.du[o.currentUser.toKey()]=l})(r,i.batchId,t),await In(r,i.changes),await rs(r.remoteStore)}catch(i){let s=ss(i,"Failed to persist write");t.reject(s)}}async function Cw(n,e){let t=j(n);try{let r=await jD(t.localStore,e);e.targetChanges.forEach(((i,s)=>{let o=t.Au.get(s);o&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Y(o.hu,14607):i.removedDocuments.size>0&&(Y(o.hu,42227),o.hu=!1))})),await In(t,r,e)}catch(r){await ir(r)}}function OE(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach(((s,o)=>{let c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){let u=j(o);u.onlineState=c;let l=!1;u.queries.forEach(((d,p)=>{for(let m of p.ba)m.va(c)&&(l=!0)})),l&&Rg(u)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function dN(n,e,t){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),s=i&&i.key;if(s){let o=new Te($.comparator);o=o.insert(s,Me.newNoDocument(s,Z.min()));let c=re().add(s),u=new Xo(Z.min(),new Map,new Te(ne),o,c);await Cw(r,u),r.Ru=r.Ru.remove(s),r.Au.delete(e),kg(r)}else await Hi(r.localStore,e,!1).then((()=>Qi(r,e,t))).catch(ir)}async function fN(n,e){let t=j(n),r=e.batch.batchId;try{let i=await zD(t.localStore,e);Cg(t,r,null),Sg(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await In(t,i)}catch(i){await ir(i)}}async function pN(n,e,t){let r=j(n);try{let i=await(function(o,c){let u=j(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(l=>{let d;return u.mutationQueue.lookupMutationBatch(l,c).next((p=>(Y(p!==null,37113),d=p.keys(),u.mutationQueue.removeMutationBatch(l,p)))).next((()=>u.mutationQueue.performConsistencyCheck(l))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d))).next((()=>u.localDocuments.getDocuments(l,d)))}))})(r.localStore,e);Cg(r,e,t),Sg(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await In(r,i)}catch(i){await ir(i)}}async function gN(n,e){let t=j(n);ar(t.remoteStore)||F(cr,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=await(function(o){let c=j(o);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(u=>c.mutationQueue.getHighestUnacknowledgedBatchId(u)))})(t.localStore);if(r===Gn)return void e.resolve();let i=t.mu.get(r)||[];i.push(e),t.mu.set(r,i)}catch(r){let i=ss(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Sg(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Cg(n,e,t){let r=j(n),i=r.du[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function Qi(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((r=>{n.Vu.containsKey(r)||kw(n,r)}))}function kw(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(Ki(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),kg(n))}function zp(n,e,t){for(let r of t)r instanceof $u?(n.Vu.addReference(r.key,e),mN(n,r)):r instanceof Hu?(F(cr,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||kw(n,r.key)):J(19791,{wu:r})}function mN(n,e){let t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(F(cr,"New document in limbo: "+t),n.Eu.add(r),kg(n))}function kg(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new $(ce.fromString(e)),r=n.fu.next();n.Au.set(r,new qp(t)),n.Ru=n.Ru.insert(t,r),El(n.remoteStore,new ji(Ze(ts(t.path)),r,"TargetPurposeLimboResolution",Ye.ce))}}async function In(n,e,t){let r=j(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((l=>{if((l||t)&&r.isPrimaryClient){let d=l?!l.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(l){i.push(l);let d=Tp.Es(u.targetId,l);s.push(d)}})))})),await Promise.all(o),r.Pu.J_(i),await(async function(u,l){let d=j(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>P.forEach(l,(m=>P.forEach(m.Ts,(w=>d.persistence.referenceDelegate.addReference(p,m.targetId,w))).next((()=>P.forEach(m.Is,(w=>d.persistence.referenceDelegate.removeReference(p,m.targetId,w)))))))))}catch(p){if(!sr(p))throw p;F(Eg,"Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let w=d.vs.get(m),k=w.snapshotVersion,V=w.withLastLimboFreeSnapshotVersion(k);d.vs=d.vs.insert(m,V)}}})(r.localStore,s))}async function _N(n,e){let t=j(n);if(!t.currentUser.isEqual(e)){F(cr,"User change. New user:",e.toKey());let r=await lw(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((c=>{c.forEach((u=>{u.reject(new z(N.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await In(t,r.Ns)}}function yN(n,e){let t=j(n),r=t.Au.get(e);if(r&&r.hu)return re().add(r.key);{let i=re(),s=t.Iu.get(e);if(!s)return i;for(let o of s){let c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}async function IN(n,e){let t=j(n),r=await Ou(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&zp(t,e.targetId,i.au),i}async function EN(n,e){let t=j(n);return pw(t.localStore,e).then((r=>In(t,r)))}async function TN(n,e,t,r){let i=j(n),s=await(function(c,u){let l=j(c),d=j(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",(p=>d.Xn(p,u).next((m=>m?l.localDocuments.getDocuments(p,m):P.resolve(null)))))})(i.localStore,e);s!==null?(t==="pending"?await rs(i.remoteStore):t==="acknowledged"||t==="rejected"?(Cg(i,e,r||null),Sg(i,e),(function(c,u){j(j(c).mutationQueue).nr(u)})(i.localStore,e)):J(6720,"Unknown batchState",{bu:t}),await In(i,s)):F(cr,"Cannot apply mutation batch with id: "+e)}async function wN(n,e){let t=j(n);if(Tl(t),Dg(t),e===!0&&t.gu!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=await xE(t,r.toArray());t.gu=!0,await xp(t.remoteStore,!0);for(let s of i)El(t.remoteStore,s)}else if(e===!1&&t.gu!==!1){let r=[],i=Promise.resolve();t.Iu.forEach(((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then((()=>(Qi(t,o),Hi(t.localStore,o,!0)))),Ki(t.remoteStore,o)})),await i,await xE(t,r),(function(o){let c=j(o);c.Au.forEach(((u,l)=>{Ki(c.remoteStore,l)})),c.Vu.zr(),c.Au=new Map,c.Ru=new Te($.comparator)})(t),t.gu=!1,await xp(t.remoteStore,!1)}}async function xE(n,e,t){let r=j(n),i=[],s=[];for(let o of e){let c,u=r.Iu.get(o);if(u&&u.length!==0){c=await $i(r.localStore,Ze(u[0]));for(let l of u){let d=r.Tu.get(l),p=await IN(r,d);p.snapshot&&s.push(p.snapshot)}}else{let l=await fw(r.localStore,o);c=await $i(r.localStore,l),await Pg(r,Dw(l),o,!1,c.resumeToken)}i.push(c)}return r.Pu.J_(s),i}function Dw(n){return IT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function vN(n){return(function(t){return j(j(t).persistence).hs()})(j(n).localStore)}async function AN(n,e,t,r){let i=j(n);if(i.gu)return void F(cr,"Ignoring unexpected query state notification.");let s=i.Iu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=await pw(i.localStore,bT(s[0])),c=Xo.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ce.EMPTY_BYTE_STRING);await In(i,o,c);break}case"rejected":await Hi(i.localStore,e,!0),Qi(i,e,r);break;default:J(64155,t)}}async function bN(n,e,t){let r=Tl(n);if(r.gu){for(let i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){F(cr,"Adding an already active target "+i);continue}let s=await fw(r.localStore,i),o=await $i(r.localStore,s);await Pg(r,Dw(s),o.targetId,!1,o.resumeToken),El(r.remoteStore,o)}for(let i of t)r.Iu.has(i)&&await Hi(r.localStore,i,!1).then((()=>{Ki(r.remoteStore,i),Qi(r,i)})).catch(ir)}}function Tl(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Cw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dN.bind(null,e),e.Pu.J_=sN.bind(null,e.eventManager),e.Pu.yu=oN.bind(null,e.eventManager),e}function Dg(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pN.bind(null,e),e}function RN(n,e,t){let r=j(n);(async function(s,o,c){try{let u=await o.getMetadata();if(await(function(w,k){let V=j(w),x=ve(k.createTime);return V.persistence.runTransaction("hasNewerBundle","readonly",(H=>V.Pi.getBundleMetadata(H,k.id))).then((H=>!!H&&H.createTime.compareTo(x)>=0))})(s.localStore,u))return await o.close(),c._completeWith((function(w){return{taskState:"Success",documentsLoaded:w.totalDocuments,bytesLoaded:w.totalBytes,totalDocuments:w.totalDocuments,totalBytes:w.totalBytes}})(u)),Promise.resolve(new Set);c._updateProgress(Pw(u));let l=new Gu(u,o.serializer),d=await o.Su();for(;d;){let m=await l.Ga(d);m&&c._updateProgress(m),d=await o.Su()}let p=await l.ja(s.localStore);return await In(s,p.Ja,void 0),await(function(w,k){let V=j(w);return V.persistence.runTransaction("Save bundle","readwrite",(x=>V.Pi.saveBundleMetadata(x,k)))})(s.localStore,u),c._completeWith(p.progress),Promise.resolve(p.Ha)}catch(u){return Vt(cr,`Loading bundle failed with ${u}`),c._failWith(u),Promise.resolve(new Set)}})(r,e,t).then((i=>{r.sharedClientState.notifyBundleLoaded(i)}))}var er=class{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qr(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return uw(this.persistence,new Vu,e.initialUser,this.serializer)}Cu(e){return new sa(Du.Vi,this.serializer)}Du(e){return new Mu}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};er.provider={build:()=>new er};var Qu=class extends er{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Y(this.persistence.referenceDelegate instanceof Nu,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Su(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?ut.withCacheSize(this.cacheSizeBytes):ut.DEFAULT;return new sa((r=>Nu.Vi(r,t)),this.serializer)}},la=class extends er{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Dg(this.xu.syncEngine),await rs(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return uw(this.persistence,new Vu,e.initialUser,this.serializer)}Fu(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Su(r,e.asyncQueue,t)}Mu(e,t){let r=new Tf(t,this.persistence);return new Ef(e.asyncQueue,r)}Cu(e){let t=Ig(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ut.withCacheSize(this.cacheSizeBytes):ut.DEFAULT;return new Ep(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Ew(),eu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Mu}},Ju=class extends la{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.xu.syncEngine;this.sharedClientState instanceof xo&&(this.sharedClientState.syncEngine={So:TN.bind(null,t),Do:AN.bind(null,t),Co:bN.bind(null,t),hs:vN.bind(null,t),bo:EN.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async r=>{await wN(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){let t=Ew();if(!xo.v(t))throw new z(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=Ig(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new xo(t,e.asyncQueue,r,e.clientId,e.initialUser)}},tr=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>OE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=_N.bind(null,this.syncEngine),await xp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Fp})()}createDatastore(e){let t=Qr(e.databaseInfo.databaseId),r=Iw(e.databaseInfo);return Tw(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,o,c){return new Op(r,i,s,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>OE(this.syncEngine,t,0)),(function(){return Fu.v()?new Fu:new bp})())}createSyncEngine(e,t){return(function(i,s,o,c,u,l,d){let p=new Wp(i,s,o,c,u,l);return d&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){let r=j(t);F($r,"RemoteStore shutting down."),r.Ea.add(5),await ns(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};tr.provider={build:()=>new tr};function LE(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){let r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}var Ji=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ke("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}};var jp=class{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new De,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){let e=await this.Ku();if(e===null)return null;let t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);let i=await this.Uu(r);return new zu(JSON.parse(i),e.length+r)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");let t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){let e=await this.Bu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}};var Gp=class{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.Su();if(!r||!r.Ua())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r?.qa)}`);this.metadata=r;do r=this.Su(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;let e=this.Ku(),t=this.Uu(e);return new zu(JSON.parse(t),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new z(N.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){let e=this.cursor,t=this.cursor;for(;t<this.bundleData.length;){if(this.bundleData[t]==="{"){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}};var $p=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new z(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await(async function(i,s){let o=j(i),c={documents:s.map((p=>ea(o.serializer,p)))},u=await o.jo("BatchGetDocuments",o.serializer.databaseId,ce.emptyPath(),c,s.length),l=new Map;u.forEach((p=>{let m=SD(o.serializer,p);l.set(m.key.toString(),m)}));let d=[];return s.forEach((p=>{let m=l.get(p.toString());Y(!!m,55234,{key:p}),d.push(m)})),d})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new zr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{let i=$.fromPath(r);this.mutations.push(new Qo(i,this.precondition(i)))})),await(async function(r,i){let s=j(r),o={writes:i.map((c=>na(s.serializer,c)))};await s.Wo("Commit",s.serializer.databaseId,ce.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw J(50498,{Gu:e.constructor.name});t=Z.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new z(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Z.min())?Je.exists(!1):Je.updateTime(t):Je.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Z.min()))throw new z(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Je.updateTime(t)}return Je.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Hp=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.zu=r.maxAttempts,this.M_=new aa(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{let e=new $p(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Zu(i)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{let t=this.updateFunction(e);return!da(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!MT(t)}return!1}};var nr="FirestoreClient",Kp=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=Le.UNAUTHENTICATED,this.clientId=Uo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{F(nr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(F(nr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new De;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ss(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};async function uf(n,e){n.asyncQueue.verifyOperationInProgress(),F(nr,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await lw(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ME(n,e){n.asyncQueue.verifyOperationInProgress();let t=await Ng(n);F(nr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>DE(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>DE(e.remoteStore,i))),n._onlineComponents=e}async function Ng(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F(nr,"Using user provided OfflineComponentProvider");try{await uf(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Vt("Error using user provided cache. Falling back to memory cache: "+t),await uf(n,new er)}}else F(nr,"Using default OfflineComponentProvider"),await uf(n,new Qu(void 0));return n._offlineComponents}async function wl(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(F(nr,"Using user provided OnlineComponentProvider"),await ME(n,n._uninitializedComponentsProvider._online)):(F(nr,"Using default OnlineComponentProvider"),await ME(n,new tr))),n._onlineComponents}function Nw(n){return Ng(n).then((e=>e.persistence))}function os(n){return Ng(n).then((e=>e.localStore))}function Vw(n){return wl(n).then((e=>e.remoteStore))}function Vg(n){return wl(n).then((e=>e.syncEngine))}function Og(n){return wl(n).then((e=>e.datastore))}async function Yi(n){let e=await wl(n),t=e.eventManager;return t.onListen=aN.bind(null,e.syncEngine),t.onUnlisten=uN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=cN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=lN.bind(null,e.syncEngine),t}function PN(n){return n.asyncQueue.enqueue((async()=>{let e=await Nw(n),t=await Vw(n);return e.setNetworkEnabled(!0),(function(i){let s=j(i);return s.Ea.delete(0),_a(s)})(t)}))}function SN(n){return n.asyncQueue.enqueue((async()=>{let e=await Nw(n),t=await Vw(n);return e.setNetworkEnabled(!1),(async function(i){let s=j(i);s.Ea.add(0),await ns(s),s.Va.set("Offline")})(t)}))}function CN(n,e,t,r){let i=new Ji(r),s=new ua(e,i,t);return n.asyncQueue.enqueueAndForget((async()=>Ag(await Yi(n),s))),()=>{i.Nu(),n.asyncQueue.enqueueAndForget((async()=>bg(await Yi(n),s)))}}function kN(n,e){let t=new De;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,s,o){try{let c=await(function(l,d){let p=j(l);return p.persistence.runTransaction("read document","readonly",(m=>p.localDocuments.getDocument(m,d)))})(i,s);c.isFoundDocument()?o.resolve(c):c.isNoDocument()?o.resolve(null):o.reject(new z(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(c){let u=ss(c,`Failed to get document '${s} from cache`);o.reject(u)}})(await os(n),e,t))),t.promise}function DN(n,e,t={}){let r=new De;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,c,u,l){let d=new Ji({next:m=>{d.Nu(),o.enqueueAndForget((()=>bg(s,p)));let w=m.docs.has(c);!w&&m.fromCache?l.reject(new z(N.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&u&&u.source==="server"?l.reject(new z(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new ua(ts(c.path),d,{includeMetadataChanges:!0,Ka:!0});return Ag(s,p)})(await Yi(n),n.asyncQueue,e,t,r))),r.promise}function NN(n,e){let t=new De;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,s,o){try{let c=await Ou(i,s,!0),u=new Ku(s,c.ks),l=u.ru(c.documents),d=u.applyChanges(l,!1);o.resolve(d.snapshot)}catch(c){let u=ss(c,`Failed to execute query '${s} against cache`);o.reject(u)}})(await os(n),e,t))),t.promise}function VN(n,e,t={}){let r=new De;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,c,u,l){let d=new Ji({next:m=>{d.Nu(),o.enqueueAndForget((()=>bg(s,p))),m.fromCache&&u.source==="server"?l.reject(new z(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new ua(c,d,{includeMetadataChanges:!0,Ka:!0});return Ag(s,p)})(await Yi(n),n.asyncQueue,e,t,r))),r.promise}function ON(n,e,t){let r=new De;return n.asyncQueue.enqueueAndForget((async()=>{try{let i=await Og(n);r.resolve((async function(o,c,u){let l=j(o),{request:d,gt:p,parent:m}=$T(l.serializer,wT(c),u);l.connection.Ko||delete d.parent;let w=(await l.jo("RunAggregationQuery",l.serializer.databaseId,m,d,1)).filter((V=>!!V.result));Y(w.length===1,64727);let k=w[0].result?.aggregateFields;return Object.keys(k).reduce(((V,x)=>(V[p[x]]=k[x],V)),{})})(i,e,t))}catch(i){r.reject(i)}})),r.promise}function xN(n,e){let t=new De;return n.asyncQueue.enqueueAndForget((async()=>{try{let r=await Og(n);t.resolve((async function(s,o){let c=j(s),u={database:ta(c.serializer),structuredPipeline:o._toProto(c.serializer)},l=await c.jo("ExecutePipeline",c.serializer.databaseId,ce.emptyPath(),u),d=[];return l.forEach((p=>{if(p.results&&p.results.length!==0)return p.results.forEach((m=>d.push(oE(c.serializer,p,m))));d.push(oE(c.serializer,p))})),d})(r,e))}catch(r){t.reject(r)}})),t.promise}function LN(n,e){let t=new De;return n.asyncQueue.enqueueAndForget((async()=>hN(await Vg(n),e,t))),t.promise}function MN(n,e){let t=new Ji(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,s){j(i).Ca.add(s),s.next()})(await Yi(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,s){j(i).Ca.delete(s)})(await Yi(n),t)))}}function FN(n,e,t){let r=new De;return n.asyncQueue.enqueueAndForget((async()=>{let i=await Og(n);new Hp(n.asyncQueue,i,t,e,r).ju()})),r.promise}function UN(n,e,t,r){let i=(function(o,c){let u;return u=typeof o=="string"?UT().encode(o):o,(function(d,p){return new jp(d,p)})((function(d,p){if(d instanceof Uint8Array)return LE(d,p);if(d instanceof ArrayBuffer)return LE(new Uint8Array(d),p);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(u),c)})(t,Qr(e));n.asyncQueue.enqueueAndForget((async()=>{RN(await Vg(n),i,r)}))}function BN(n,e){return n.asyncQueue.enqueue((async()=>(function(r,i){let s=j(r);return s.persistence.runTransaction("Get named query","readonly",(o=>s.Pi.getNamedQuery(o,i)))})(await os(n),e)))}function qN(n,e){return(function(r,i){return new Gp(r,i)})(n,e)}function WN(n,e){return n.asyncQueue.enqueue((async()=>(async function(r,i){let s=j(r),o=s.indexManager,c=[];return s.persistence.runTransaction("Configure indexes","readwrite",(u=>o.getFieldIndexes(u).next((l=>(function(p,m,w,k,V){p=[...p],m=[...m],p.sort(w),m.sort(w);let x=p.length,H=m.length,X=0,K=0;for(;X<H&&K<x;){let te=w(p[K],m[X]);te<0?V(p[K++]):te>0?k(m[X++]):(X++,K++)}for(;X<H;)k(m[X++]);for(;K<x;)V(p[K++])})(l,i,R0,(d=>{c.push(o.addFieldIndex(u,d))}),(d=>{c.push(o.deleteFieldIndex(u,d))})))).next((()=>P.waitFor(c)))))})(await os(n),e)))}function zN(n,e){return n.asyncQueue.enqueue((async()=>(function(r,i){j(r).Cs.As=i})(await os(n),e)))}function jN(n){return n.asyncQueue.enqueue((async()=>(function(t){let r=j(t),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",(s=>i.deleteAllFieldIndexes(s)))})(await os(n))))}function Ow(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var xw="ComponentProvider",Lo=new Map;function Lw(n,e,t,r,i){return new bf(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Ow(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}var Mw="firestore.googleapis.com",FE=!0,Yu=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new z(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Mw,this.ssl=FE}else this.host=e.host,this.ssl=e.ssl??FE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<sw)throw new z(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ow(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new z(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new z(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new z(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Kr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new z(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new z(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new nu;switch(r.type){case"firstParty":return new ff(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new z(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=Lo.get(t);r&&(F(xw,"Removing Datastore"),Lo.delete(t),r.terminate())})(this),Promise.resolve()}};function Fw(n,e,t,r={}){n=At(n,Kr);let i=he.isCloudWorkstation(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(he.pingServer(`https://${c}`),he.updateEmulatorBanner("Firestore",!0)),s.host!==Mw&&s.host!==c&&Vt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let u={...s,host:c,ssl:i,emulatorOptions:r};if(!he.deepEqual(u,o)&&(n._setSettings(u),r.mockUserToken)){let l,d;if(typeof r.mockUserToken=="string")l=r.mockUserToken,d=Le.MOCK_USER;else{l=he.createMockUserToken(r.mockUserToken,n._app?.options.projectId);let p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new z(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Le(p)}n._authCredentials=new lf(new tu(l,d))}}var rr=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},et=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(es(t,n._jsonSchema))return new n(e,r||null,new $(ce.fromString(t.referencePath)))}};et._jsonSchemaVersion="firestore/documentReference/1.0",et._jsonSchema={type:It("string",et._jsonSchemaVersion),referencePath:It("string")};var Tt=class n extends rr{constructor(e,t,r){super(e,t,ts(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new et(this.firestore,null,new $(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function GN(n){return n instanceof Tt}function $N(n,e,...t){if(n=he.getModularInstance(n),ng("collection","path",e),n instanceof Kr){let r=ce.fromString(e,...t);return VI(r),new Tt(n,null,r)}{if(!(n instanceof et||n instanceof Tt))throw new z(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return VI(r),new Tt(n.firestore,null,r)}}function HN(n,e){if(n=At(n,Kr),ng("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new z(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new rr(n,null,(function(r){return new Ot(ce.emptyPath(),r)})(e))}function KN(n,e,...t){if(n=he.getModularInstance(n),arguments.length===1&&(e=Uo.newId()),ng("doc","path",e),n instanceof Kr){let r=ce.fromString(e,...t);return NI(r),new et(n,null,new $(r))}{if(!(n instanceof et||n instanceof Tt))throw new z(N.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return NI(r),new et(n.firestore,n instanceof Tt?n.converter:null,new $(r))}}function QN(n,e){return n=he.getModularInstance(n),e=he.getModularInstance(e),(n instanceof et||n instanceof Tt)&&(e instanceof et||e instanceof Tt)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function JN(n,e){return n=he.getModularInstance(n),e=he.getModularInstance(e),n instanceof rr&&e instanceof rr&&n.firestore===e.firestore&&ga(n._query,e._query)&&n.converter===e.converter}var UE="AsyncQueue",Xu=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new aa(this,"async_queue_retry"),this._c=()=>{let r=eu();r&&F(UE,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=eu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=eu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));let t=new De;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!sr(e))throw e;F(UE,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){let t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ke("INTERNAL UNHANDLED ERROR: ",BE(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=Lp.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&J(47125,{Pc:BE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function BE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Zu=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new De,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var YN=-1,vt=class extends Kr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Xu,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Xu(e),this._firestoreClient=void 0,await e}}};function XN(n,e,t){t||(t=$o);let r=Mo._getProvider(n,"firestore");if(r.isInitialized(t)){let i=r.getImmediate({identifier:t}),s=r.getOptions(t);if(he.deepEqual(s,e))return i;throw new z(N.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new z(N.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<sw)throw new z(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&he.isCloudWorkstation(e.host)&&he.pingServer(e.host),r.initialize({options:e,instanceIdentifier:t})}function ZN(n,e){let t=typeof n=="object"?n:Mo.getApp(),r=typeof n=="string"?n:e||$o,i=Mo._getProvider(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=he.getDefaultEmulatorHostnameAndPort("firestore");s&&Fw(i,...s)}return i}function ur(n){if(n._terminated)throw new z(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Uw(n),n._firestoreClient}function Uw(n){let e=n._freezeSettings(),t=Lw(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Kp(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function eV(n,e){Vt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return Bw(n,tr.provider,{build:r=>new la(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function tV(n){Vt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();Bw(n,tr.provider,{build:t=>new Ju(t,e.cacheSizeBytes)})}function Bw(n,e,t){if((n=At(n,vt))._firestoreClient||n._terminated)throw new z(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new z(N.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Uw(n)}function nV(n){if(n._initialized&&!n._terminated)throw new z(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new De;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!Hn.v())return Promise.resolve();let i=r+cw;await Hn.delete(i)})(Ig(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function rV(n){return(function(t){let r=new De;return t.asyncQueue.enqueueAndForget((async()=>gN(await Vg(t),r))),r.promise})(ur(n=At(n,vt)))}function iV(n){return PN(ur(n=At(n,vt)))}function sV(n){return SN(ur(n=At(n,vt)))}function oV(n){return Mo._removeServiceInstance(n.app,"firestore",n._databaseId.database),n._delete()}function aV(n,e){let t=ur(n=At(n,vt)),r=new Zu;return UN(t,n._databaseId,e,r),r}function cV(n,e){return BN(ur(n=At(n,vt)),e).then((t=>t?new rr(n,null,t.query):null))}var dn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ce.fromBase64String(e))}catch(t){throw new z(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ce.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(es(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};dn._jsonSchemaVersion="firestore/bytes/1.0",dn._jsonSchema={type:It("string",dn._jsonSchemaVersion),bytes:It("string")};var Xi=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new z(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Re(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};function uV(){return new Xi(ru)}var Zt=class{constructor(e){this._methodName=e}};var fn=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new z(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new z(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(es(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};fn._jsonSchemaVersion="firestore/geoPoint/1.0",fn._jsonSchema={type:It("string",fn._jsonSchemaVersion),latitude:It("number"),longitude:It("number")};var Nt=class n{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(es(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new n(e.vectorValues);throw new z(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Nt._jsonSchemaVersion="firestore/vectorValue/1.0",Nt._jsonSchema={type:It("string",Nt._jsonSchemaVersion),vectorValues:It("object")};var lV=/^__.*__$/,Qp=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Lt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Xn(e,this.data,t,this.fieldTransforms)}},el=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Lt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function qw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{dataSource:n})}}var tl=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return il(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(qw(this.dataSource)&&lV.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},nl=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Qr(e)}createContext(e,t,r,i=!1){return new tl({dataSource:e,methodName:t,targetDoc:r,path:Re.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function hV(n){let e=n._freezeSettings(),t=Qr(n._databaseId);return new nl(n._databaseId,!!e.ignoreUndefinedProperties,t)}function dV(n,e,t,r,i,s={}){let o=n.createContext(s.merge||s.mergeFields?2:0,e,t,i);xg("Data must be an object, but it was:",o,r);let c=zw(r,o),u,l;if(s.merge)u=new yt(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let p of s.mergeFields){let m=rl(e,p,t);if(!o.contains(m))throw new z(N.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Gw(d,m)||d.push(m)}u=new yt(d),l=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,l=o.fieldTransforms;return new Qp(new Be(c),u,l)}var ha=class n extends Zt{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function Ww(n,e,t){return new tl({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Jp=class n extends Zt{_toFieldTransform(e){return new Wr(e.path,new Jn)}isEqual(e){return e instanceof n}},Yp=class n extends Zt{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){let t=Ww(this,e,!0),r=this.Ac.map((s=>en(s,t))),i=new _n(r);return new Wr(e.path,i)}isEqual(e){return e instanceof n&&he.deepEqual(this.Ac,e.Ac)}},Xp=class n extends Zt{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){let t=Ww(this,e,!0),r=this.Ac.map((s=>en(s,t))),i=new yn(r);return new Wr(e.path,i)}isEqual(e){return e instanceof n&&he.deepEqual(this.Ac,e.Ac)}},Zp=class n extends Zt{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){let t=new Yn(e.serializer,gg(e.serializer,this.Vc));return new Wr(e.path,t)}isEqual(e){return e instanceof n&&this.Vc===e.Vc}};function fV(n,e,t,r){let i=n.createContext(1,e,t);xg("Data must be an object, but it was:",i,r);let s=[],o=Be.empty();or(r,((u,l)=>{let d=Lg(e,u,t);l=he.getModularInstance(l);let p=i.childContextForFieldPath(d);if(l instanceof ha)s.push(d);else{let m=en(l,p);m!=null&&(s.push(d),o.set(d,m))}}));let c=new yt(s);return new el(o,c,i.fieldTransforms)}function pV(n,e,t,r,i,s){let o=n.createContext(1,e,t),c=[rl(e,r,t)],u=[i];if(s.length%2!=0)throw new z(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)c.push(rl(e,s[m])),u.push(s[m+1]);let l=[],d=Be.empty();for(let m=c.length-1;m>=0;--m)if(!Gw(l,c[m])){let w=c[m],k=u[m];k=he.getModularInstance(k);let V=o.childContextForFieldPath(w);if(k instanceof ha)l.push(w);else{let x=en(k,V);x!=null&&(l.push(w),d.set(w,x))}}let p=new yt(l);return new el(d,p,o.fieldTransforms)}function gV(n,e,t,r=!1){return en(t,n.createContext(r?4:3,e))}function en(n,e){if(jw(n=he.getModularInstance(n)))return xg("Unsupported field value:",e,n),zw(n,e);if(n instanceof Zt)return(function(r,i){if(!qw(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let c of r){let u=en(c,i.childContextForArray(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=he.getModularInstance(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return gg(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ee.fromDate(r);return{timestampValue:zi(i.serializer,s)}}if(r instanceof Ee){let s=new Ee(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:zi(i.serializer,s)}}if(r instanceof fn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof dn)return{bytesValue:BT(i.serializer,r._byteString)};if(r instanceof et){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:mg(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Nt)return(function(o,c){let u=o instanceof Nt?o.toArray():o;return{mapValue:{fields:{[lg]:{stringValue:hg},[Fi]:{arrayValue:{values:u.map((d=>{if(typeof d!="number")throw c.createError("VectorValues must only contain numeric values.");return pg(c.serializer,d)}))}}}}}})(r,i);if(YT(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${ll(r)}`)})(n,e)}function zw(n,e){let t={};return sT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):or(n,((r,i)=>{let s=en(i,e.childContextForField(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function jw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ee||n instanceof fn||n instanceof dn||n instanceof et||n instanceof Zt||n instanceof Nt||YT(n))}function xg(n,e,t){if(!jw(t)||!ul(t)){let r=ll(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function rl(n,e,t){if((e=he.getModularInstance(e))instanceof Xi)return e._internalPath;if(typeof e=="string")return Lg(n,e);throw il("Field path arguments must be of type string or ",n,!1,void 0,t)}var mV=new RegExp("[~\\*/\\[\\]]");function Lg(n,e,t){if(e.search(mV)>=0)throw il(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Xi(...e.split("."))._internalPath}catch{throw il(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function il(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new z(N.INVALID_ARGUMENT,c+n+u)}function Gw(n,e){return n.some((t=>t.isEqual(e)))}function _V(n){return typeof n._readUserData=="function"}var sl=class{convertValue(e,t="none"){switch(Kn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return we(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return or(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){let t=e.fields?.[Fi].arrayValue?.values?.map((r=>we(r.doubleValue)));return new Nt(t)}convertGeoPoint(e){return new fn(we(e.latitude),we(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":let r=gl(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Go(e));default:return null}}convertTimestamp(e){let t=pn(e);return new Ee(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ce.fromString(e);Y(JT(r),9688,{name:e});let i=new Ur(r.get(1),r.get(3)),s=new $(r.popFirst(5));return i.isEqual(t)||ke(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};var eg=class extends sl{constructor(e){super(),this.firestore=e}convertBytes(e){return new dn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new et(this.firestore,null,t)}};function yV(){return new ha("deleteField")}function IV(){return new Jp("serverTimestamp")}function EV(...n){return new Yp("arrayUnion",n)}function TV(...n){return new Xp("arrayRemove",n)}function wV(n){return new Zp("increment",n)}function vV(n){return new Nt(n)}var ol=class n{constructor(e){this.optionDefinitions=e}_getKnownOptions(e,t){let r=Be.empty();for(let i in this.optionDefinitions)if(this.optionDefinitions.hasOwnProperty(i)){let s=this.optionDefinitions[i];if(i in e){let o=e[i],c;s.nestedOptions&&ul(o)?c={mapValue:{fields:new n(s.nestedOptions).getOptionsProto(t,o)}}:o&&(c=en(o,t)??void 0),c&&r.set(Re.fromServerFormat(s.serverName),c)}}return r}getOptionsProto(e,t,r){let i=this._getKnownOptions(t,e);if(r){let s=new Map(ug(r,((o,c)=>[Re.fromServerFormat(c),o!==void 0?en(o,e):null])));i.setAll(s)}return i.value.mapValue.fields??{}}};var al=class{constructor(e={},t={}){this.dc=e,this.mc=t,this.fc=new ol({indexMode:{serverName:"index_mode"}})}_readUserData(e){this.proto=this.fc.getOptionsProto(e,this.dc,this.mc)}},cl=class{constructor(e,t){this.pipeline=e,this.options=t}_toProto(e){return{pipeline:this.pipeline._toProto(e),options:this.options.proto}}};function AV(n){let e=ur(At(n.firestore,vt)),t=e._onlineComponents?.datastore.serializer;return t===void 0?null:yl(t,Ze(n._query)).ft}function bV(n,e){let t=ug(e,((s,o)=>new _u(o,s.aggregateType,s._internalFieldPath))),r=ur(At(n.firestore,vt)),i=r._onlineComponents?.datastore.serializer;return i===void 0?null:$T(i,wT(n._query),t,!0).request}function RV(n){let e=(function(s){if(s._terminated)throw new z(N.FAILED_PRECONDITION,"The client has already been terminated.");if(!Lo.has(s)){F(xw,"Initializing Datastore");let o=Iw(Lw(s._databaseId,s.app.options.appId||"",s._persistenceKey,s.app.options.apiKey,s._freezeSettings())),c=Qr(s._databaseId),u=Tw(s._authCredentials,s._appCheckCredentials,o,c);Lo.set(s,u)}return Lo.get(s)})(At(n._db,vt)),t=e.serializer;if(t===void 0)return null;let r=new cl(n,new al);return{database:ta(t),structuredPipeline:r._toProto(t)}}C.AbstractUserDataWriter=sl;C.Bound=mn;C.ByteString=Ce;C.Bytes=dn;C.C=N;C.CollectionReference=Tt;C.CompositeFilter=fe;C.DatabaseId=Ur;C.DocumentKey=$;C.DocumentReference=et;C.DocumentSet=ca;C.FieldFilter=oe;C.FieldIndex=Fr;C.FieldPath=Xi;C.FieldPath$1=Re;C.FieldValue=Zt;C.Firestore=vt;C.FirestoreError=z;C.GeoPoint=fn;C.IndexSegment=xr;C.IndexState=Vi;C.LoadBundleTask=Zu;C.M=ru;C.ObjectValue=Be;C.OnlineComponentProvider=tr;C.OptionsUtil=ol;C.OrderBy=Br;C.Precondition=Je;C.Query=rr;C.ResourcePath=ce;C.StructuredPipeline=cl;C.Timestamp=Ee;C.UserDataReader=nl;C.VectorValue=Nt;C.ViewSnapshot=Hr;C.__PRIVATE_AggregateImpl=_u;C.__PRIVATE_AutoId=Uo;C.__PRIVATE_BundleLoader=Gu;C.__PRIVATE_DeleteMutation=zr;C.__PRIVATE_EmptyAppCheckTokenProvider=gf;C.__PRIVATE_EmptyAuthCredentialsProvider=nu;C.__PRIVATE_ExpUserDataWriter=eg;C.__PRIVATE_FirebaseAppCheckTokenProvider=pf;C.__PRIVATE_FirebaseAuthCredentialsProvider=hf;C.__PRIVATE_IndexedDbOfflineComponentProvider=la;C.__PRIVATE_LruGcMemoryOfflineComponentProvider=Qu;C.__PRIVATE_MemoryOfflineComponentProvider=er;C.__PRIVATE_MultiTabOfflineComponentProvider=Ju;C.__PRIVATE_StructuredPipelineOptions=al;C.__PRIVATE_cast=At;C.__PRIVATE_createBundleReaderSync=qN;C.__PRIVATE_databaseIdFromApp=iD;C.__PRIVATE_debugAssert=I0;C.__PRIVATE_documentKeySet=re;C.__PRIVATE_fieldPathFromArgument=rl;C.__PRIVATE_fieldPathFromDotSeparatedString=Lg;C.__PRIVATE_firestoreClientAddSnapshotsInSyncListener=MN;C.__PRIVATE_firestoreClientDeleteAllFieldIndexes=jN;C.__PRIVATE_firestoreClientExecutePipeline=xN;C.__PRIVATE_firestoreClientGetDocumentFromLocalCache=kN;C.__PRIVATE_firestoreClientGetDocumentViaSnapshotListener=DN;C.__PRIVATE_firestoreClientGetDocumentsFromLocalCache=NN;C.__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener=VN;C.__PRIVATE_firestoreClientListen=CN;C.__PRIVATE_firestoreClientRunAggregateQuery=ON;C.__PRIVATE_firestoreClientSetIndexConfiguration=WN;C.__PRIVATE_firestoreClientSetPersistentCacheIndexAutoCreationEnabled=zN;C.__PRIVATE_firestoreClientTransaction=FN;C.__PRIVATE_firestoreClientWrite=LN;C.__PRIVATE_fromBundledQuery=Il;C.__PRIVATE_fromDocument=_g;C.__PRIVATE_hardAssert=Y;C.__PRIVATE_isBase64Available=nD;C.__PRIVATE_isCollectionGroupQuery=TT;C.__PRIVATE_isCollectionReference=GN;C.__PRIVATE_isDocumentQuery$1=ET;C.__PRIVATE_isNumber$1=S0;C.__PRIVATE_isOptionalEqual=v0;C.__PRIVATE_isPlainObject=ul;C.__PRIVATE_isServerTimestamp=pl;C.__PRIVATE_isString=C0;C.__PRIVATE_isUserData=_V;C.__PRIVATE_logDebug=F;C.__PRIVATE_logWarn=Vt;C.__PRIVATE_mapToArray=ug;C.__PRIVATE_newQueryForPath=ts;C.__PRIVATE_newSerializer=Qr;C.__PRIVATE_newUserDataReader=hV;C.__PRIVATE_parseData=en;C.__PRIVATE_parseQueryValue=gV;C.__PRIVATE_parseSetData=dV;C.__PRIVATE_parseUpdateData=fV;C.__PRIVATE_parseUpdateVarargs=pV;C.__PRIVATE_queryNormalizedOrderBy=Ci;C.__PRIVATE_queryWithAddedFilter=cD;C.__PRIVATE_queryWithAddedOrderBy=uD;C.__PRIVATE_queryWithEndAt=hD;C.__PRIVATE_queryWithLimit=mu;C.__PRIVATE_queryWithStartAt=lD;C.__PRIVATE_refValue=ml;C.__PRIVATE_setSDKVersion=_0;C.__PRIVATE_setTestingHooksSpi=wD;C.__PRIVATE_toMapValue=LD;C.__PRIVATE_toPipelineValue=FD;C.__PRIVATE_toStringValue=MD;C.__PRIVATE_validateIsNotUsedTogether=zE;C.__PRIVATE_validateJSON=es;C.__PRIVATE_validatePositiveNumber=b0;C.__PRIVATE_valueDescription=ll;C._internalAggregationQueryToProtoRunAggregationQueryRequest=bV;C._internalPipelineToExecutePipelineRequestProto=RV;C._internalQueryToProtoQueryTarget=AV;C.arrayRemove=TV;C.arrayUnion=EV;C.clearIndexedDbPersistence=nV;C.collection=$N;C.collectionGroup=HN;C.connectFirestoreEmulator=Fw;C.deleteField=yV;C.disableNetwork=sV;C.doc=KN;C.documentId=uV;C.enableIndexedDbPersistence=eV;C.enableMultiTabIndexedDbPersistence=tV;C.enableNetwork=iV;C.ensureFirestoreConfigured=ur;C.fail=J;C.getFirestore=ZN;C.increment=wV;C.initializeFirestore=XN;C.loadBundle=aV;C.namedQuery=cV;C.on=YN;C.property=It;C.queryEqual=JN;C.refEqual=QN;C.serverTimestamp=IV;C.setLogLevel=y0;C.terminate=oV;C.toNumber=gg;C.vector=vV;C.waitForPendingWrites=rV});var cv=Ne(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});var vl=Er(),PV=qt(),g=$w(),En=Pt();Zd();Ir();ef();var Hw="@firebase/firestore",Kw="4.11.0";function as(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var hr=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},bl=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new g.ObjectValue({mapValue:{fields:this._data}}).clone().value.mapValue.fields}};var Yr=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new g.DocumentReference(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Mg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(g.__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Mg=class extends Yr{data(){return super.data()}};function Zw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new g.FirestoreError(g.C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ya=class{},dr=class extends ya{};function SV(n,e,...t){let r=[];e instanceof ya&&r.push(e),r=r.concat(t),(function(s){let o=s.filter((u=>u instanceof Xr)).length,c=s.filter((u=>u instanceof cs)).length;if(o>1||o>0&&c>0)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var cs=class n extends dr{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return tv(e._query,t),new g.Query(e.firestore,e.converter,g.__PRIVATE_queryWithAddedFilter(e._query,t))}_parse(e){let t=g.__PRIVATE_newUserDataReader(e.firestore);return(function(s,o,c,u,l,d,p){let m;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Jw(p,d);let k=[];for(let V of p)k.push(Qw(u,s,V));m={arrayValue:{values:k}}}else m=Qw(u,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Jw(p,d),m=g.__PRIVATE_parseQueryValue(c,o,p,d==="in"||d==="not-in");return g.FieldFilter.create(l,d,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function CV(n,e,t){let r=e,i=g.__PRIVATE_fieldPathFromArgument("where",n);return cs._create(i,r,t)}var Xr=class n extends ya{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:g.CompositeFilter.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i,c=s.getFlattenedFilters();for(let u of c)tv(o,u),o=g.__PRIVATE_queryWithAddedFilter(o,u)})(e._query,t),new g.Query(e.firestore,e.converter,g.__PRIVATE_queryWithAddedFilter(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function kV(...n){return n.forEach((e=>nv("or",e))),Xr._create("or",n)}function DV(...n){return n.forEach((e=>nv("and",e))),Xr._create("and",n)}var Rl=class n extends dr{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,s,o){if(i.startAt!==null)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new g.OrderBy(s,o)})(e._query,this._field,this._direction);return new g.Query(e.firestore,e.converter,g.__PRIVATE_queryWithAddedOrderBy(e._query,t))}};function NV(n,e="asc"){let t=e,r=g.__PRIVATE_fieldPathFromArgument("orderBy",n);return Rl._create(r,t)}var Ia=class n extends dr{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new g.Query(e.firestore,e.converter,g.__PRIVATE_queryWithLimit(e._query,this._limit,this._limitType))}};function VV(n){return g.__PRIVATE_validatePositiveNumber("limit",n),Ia._create("limit",n,"F")}function OV(n){return g.__PRIVATE_validatePositiveNumber("limitToLast",n),Ia._create("limitToLast",n,"L")}var Ea=class n extends dr{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=ev(e,this.type,this._docOrFields,this._inclusive);return new g.Query(e.firestore,e.converter,g.__PRIVATE_queryWithStartAt(e._query,t))}};function xV(...n){return Ea._create("startAt",n,!0)}function LV(...n){return Ea._create("startAfter",n,!1)}var Ta=class n extends dr{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=ev(e,this.type,this._docOrFields,this._inclusive);return new g.Query(e.firestore,e.converter,g.__PRIVATE_queryWithEndAt(e._query,t))}};function MV(...n){return Ta._create("endBefore",n,!1)}function FV(...n){return Ta._create("endAt",n,!0)}function ev(n,e,t,r){if(t[0]=En.getModularInstance(t[0]),t[0]instanceof Yr)return(function(s,o,c,u,l){if(!u)throw new g.FirestoreError(g.C.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);let d=[];for(let p of g.__PRIVATE_queryNormalizedOrderBy(s))if(p.field.isKeyField())d.push(g.__PRIVATE_refValue(o,u.key));else{let m=u.data.field(p.field);if(g.__PRIVATE_isServerTimestamp(m))throw new g.FirestoreError(g.C.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let w=p.field.canonicalString();throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${w}' (used as the orderBy) does not exist.`)}d.push(m)}return new g.Bound(d,l)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=g.__PRIVATE_newUserDataReader(n.firestore);return(function(o,c,u,l,d,p){let m=o.explicitOrderBy;if(d.length>m.length)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let w=[];for(let k=0;k<d.length;k++){let V=d[k];if(m[k].field.isKeyField()){if(typeof V!="string")throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof V}`);if(!g.__PRIVATE_isCollectionGroupQuery(o)&&V.indexOf("/")!==-1)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${V}' contains a slash.`);let x=o.path.child(g.ResourcePath.fromString(V));if(!g.DocumentKey.isDocumentKey(x))throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);let H=new g.DocumentKey(x);w.push(g.__PRIVATE_refValue(c,H))}else{let x=g.__PRIVATE_parseQueryValue(u,l,V);w.push(x)}}return new g.Bound(w,p)})(n._query,n.firestore._databaseId,i,e,t,r)}}function Qw(n,e,t){if(typeof(t=En.getModularInstance(t))=="string"){if(t==="")throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!g.__PRIVATE_isCollectionGroupQuery(e)&&t.indexOf("/")!==-1)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(g.ResourcePath.fromString(t));if(!g.DocumentKey.isDocumentKey(r))throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return g.__PRIVATE_refValue(n,new g.DocumentKey(r))}if(t instanceof g.DocumentReference)return g.__PRIVATE_refValue(n,t._key);throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${g.__PRIVATE_valueDescription(t)}.`)}function Jw(n,e){if(!Array.isArray(n)||n.length===0)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tv(n,e){let t=(function(i,s){for(let o of i)for(let c of o.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new g.FirestoreError(g.C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function nv(n,e){if(!(e instanceof cs||e instanceof Xr))throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function kl(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var wa=class extends g.AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new g.Bytes(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new g.DocumentReference(this.firestore,null,t)}};function UV(n){return new hr("sum",g.__PRIVATE_fieldPathFromArgument("sum",n))}function BV(n){return new hr("avg",g.__PRIVATE_fieldPathFromArgument("average",n))}function rv(){return new hr("count")}function qV(n,e){return n instanceof hr&&e instanceof hr&&n.aggregateType===e.aggregateType&&n._internalFieldPath?.canonicalString()===e._internalFieldPath?.canonicalString()}function WV(n,e){return g.queryEqual(n.query,e.query)&&En.deepEqual(n.data(),e.data())}function zV(n){return iv(n,{count:rv()})}function iv(n,e){let t=g.__PRIVATE_cast(n.firestore,g.Firestore),r=g.ensureFirestoreConfigured(t),i=g.__PRIVATE_mapToArray(e,((s,o)=>new g.__PRIVATE_AggregateImpl(o,s.aggregateType,s._internalFieldPath)));return g.__PRIVATE_firestoreClientRunAggregateQuery(r,n._query,i).then((s=>(function(c,u,l){let d=new g.__PRIVATE_ExpUserDataWriter(c);return new bl(u,d,l)})(t,n,s)))}var Fg=class{constructor(e){this.kind="memory",this._onlineComponentProvider=g.OnlineComponentProvider.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new g.__PRIVATE_LruGcMemoryOfflineComponentProvider(void 0)}}toJSON(){return{kind:this.kind}}},Ug=class{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=sv(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}},Bg=class{constructor(){this.kind="memoryEager",this._offlineComponentProvider=g.__PRIVATE_MemoryOfflineComponentProvider.provider}toJSON(){return{kind:this.kind}}},qg=class{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new g.__PRIVATE_LruGcMemoryOfflineComponentProvider(e)}}toJSON(){return{kind:this.kind}}};function jV(){return new Bg}function GV(n){return new qg(n?.cacheSizeBytes)}function $V(n){return new Fg(n)}function HV(n){return new Ug(n)}var Wg=class{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=g.OnlineComponentProvider.provider,this._offlineComponentProvider={build:t=>new g.__PRIVATE_IndexedDbOfflineComponentProvider(t,e?.cacheSizeBytes,this.forceOwnership)}}},zg=class{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=g.OnlineComponentProvider.provider,this._offlineComponentProvider={build:t=>new g.__PRIVATE_MultiTabOfflineComponentProvider(t,e?.cacheSizeBytes)}}};function sv(n){return new Wg(n?.forceOwnership)}function KV(){return new zg}var ov="NOT SUPPORTED",Mt=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},ht=class n extends Yr{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Jr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(g.__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new g.FirestoreError(g.C.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};function QV(n,e,t){if(g.__PRIVATE_validateJSON(e,ht._jsonSchema)){if(e.bundle===ov)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let r=g.__PRIVATE_newSerializer(n._databaseId),i=g.__PRIVATE_createBundleReaderSync(e.bundle,r),s=i.t(),o=new g.__PRIVATE_BundleLoader(i.getMetadata(),r);for(let d of s)o.o(d);let c=o.documents;if(c.length!==1)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${c.length} documents.`);let u=g.__PRIVATE_fromDocument(r,c[0].document),l=new g.DocumentKey(g.ResourcePath.fromString(e.bundleName));return new ht(n,new wa(n),l,u,new Mt(!1,!1),t||null)}}ht._jsonSchemaVersion="firestore/documentSnapshot/1.0",ht._jsonSchema={type:g.property("string",ht._jsonSchemaVersion),bundleSource:g.property("string","DocumentSnapshot"),bundleName:g.property("string"),bundle:g.property("string")};var Jr=class extends ht{data(e={}){return super.data(e)}},dt=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Mt(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Jr(this._firestore,this._userDataWriter,r.key,r,new Mt(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{let u=new Jr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Mt(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>s||c.type!==3)).map((c=>{let u=new Jr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Mt(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return c.type!==0&&(l=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:YV(c.type),doc:u,oldIndex:l,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new g.FirestoreError(g.C.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=g.__PRIVATE_AutoId.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function JV(n,e,t){if(g.__PRIVATE_validateJSON(e,dt._jsonSchema)){if(e.bundle===ov)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let r=g.__PRIVATE_newSerializer(n._databaseId),i=g.__PRIVATE_createBundleReaderSync(e.bundle,r),s=i.t(),o=new g.__PRIVATE_BundleLoader(i.getMetadata(),r);for(let m of s)o.o(m);if(o.queries.length!==1)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);let c=g.__PRIVATE_fromBundledQuery(o.queries[0].bundledQuery),u=o.documents,l=new g.DocumentSet;u.map((m=>{let w=g.__PRIVATE_fromDocument(r,m.document);l=l.add(w)}));let d=g.ViewSnapshot.fromInitialDocuments(c,l,g.__PRIVATE_documentKeySet(),!1,!1),p=new g.Query(n,t||null,c);return new dt(n,new wa(n),p,d)}}function YV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return g.fail(61501,{type:n})}}function XV(n,e){return n instanceof ht&&e instanceof ht?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof dt&&e instanceof dt&&n._firestore===e._firestore&&g.queryEqual(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}dt._jsonSchemaVersion="firestore/querySnapshot/1.0",dt._jsonSchema={type:g.property("string",dt._jsonSchemaVersion),bundleSource:g.property("string","QuerySnapshot"),bundleName:g.property("string"),bundle:g.property("string")};var ZV={maxAttempts:5};var Pl=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=g.__PRIVATE_newUserDataReader(e)}set(e,t,r){this._verifyNotCommitted();let i=lr(e,this._firestore),s=kl(i.converter,t,r),o=g.__PRIVATE_parseSetData(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,g.Precondition.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=lr(e,this._firestore),o;return o=typeof(t=En.getModularInstance(t))=="string"||t instanceof g.FieldPath?g.__PRIVATE_parseUpdateVarargs(this._dataReader,"WriteBatch.update",s._key,t,r,i):g.__PRIVATE_parseUpdateData(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,g.Precondition.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=lr(e,this._firestore);return this._mutations=this._mutations.concat(new g.__PRIVATE_DeleteMutation(t._key,g.Precondition.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new g.FirestoreError(g.C.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function lr(n,e){if((n=En.getModularInstance(n)).firestore!==e)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var jg=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=g.__PRIVATE_newUserDataReader(e)}get(e){let t=lr(e,this._firestore),r=new wa(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return g.fail(24041);let s=i[0];if(s.isFoundDocument())return new Yr(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new Yr(this._firestore,r,t._key,null,t.converter);throw g.fail(18433,{doc:s})}))}set(e,t,r){let i=lr(e,this._firestore),s=kl(i.converter,t,r),o=g.__PRIVATE_parseSetData(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){let s=lr(e,this._firestore),o;return o=typeof(t=En.getModularInstance(t))=="string"||t instanceof g.FieldPath?g.__PRIVATE_parseUpdateVarargs(this._dataReader,"Transaction.update",s._key,t,r,i):g.__PRIVATE_parseUpdateData(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=lr(e,this._firestore);return this._transaction.delete(t._key),this}};var Sl=class extends jg{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=lr(e,this._firestore),r=new g.__PRIVATE_ExpUserDataWriter(this._firestore);return super.get(e).then((i=>new ht(this._firestore,r,t._key,i._document,new Mt(!1,!1),t.converter)))}};function eO(n,e,t){n=g.__PRIVATE_cast(n,g.Firestore);let r={...ZV,...t};(function(o){if(o.maxAttempts<1)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);let i=g.ensureFirestoreConfigured(n);return g.__PRIVATE_firestoreClientTransaction(i,(s=>e(new Sl(n,s))),r)}function tO(n){n=g.__PRIVATE_cast(n,g.DocumentReference);let e=g.__PRIVATE_cast(n.firestore,g.Firestore),t=g.ensureFirestoreConfigured(e);return g.__PRIVATE_firestoreClientGetDocumentViaSnapshotListener(t,n._key).then((r=>Kg(e,n,r)))}function nO(n){n=g.__PRIVATE_cast(n,g.DocumentReference);let e=g.__PRIVATE_cast(n.firestore,g.Firestore),t=g.ensureFirestoreConfigured(e),r=new g.__PRIVATE_ExpUserDataWriter(e);return g.__PRIVATE_firestoreClientGetDocumentFromLocalCache(t,n._key).then((i=>new ht(e,r,n._key,i,new Mt(i!==null&&i.hasLocalMutations,!0),n.converter)))}function rO(n){n=g.__PRIVATE_cast(n,g.DocumentReference);let e=g.__PRIVATE_cast(n.firestore,g.Firestore),t=g.ensureFirestoreConfigured(e);return g.__PRIVATE_firestoreClientGetDocumentViaSnapshotListener(t,n._key,{source:"server"}).then((r=>Kg(e,n,r)))}function iO(n){n=g.__PRIVATE_cast(n,g.Query);let e=g.__PRIVATE_cast(n.firestore,g.Firestore),t=g.ensureFirestoreConfigured(e),r=new g.__PRIVATE_ExpUserDataWriter(e);return Zw(n._query),g.__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(t,n._query).then((i=>new dt(e,r,n,i)))}function sO(n){n=g.__PRIVATE_cast(n,g.Query);let e=g.__PRIVATE_cast(n.firestore,g.Firestore),t=g.ensureFirestoreConfigured(e),r=new g.__PRIVATE_ExpUserDataWriter(e);return g.__PRIVATE_firestoreClientGetDocumentsFromLocalCache(t,n._query).then((i=>new dt(e,r,n,i)))}function oO(n){n=g.__PRIVATE_cast(n,g.Query);let e=g.__PRIVATE_cast(n.firestore,g.Firestore),t=g.ensureFirestoreConfigured(e),r=new g.__PRIVATE_ExpUserDataWriter(e);return g.__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(t,n._query,{source:"server"}).then((i=>new dt(e,r,n,i)))}function aO(n,e,t){n=g.__PRIVATE_cast(n,g.DocumentReference);let r=g.__PRIVATE_cast(n.firestore,g.Firestore),i=kl(n.converter,e,t),s=g.__PRIVATE_newUserDataReader(r);return us(r,[g.__PRIVATE_parseSetData(s,"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,g.Precondition.none())])}function cO(n,e,t,...r){n=g.__PRIVATE_cast(n,g.DocumentReference);let i=g.__PRIVATE_cast(n.firestore,g.Firestore),s=g.__PRIVATE_newUserDataReader(i),o;return o=typeof(e=En.getModularInstance(e))=="string"||e instanceof g.FieldPath?g.__PRIVATE_parseUpdateVarargs(s,"updateDoc",n._key,e,t,r):g.__PRIVATE_parseUpdateData(s,"updateDoc",n._key,e),us(i,[o.toMutation(n._key,g.Precondition.exists(!0))])}function uO(n){return us(g.__PRIVATE_cast(n.firestore,g.Firestore),[new g.__PRIVATE_DeleteMutation(n._key,g.Precondition.none())])}function lO(n,e){let t=g.__PRIVATE_cast(n.firestore,g.Firestore),r=g.doc(n),i=kl(n.converter,e),s=g.__PRIVATE_newUserDataReader(n.firestore);return us(t,[g.__PRIVATE_parseSetData(s,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,g.Precondition.exists(!1))]).then((()=>r))}function Gg(n,...e){n=En.getModularInstance(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||as(e[r])||(t=e[r++]);let i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(as(e[r])){let l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let s,o,c;if(n instanceof g.DocumentReference)o=g.__PRIVATE_cast(n.firestore,g.Firestore),c=g.__PRIVATE_newQueryForPath(n._key.path),s={next:l=>{e[r]&&e[r](Kg(o,n,l))},error:e[r+1],complete:e[r+2]};else{let l=g.__PRIVATE_cast(n,g.Query);o=g.__PRIVATE_cast(l.firestore,g.Firestore),c=l._query;let d=new g.__PRIVATE_ExpUserDataWriter(o);s={next:p=>{e[r]&&e[r](new dt(o,d,l,p))},error:e[r+1],complete:e[r+2]},Zw(n._query)}let u=g.ensureFirestoreConfigured(o);return g.__PRIVATE_firestoreClientListen(u,c,i,s)}function hO(n,e,...t){let r=En.getModularInstance(n),i=(function(u){let l={bundle:"",bundleName:"",bundleSource:""},d=["bundle","bundleName","bundleSource"];for(let p of d){if(!(p in u)){l.error=`snapshotJson missing required field: ${p}`;break}let m=u[p];if(typeof m!="string"){l.error=`snapshotJson field '${p}' must be a string.`;break}if(m.length===0){l.error=`snapshotJson field '${p}' cannot be an empty string.`;break}p==="bundle"?l.bundle=m:p==="bundleName"?l.bundleName=m:p==="bundleSource"&&(l.bundleSource=m)}return l})(e);if(i.error)throw new g.FirestoreError(g.C.INVALID_ARGUMENT,i.error);let s,o=0;if(typeof t[o]!="object"||as(t[o])||(s=t[o++]),i.bundleSource==="QuerySnapshot"){let c=null;if(typeof t[o]=="object"&&as(t[o])){let u=t[o++];c={next:u.next,error:u.error,complete:u.complete}}else c={next:t[o++],error:t[o++],complete:t[o++]};return(function(l,d,p,m,w){let k,V=!1;return g.loadBundle(l,d.bundle).then((()=>g.namedQuery(l,d.bundleName))).then((H=>{H&&!V&&(w&&H.withConverter(w),k=Gg(H,p||{},m))})).catch((H=>(m.error&&m.error(H),()=>{}))),()=>{V||(V=!0,k&&k())}})(r,i,s,c,t[o])}if(i.bundleSource==="DocumentSnapshot"){let c=null;if(typeof t[o]=="object"&&as(t[o])){let u=t[o++];c={next:u.next,error:u.error,complete:u.complete}}else c={next:t[o++],error:t[o++],complete:t[o++]};return(function(l,d,p,m,w){let k,V=!1;return g.loadBundle(l,d.bundle).then((()=>{if(!V){let H=new g.DocumentReference(l,w||null,g.DocumentKey.fromPath(d.bundleName));k=Gg(H,p||{},m)}})).catch((H=>(m.error&&m.error(H),()=>{}))),()=>{V||(V=!0,k&&k())}})(r,i,s,c,t[o])}throw new g.FirestoreError(g.C.INVALID_ARGUMENT,`unsupported bundle source: ${i.bundleSource}`)}function dO(n,e){n=g.__PRIVATE_cast(n,g.Firestore);let t=g.ensureFirestoreConfigured(n),r=as(e)?e:{next:e};return g.__PRIVATE_firestoreClientAddSnapshotsInSyncListener(t,r)}function us(n,e){let t=g.ensureFirestoreConfigured(n);return g.__PRIVATE_firestoreClientWrite(t,e)}function Kg(n,e,t){let r=t.docs.get(e._key),i=new g.__PRIVATE_ExpUserDataWriter(n);return new ht(n,i,e._key,r,new Mt(t.hasPendingWrites,t.fromCache),e.converter)}function fO(n){return n=g.__PRIVATE_cast(n,g.Firestore),g.ensureFirestoreConfigured(n),new Pl(n,(e=>us(n,e)))}function pO(n,e){n=g.__PRIVATE_cast(n,g.Firestore);let t=g.ensureFirestoreConfigured(n);if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return g.__PRIVATE_logWarn("Cannot enable indexes when persistence is disabled"),Promise.resolve();let r=(function(s){let o=typeof s=="string"?(function(l){try{return JSON.parse(l)}catch(d){throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"Failed to parse JSON: "+d?.message)}})(s):s,c=[];if(Array.isArray(o.indexes))for(let u of o.indexes){let l=Yw(u,"collectionGroup"),d=[];if(Array.isArray(u.fields))for(let p of u.fields){let m=Yw(p,"fieldPath"),w=g.__PRIVATE_fieldPathFromDotSeparatedString("setIndexConfiguration",m);p.arrayConfig==="CONTAINS"?d.push(new g.IndexSegment(w,2)):p.order==="ASCENDING"?d.push(new g.IndexSegment(w,0)):p.order==="DESCENDING"&&d.push(new g.IndexSegment(w,1))}c.push(new g.FieldIndex(g.FieldIndex.UNKNOWN_ID,l,d,g.IndexState.empty()))}return c})(e);return g.__PRIVATE_firestoreClientSetIndexConfiguration(t,r)}function Yw(n,e){if(typeof n[e]!="string")throw new g.FirestoreError(g.C.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}var Cl=class{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}};function gO(n){n=g.__PRIVATE_cast(n,g.Firestore);let e=Xw.get(n);if(e)return e;if(g.ensureFirestoreConfigured(n)._uninitializedComponentsProvider?._offline.kind!=="persistent")return null;let r=new Cl(n);return Xw.set(n,r),r}function mO(n){av(n,!0)}function _O(n){av(n,!1)}function yO(n){let e=g.ensureFirestoreConfigured(n._firestore);g.__PRIVATE_firestoreClientDeleteAllFieldIndexes(e).then((t=>g.__PRIVATE_logDebug("deleting all persistent cache indexes succeeded"))).catch((t=>g.__PRIVATE_logWarn("deleting all persistent cache indexes failed",t)))}function av(n,e){let t=g.ensureFirestoreConfigured(n._firestore);g.__PRIVATE_firestoreClientSetPersistentCacheIndexAutoCreationEnabled(t,e).then((r=>g.__PRIVATE_logDebug(`setting persistent cache index auto creation isEnabled=${e} succeeded`))).catch((r=>g.__PRIVATE_logWarn(`setting persistent cache index auto creation isEnabled=${e} failed`,r)))}var Xw=new WeakMap;var $g=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return Hg.instance.onExistenceFilterMismatch(e)}},Hg=class n{constructor(){this.i=new Map}static get instance(){return Al||(Al=new n,g.__PRIVATE_setTestingHooksSpi(Al)),Al}u(e){this.i.forEach((t=>t(e)))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.i;return r.set(t,e),()=>r.delete(t)}},Al=null;(function(e,t=!0){g.__PRIVATE_setSDKVersion(vl.SDK_VERSION),vl._registerComponent(new PV.Component("firestore",((r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),c=new g.Firestore(new g.__PRIVATE_FirebaseAuthCredentialsProvider(r.getProvider("auth-internal")),new g.__PRIVATE_FirebaseAppCheckTokenProvider(o,r.getProvider("app-check-internal")),g.__PRIVATE_databaseIdFromApp(o,i),o);return s={useFetchStreams:t,...s},c._setSettings(s),c}),"PUBLIC").setMultipleInstances(!0)),vl.registerVersion(Hw,Kw,e),vl.registerVersion(Hw,Kw,"cjs2020")})();O.AbstractUserDataWriter=g.AbstractUserDataWriter;O.Bytes=g.Bytes;O.CACHE_SIZE_UNLIMITED=g.on;O.CollectionReference=g.CollectionReference;O.DocumentReference=g.DocumentReference;O.FieldPath=g.FieldPath;O.FieldValue=g.FieldValue;O.Firestore=g.Firestore;O.FirestoreError=g.FirestoreError;O.GeoPoint=g.GeoPoint;O.LoadBundleTask=g.LoadBundleTask;O.Query=g.Query;O.Timestamp=g.Timestamp;O.VectorValue=g.VectorValue;O._AutoId=g.__PRIVATE_AutoId;O._ByteString=g.ByteString;O._DatabaseId=g.DatabaseId;O._DocumentKey=g.DocumentKey;O._EmptyAppCheckTokenProvider=g.__PRIVATE_EmptyAppCheckTokenProvider;O._EmptyAuthCredentialsProvider=g.__PRIVATE_EmptyAuthCredentialsProvider;O._FieldPath=g.FieldPath$1;O._cast=g.__PRIVATE_cast;O._debugAssert=g.__PRIVATE_debugAssert;O._internalAggregationQueryToProtoRunAggregationQueryRequest=g._internalAggregationQueryToProtoRunAggregationQueryRequest;O._internalQueryToProtoQueryTarget=g._internalQueryToProtoQueryTarget;O._isBase64Available=g.__PRIVATE_isBase64Available;O._logWarn=g.__PRIVATE_logWarn;O._validateIsNotUsedTogether=g.__PRIVATE_validateIsNotUsedTogether;O.arrayRemove=g.arrayRemove;O.arrayUnion=g.arrayUnion;O.clearIndexedDbPersistence=g.clearIndexedDbPersistence;O.collection=g.collection;O.collectionGroup=g.collectionGroup;O.connectFirestoreEmulator=g.connectFirestoreEmulator;O.deleteField=g.deleteField;O.disableNetwork=g.disableNetwork;O.doc=g.doc;O.documentId=g.documentId;O.enableIndexedDbPersistence=g.enableIndexedDbPersistence;O.enableMultiTabIndexedDbPersistence=g.enableMultiTabIndexedDbPersistence;O.enableNetwork=g.enableNetwork;O.ensureFirestoreConfigured=g.ensureFirestoreConfigured;O.getFirestore=g.getFirestore;O.increment=g.increment;O.initializeFirestore=g.initializeFirestore;O.loadBundle=g.loadBundle;O.namedQuery=g.namedQuery;O.queryEqual=g.queryEqual;O.refEqual=g.refEqual;O.serverTimestamp=g.serverTimestamp;O.setLogLevel=g.setLogLevel;O.terminate=g.terminate;O.vector=g.vector;O.waitForPendingWrites=g.waitForPendingWrites;O.AggregateField=hr;O.AggregateQuerySnapshot=bl;O.DocumentSnapshot=ht;O.PersistentCacheIndexManager=Cl;O.QueryCompositeFilterConstraint=Xr;O.QueryConstraint=dr;O.QueryDocumentSnapshot=Jr;O.QueryEndAtConstraint=Ta;O.QueryFieldFilterConstraint=cs;O.QueryLimitConstraint=Ia;O.QueryOrderByConstraint=Rl;O.QuerySnapshot=dt;O.QueryStartAtConstraint=Ea;O.SnapshotMetadata=Mt;O.Transaction=Sl;O.WriteBatch=Pl;O._TestingHooks=$g;O.addDoc=lO;O.aggregateFieldEqual=qV;O.aggregateQuerySnapshotEqual=WV;O.and=DV;O.average=BV;O.count=rv;O.deleteAllPersistentCacheIndexes=yO;O.deleteDoc=uO;O.disablePersistentCacheIndexAutoCreation=_O;O.documentSnapshotFromJSON=QV;O.enablePersistentCacheIndexAutoCreation=mO;O.endAt=FV;O.endBefore=MV;O.executeWrite=us;O.getAggregateFromServer=iv;O.getCountFromServer=zV;O.getDoc=tO;O.getDocFromCache=nO;O.getDocFromServer=rO;O.getDocs=iO;O.getDocsFromCache=sO;O.getDocsFromServer=oO;O.getPersistentCacheIndexManager=gO;O.limit=VV;O.limitToLast=OV;O.memoryEagerGarbageCollector=jV;O.memoryLocalCache=$V;O.memoryLruGarbageCollector=GV;O.onSnapshot=Gg;O.onSnapshotResume=hO;O.onSnapshotsInSync=dO;O.or=kV;O.orderBy=NV;O.persistentLocalCache=HV;O.persistentMultipleTabManager=KV;O.persistentSingleTabManager=sv;O.query=SV;O.querySnapshotFromJSON=JV;O.runTransaction=eO;O.setDoc=aO;O.setIndexConfiguration=pO;O.snapshotEqual=XV;O.startAfter=LV;O.startAt=xV;O.sum=UV;O.updateDoc=cO;O.where=CV;O.writeBatch=fO});var gv=Ne(tm=>{"use strict";Object.defineProperty(tm,"__esModule",{value:!0});var IO=js(),q=cv(),hv=Pt(),EO=qt();function TO(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var wO=TO(IO),vO="@firebase/firestore-compat",AO="0.4.5";function em(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new q.FirestoreError("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function uv(){if(typeof Uint8Array>"u")throw new q.FirestoreError("unimplemented","Uint8Arrays are not available in this environment.")}function lv(){if(!q._isBase64Available())throw new q.FirestoreError("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Dl=class n{constructor(e){this._delegate=e}static fromBase64String(e){return lv(),new n(q.Bytes.fromBase64String(e))}static fromUint8Array(e){return uv(),new n(q.Bytes.fromUint8Array(e))}toBase64(){return lv(),this._delegate.toBase64()}toUint8Array(){return uv(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Qg(n){return bO(n,["next","error","complete"])}function bO(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var Jg=class{enableIndexedDbPersistence(e,t){return q.enableIndexedDbPersistence(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return q.enableMultiTabIndexedDbPersistence(e._delegate)}clearIndexedDbPersistence(e){return q.clearIndexedDbPersistence(e._delegate)}},Nl=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof q._DatabaseId||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&q._logWarn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){q.connectFirestoreEmulator(this._delegate,e,t,r)}enableNetwork(){return q.enableNetwork(this._delegate)}disableNetwork(){return q.disableNetwork(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,q._validateIsNotUsedTogether("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return q.waitForPendingWrites(this._delegate)}onSnapshotsInSync(e){return q.onSnapshotsInSync(this._delegate,e)}get app(){if(!this._appCompat)throw new q.FirestoreError("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ds(this,q.collection(this._delegate,e))}catch(t){throw it(t,"collection()","Firestore.collection()")}}doc(e){try{return new tn(this,q.doc(this._delegate,e))}catch(t){throw it(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ni(this,q.collectionGroup(this._delegate,e))}catch(t){throw it(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return q.runTransaction(this._delegate,t=>e(new Vl(this,t)))}batch(){return q.ensureFirestoreConfigured(this._delegate),new Ol(new q.WriteBatch(this._delegate,e=>q.executeWrite(this._delegate,e)))}loadBundle(e){return q.loadBundle(this._delegate,e)}namedQuery(e){return q.namedQuery(this._delegate,e).then(t=>t?new ni(this,t):null)}},ls=class extends q.AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dl(new q.Bytes(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return tn.forKey(t,this.firestore,null)}};function RO(n){q.setLogLevel(n)}var Vl=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ls(e)}get(e){let t=Zr(e);return this._delegate.get(t).then(r=>new ei(this._firestore,new q.DocumentSnapshot(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Zr(e);return r?(em("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Zr(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Zr(e);return this._delegate.delete(t),this}},Ol=class{constructor(e){this._delegate=e}set(e,t,r){let i=Zr(e);return r?(em("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Zr(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Zr(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},hs=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new q.QueryDocumentSnapshot(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ti(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new ls(e),t),i.set(t,s)),s}};hs.INSTANCES=new WeakMap;var tn=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ls(e)}static forPath(e,t,r){if(e.length%2!==0)throw new q.FirestoreError("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new q.DocumentReference(t._delegate,r,new q._DocumentKey(e)))}static forKey(e,t,r){return new n(t,new q.DocumentReference(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ds(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ds(this.firestore,q.collection(this._delegate,e))}catch(t){throw it(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=hv.getModularInstance(e),e instanceof q.DocumentReference?q.refEqual(this._delegate,e):!1}set(e,t){t=em("DocumentReference.set",t);try{return t?q.setDoc(this._delegate,e,t):q.setDoc(this._delegate,e)}catch(r){throw it(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?q.updateDoc(this._delegate,e):q.updateDoc(this._delegate,e,t,...r)}catch(i){throw it(i,"updateDoc()","DocumentReference.update()")}}delete(){return q.deleteDoc(this._delegate)}onSnapshot(...e){let t=dv(e),r=fv(e,i=>new ei(this.firestore,new q.DocumentSnapshot(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return q.onSnapshot(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=q.getDocFromCache(this._delegate):e?.source==="server"?t=q.getDocFromServer(this._delegate):t=q.getDoc(this._delegate),t.then(r=>new ei(this.firestore,new q.DocumentSnapshot(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(hs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function it(n,e,t){return n.message=n.message.replace(e,t),n}function dv(n){for(let e of n)if(typeof e=="object"&&!Qg(e))return e;return{}}function fv(n,e){let t;return Qg(n[0])?t=n[0]:Qg(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}var ei=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new tn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return q.snapshotEqual(this._delegate,e._delegate)}},ti=class extends ei{data(e){let t=this._delegate.data(e);return this._delegate._converter||q._debugAssert(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},ni=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ls(e)}where(e,t,r){try{return new n(this.firestore,q.query(this._delegate,q.where(e,t,r)))}catch(i){throw it(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,q.query(this._delegate,q.orderBy(e,t)))}catch(r){throw it(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,q.query(this._delegate,q.limit(e)))}catch(t){throw it(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,q.query(this._delegate,q.limitToLast(e)))}catch(t){throw it(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,q.query(this._delegate,q.startAt(...e)))}catch(t){throw it(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,q.query(this._delegate,q.startAfter(...e)))}catch(t){throw it(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,q.query(this._delegate,q.endBefore(...e)))}catch(t){throw it(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,q.query(this._delegate,q.endAt(...e)))}catch(t){throw it(t,"endAt()","Query.endAt()")}}isEqual(e){return q.queryEqual(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=q.getDocsFromCache(this._delegate):e?.source==="server"?t=q.getDocsFromServer(this._delegate):t=q.getDocs(this._delegate),t.then(r=>new va(this.firestore,new q.QuerySnapshot(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=dv(e),r=fv(e,i=>new va(this.firestore,new q.QuerySnapshot(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return q.onSnapshot(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(hs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Yg=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ti(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},va=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ni(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ti(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Yg(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new ti(this._firestore,r))})}isEqual(e){return q.snapshotEqual(this._delegate,e._delegate)}},ds=class n extends ni{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new tn(this.firestore,e):null}doc(e){try{return e===void 0?new tn(this.firestore,q.doc(this._delegate)):new tn(this.firestore,q.doc(this._delegate,e))}catch(t){throw it(t,"doc()","CollectionReference.doc()")}}add(e){return q.addDoc(this._delegate,e).then(t=>new tn(this.firestore,t))}isEqual(e){return q.refEqual(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(hs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Zr(n){return q._cast(n,q.DocumentReference)}var Xg=class n{constructor(...e){this._delegate=new q.FieldPath(...e)}static documentId(){return new n(q._FieldPath.keyField().canonicalString())}isEqual(e){return e=hv.getModularInstance(e),e instanceof q.FieldPath?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Zg=class n{static serverTimestamp(){let e=q.serverTimestamp();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=q.deleteField();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=q.arrayUnion(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=q.arrayRemove(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=q.increment(e);return t._methodName="FieldValue.increment",new n(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var PO={Firestore:Nl,GeoPoint:q.GeoPoint,Timestamp:q.Timestamp,Blob:Dl,Transaction:Vl,WriteBatch:Ol,DocumentReference:tn,DocumentSnapshot:ei,Query:ni,QueryDocumentSnapshot:ti,QuerySnapshot:va,CollectionReference:ds,FieldPath:Xg,FieldValue:Zg,setLogLevel:RO,CACHE_SIZE_UNLIMITED:q.CACHE_SIZE_UNLIMITED};function SO(n,e){n.INTERNAL.registerComponent(new EO.Component("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps({...PO}))}function pv(n){SO(n,(e,t)=>new Nl(e,t,new Jg)),n.registerVersion(vO,AO)}pv(wO.default);tm.registerFirestore=pv});var mv=Ne(()=>{"use strict";gv()});var Qv=Ne(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});var ri=Er(),Fe=Pt(),CO=qt();var bv="firebasestorage.googleapis.com",Rv="storageBucket",kO=120*1e3,DO=600*1e3,NO=1e3;var Ae=class n extends Fe.FirebaseError{constructor(e,t,r=0){super(nm(e),`Firebase Storage: ${t} (${nm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return nm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};ee.StorageErrorCode=void 0;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ee.StorageErrorCode||(ee.StorageErrorCode={}));function nm(n){return"storage/"+n}function hm(){let n="An unknown error occurred, please check the error payload for server response.";return new Ae(ee.StorageErrorCode.UNKNOWN,n)}function VO(n){return new Ae(ee.StorageErrorCode.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function OO(n){return new Ae(ee.StorageErrorCode.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function xO(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ae(ee.StorageErrorCode.UNAUTHENTICATED,n)}function LO(){return new Ae(ee.StorageErrorCode.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function MO(n){return new Ae(ee.StorageErrorCode.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Pv(){return new Ae(ee.StorageErrorCode.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Sv(){return new Ae(ee.StorageErrorCode.CANCELED,"User canceled the upload/download.")}function FO(n){return new Ae(ee.StorageErrorCode.INVALID_URL,"Invalid URL '"+n+"'.")}function UO(n){return new Ae(ee.StorageErrorCode.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function BO(){return new Ae(ee.StorageErrorCode.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Rv+"' property when initializing the app?")}function Cv(){return new Ae(ee.StorageErrorCode.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function qO(){return new Ae(ee.StorageErrorCode.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function WO(){return new Ae(ee.StorageErrorCode.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function zO(n){return new Ae(ee.StorageErrorCode.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ll(n){return new Ae(ee.StorageErrorCode.INVALID_ARGUMENT,n)}function kv(){return new Ae(ee.StorageErrorCode.APP_DELETED,"The Firebase app was deleted.")}function Dv(n){return new Ae(ee.StorageErrorCode.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ba(n,e){return new Ae(ee.StorageErrorCode.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Aa(n){throw new Ae(ee.StorageErrorCode.INTERNAL_ERROR,"Internal error: "+n)}var ft=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw UO(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(te){te.path.charAt(te.path.length-1)==="/"&&(te.path_=te.path_.slice(0,-1))}let o="(/(.*))?$",c=new RegExp("^gs://"+i+o,"i"),u={bucket:1,path:3};function l(te){te.path_=decodeURIComponent(te.path)}let d="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",w=new RegExp(`^https?://${p}/${d}/b/${i}/o${m}`,"i"),k={bucket:1,path:3},V=t===bv?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",H=new RegExp(`^https?://${V}/${i}/${x}`,"i"),K=[{regex:c,indices:u,postModify:s},{regex:w,indices:k,postModify:l},{regex:H,indices:{bucket:1,path:2},postModify:l}];for(let te=0;te<K.length;te++){let ae=K[te],ie=ae.regex.exec(e);if(ie){let T=ie[ae.indices.bucket],y=ie[ae.indices.path];y||(y=""),r=new n(T,y),ae.postModify(r);break}}if(r==null)throw FO(e);return r}},im=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function jO(n,e,t){let r=1,i=null,s=null,o=!1,c=0;function u(){return c===2}let l=!1;function d(...x){l||(l=!0,e.apply(null,x))}function p(x){i=setTimeout(()=>{i=null,n(w,u())},x)}function m(){s&&clearTimeout(s)}function w(x,...H){if(l){m();return}if(x){m(),d.call(null,x,...H);return}if(u()||o){m(),d.call(null,x,...H);return}r<64&&(r*=2);let K;c===1?(c=2,K=0):K=(r+Math.random())*1e3,p(K)}let k=!1;function V(x){k||(k=!0,m(),!l&&(i!==null?(x||(c=2),clearTimeout(i),p(0)):x||(c=1)))}return p(0),s=setTimeout(()=>{o=!0,V(!0)},t),V}function GO(n){n(!1)}function $O(n){return n!==void 0}function HO(n){return typeof n=="function"}function KO(n){return typeof n=="object"&&!Array.isArray(n)}function Ul(n){return typeof n=="string"||n instanceof String}function _v(n){return dm()&&n instanceof Blob}function dm(){return typeof Blob<"u"}function sm(n,e,t,r){if(r<e)throw Ll(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ll(`Invalid value for '${n}'. Expected ${t} or less.`)}function Tn(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Nv(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var ii;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(ii||(ii={}));function Vv(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var om=class{constructor(e,t,r,i,s,o,c,u,l,d,p,m=!0,w=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=u,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=p,this.retry=m,this.isUsingEmulator=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((k,V)=>{this.resolve_=k,this.reject_=V,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new ps(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=c=>{let u=c.loaded,l=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let c=s.getErrorCode()===ii.NO_ERROR,u=s.getStatus();if(!c||Vv(u,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===ii.ABORT;r(!1,new ps(!1,null,d));return}let l=this.successCodes_.indexOf(u)!==-1;r(!0,new ps(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,c=i.connection;if(i.wasSuccessCode)try{let u=this.callback_(c,c.getResponse());$O(u)?s(u):s()}catch(u){o(u)}else if(c!==null){let u=hm();u.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,u)):o(u)}else if(i.canceled){let u=this.appDelete_?kv():Sv();o(u)}else{let u=Pv();o(u)}};this.canceled_?t(!1,new ps(!1,null,!0)):this.backoffId_=jO(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&GO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},ps=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function QO(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function JO(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function YO(n,e){e&&(n["X-Firebase-GMPID"]=e)}function XO(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function ZO(n,e,t,r,i,s,o=!0,c=!1){let u=Nv(n.urlParams),l=n.url+u,d=Object.assign({},n.headers);return YO(d,e),QO(d,t),JO(d,s),XO(d,r),new om(l,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o,c)}function e1(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function t1(...n){let e=e1();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(dm())return new Blob(n);throw new Ae(ee.StorageErrorCode.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function n1(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function r1(n){if(typeof atob>"u")throw zO("base-64");return atob(n)}var bt={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Ra=class{constructor(e,t){this.data=e,this.contentType=t||null}};function fm(n,e){switch(n){case bt.RAW:return new Ra(Ov(e));case bt.BASE64:case bt.BASE64URL:return new Ra(xv(n,e));case bt.DATA_URL:return new Ra(s1(e),o1(e))}throw hm()}function Ov(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function i1(n){let e;try{e=decodeURIComponent(n)}catch{throw ba(bt.DATA_URL,"Malformed data URL.")}return Ov(e)}function xv(n,e){switch(n){case bt.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw ba(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case bt.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw ba(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=r1(e)}catch(i){throw i.message.includes("polyfill")?i:ba(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Ml=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw ba(bt.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=a1(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function s1(n){let e=new Ml(n);return e.base64?xv(bt.BASE64,e.rest):i1(e.rest)}function o1(n){return new Ml(n).contentType}function a1(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var gs=class n{constructor(e,t){let r=0,i="";_v(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(_v(this.data_)){let r=this.data_,i=n1(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(dm()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(t1.apply(null,t))}else{let t=e.map(o=>Ul(o)?fm(bt.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let c=0;c<o.length;c++)i[s++]=o[c]}),new n(i,!0)}}uploadData(){return this.data_}};function pm(n){let e;try{e=JSON.parse(n)}catch{return null}return KO(e)?e:null}function c1(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function u1(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function Lv(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function l1(n,e){return e}var Ge=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||l1}},xl=null;function h1(n){return!Ul(n)||n.length<2?n:Lv(n)}function Ca(){if(xl)return xl;let n=[];n.push(new Ge("bucket")),n.push(new Ge("generation")),n.push(new Ge("metageneration")),n.push(new Ge("name","fullPath",!0));function e(s,o){return h1(o)}let t=new Ge("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new Ge("size");return i.xform=r,n.push(i),n.push(new Ge("timeCreated")),n.push(new Ge("updated")),n.push(new Ge("md5Hash",null,!0)),n.push(new Ge("cacheControl",null,!0)),n.push(new Ge("contentDisposition",null,!0)),n.push(new Ge("contentEncoding",null,!0)),n.push(new Ge("contentLanguage",null,!0)),n.push(new Ge("contentType",null,!0)),n.push(new Ge("metadata","customMetadata",!0)),xl=n,xl}function d1(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new ft(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function f1(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return d1(r,n),r}function Mv(n,e,t){let r=pm(e);return r===null?null:f1(n,r,t)}function p1(n,e,t,r){let i=pm(e);if(i===null||!Ul(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,p=n.fullPath,m="/b/"+o(d)+"/o/"+o(p),w=Tn(m,t,r),k=Nv({alt:"media",token:l});return w+k})[0]}function gm(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var yv="prefixes",Iv="items";function g1(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[yv])for(let i of t[yv]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new ft(e,s));r.prefixes.push(o)}if(t[Iv])for(let i of t[Iv]){let s=n._makeStorageReference(new ft(e,i.name));r.items.push(s)}return r}function m1(n,e,t){let r=pm(t);return r===null?null:g1(n,e,r)}var Rt=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function nn(n){if(!n)throw hm()}function Bl(n,e){function t(r,i){let s=Mv(n,i,e);return nn(s!==null),s}return t}function _1(n,e){function t(r,i){let s=m1(n,e,i);return nn(s!==null),s}return t}function y1(n,e){function t(r,i){let s=Mv(n,i,e);return nn(s!==null),p1(s,i,n.host,n._protocol)}return t}function ys(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=LO():i=xO():t.getStatus()===402?i=OO(n.bucket):t.getStatus()===403?i=MO(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function ka(n){let e=ys(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=VO(n.path)),s.serverResponse=i.serverResponse,s}return t}function Fv(n,e,t){let r=e.fullServerUrl(),i=Tn(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,c=new Rt(i,s,Bl(n,t),o);return c.errorHandler=ka(e),c}function I1(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),c=Tn(o,n.host,n._protocol),u="GET",l=n.maxOperationRetryTime,d=new Rt(c,u,_1(n,e.bucket),l);return d.urlParams=s,d.errorHandler=ys(e),d}function Uv(n,e,t){let r=e.fullServerUrl(),i=Tn(r,n.host,n._protocol)+"?alt=media",s="GET",o=n.maxOperationRetryTime,c=new Rt(i,s,(u,l)=>l,o);return c.errorHandler=ka(e),t!==void 0&&(c.headers.Range=`bytes=0-${t}`,c.successCodes=[200,206]),c}function E1(n,e,t){let r=e.fullServerUrl(),i=Tn(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,c=new Rt(i,s,y1(n,t),o);return c.errorHandler=ka(e),c}function T1(n,e,t,r){let i=e.fullServerUrl(),s=Tn(i,n.host,n._protocol),o="PATCH",c=gm(t,r),u={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new Rt(s,o,Bl(n,r),l);return d.headers=u,d.body=c,d.errorHandler=ka(e),d}function w1(n,e){let t=e.fullServerUrl(),r=Tn(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(u,l){}let c=new Rt(r,i,o,s);return c.successCodes=[200,204],c.errorHandler=ka(e),c}function v1(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Bv(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=v1(null,e)),r}function qv(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function c(){let K="";for(let te=0;te<2;te++)K=K+Math.random().toString().slice(2);return K}let u=c();o["Content-Type"]="multipart/related; boundary="+u;let l=Bv(e,r,i),d=gm(l,t),p="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+l.contentType+`\r
\r
`,m=`\r
--`+u+"--",w=gs.getBlob(p,r,m);if(w===null)throw Cv();let k={name:l.fullPath},V=Tn(s,n.host,n._protocol),x="POST",H=n.maxUploadRetryTime,X=new Rt(V,x,Bl(n,t),H);return X.urlParams=k,X.headers=o,X.body=w.uploadData(),X.errorHandler=ys(e),X}var ms=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function mm(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{nn(!1)}return nn(!!t&&(e||["active"]).indexOf(t)!==-1),t}function A1(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=Bv(e,r,i),c={name:o.fullPath},u=Tn(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},p=gm(o,t),m=n.maxUploadRetryTime;function w(V){mm(V);let x;try{x=V.getResponseHeader("X-Goog-Upload-URL")}catch{nn(!1)}return nn(Ul(x)),x}let k=new Rt(u,l,w,m);return k.urlParams=c,k.headers=d,k.body=p,k.errorHandler=ys(e),k}function b1(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=mm(l,["active","final"]),p=null;try{p=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{nn(!1)}p||nn(!1);let m=Number(p);return nn(!isNaN(m)),new ms(m,r.size(),d==="final")}let o="POST",c=n.maxUploadRetryTime,u=new Rt(t,o,s,c);return u.headers=i,u.errorHandler=ys(e),u}var Ev=256*1024;function R1(n,e,t,r,i,s,o,c){let u=new ms(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw qO();let l=u.total-u.current,d=l;i>0&&(d=Math.min(d,i));let p=u.current,m=p+d,w="";d===0?w="finalize":l===d?w="upload, finalize":w="upload";let k={"X-Goog-Upload-Command":w,"X-Goog-Upload-Offset":`${u.current}`},V=r.slice(p,m);if(V===null)throw Cv();function x(te,ae){let ie=mm(te,["active","final"]),T=u.current+d,y=r.size(),E;return ie==="final"?E=Bl(e,s)(te,ae):E=null,new ms(T,y,ie==="final",E)}let H="POST",X=e.maxUploadRetryTime,K=new Rt(t,H,x,X);return K.headers=k,K.body=V.uploadData(),K.progressCallback=c||null,K.errorHandler=ys(n),K}var P1={STATE_CHANGED:"state_changed"},st={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function rm(n){switch(n){case"running":case"pausing":case"canceling":return st.RUNNING;case"paused":return st.PAUSED;case"success":return st.SUCCESS;case"canceled":return st.CANCELED;case"error":return st.ERROR;default:return st.ERROR}}var am=class{constructor(e,t,r){if(HO(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function fs(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var Tv=null,Pa=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ii.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ii.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ii.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i,s){if(this.sent_)throw Aa("cannot .send() more than once");if(Fe.isCloudWorkstation(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(let o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Aa("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Aa("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Aa("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Aa("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},cm=class extends Pa{initXhr(){this.xhr_.responseType="text"}};function Ft(){return Tv?Tv():new cm}var um=class extends Pa{initXhr(){this.xhr_.responseType="arraybuffer"}};function S1(){return new um}var lm=class extends Pa{initXhr(){this.xhr_.responseType="blob"}};function C1(){return new lm}var Fl=class{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=Ca(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(ee.StorageErrorCode.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(Vv(i.status,[]))if(s)i=Pv();else{this.sleepTime=Math.max(this.sleepTime*2,NO),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(ee.StorageErrorCode.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=A1(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ft,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=b1(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Ft,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=Ev*this._chunkMultiplier,t=new ms(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=R1(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(u){this._error=u,this._transition("error");return}let c=this._ref.storage._makeRequest(o,Ft,i,s,!1);this._request=c,c.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){Ev*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=Fv(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ft,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=qv(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ft,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=Sv(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=rm(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new am(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(rm(this._state)){case st.SUCCESS:fs(this._resolve.bind(null,this.snapshot))();break;case st.CANCELED:case st.ERROR:let t=this._reject;fs(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(rm(this._state)){case st.RUNNING:case st.PAUSED:e.next&&fs(e.next.bind(e,this.snapshot))();break;case st.SUCCESS:e.complete&&fs(e.complete.bind(e))();break;case st.CANCELED:case st.ERROR:e.error&&fs(e.error.bind(e,this._error))();break;default:e.error&&fs(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var _s=class n{constructor(e,t){this._service=e,t instanceof ft?this._location=t:this._location=ft.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new ft(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Lv(this._location.path)}get storage(){return this._service}get parent(){let e=c1(this._location.path);if(e===null)return null;let t=new ft(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Dv(e)}};function k1(n,e){n._throwIfRoot("getBytes");let t=Uv(n.storage,n._location,e);return n.storage.makeRequestWithTokens(t,S1).then(r=>e!==void 0?r.slice(0,e):r)}function D1(n,e){n._throwIfRoot("getBlob");let t=Uv(n.storage,n._location,e);return n.storage.makeRequestWithTokens(t,C1).then(r=>e!==void 0?r.slice(0,e):r)}function Wv(n,e,t){n._throwIfRoot("uploadBytes");let r=qv(n.storage,n._location,Ca(),new gs(e,!0),t);return n.storage.makeRequestWithTokens(r,Ft).then(i=>({metadata:i,ref:n}))}function N1(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new Fl(n,new gs(e),t)}function V1(n,e,t=bt.RAW,r){n._throwIfRoot("uploadString");let i=fm(t,e),s={...r};return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),Wv(n,i.data,s)}function O1(n){let e={prefixes:[],items:[]};return zv(n,e).then(()=>e)}async function zv(n,e,t){let i=await jv(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await zv(n,e,i.nextPageToken)}function jv(n,e){e!=null&&typeof e.maxResults=="number"&&sm("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=I1(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Ft)}function x1(n){n._throwIfRoot("getMetadata");let e=Fv(n.storage,n._location,Ca());return n.storage.makeRequestWithTokens(e,Ft)}function L1(n,e){n._throwIfRoot("updateMetadata");let t=T1(n.storage,n._location,e,Ca());return n.storage.makeRequestWithTokens(t,Ft)}function M1(n){n._throwIfRoot("getDownloadURL");let e=E1(n.storage,n._location,Ca());return n.storage.makeRequestWithTokens(e,Ft).then(t=>{if(t===null)throw WO();return t})}function F1(n){n._throwIfRoot("deleteObject");let e=w1(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Ft)}function Gv(n,e){let t=u1(n._location.path,e),r=new ft(n._location.bucket,t);return new _s(n.storage,r)}function U1(n){return/^[A-Za-z]+:\/\//.test(n)}function B1(n,e){return new _s(n,e)}function $v(n,e){if(n instanceof Sa){let t=n;if(t._bucket==null)throw BO();let r=new _s(t,t._bucket);return e!=null?$v(r,e):r}else return e!==void 0?Gv(n,e):n}function q1(n,e){if(e&&U1(e)){if(n instanceof Sa)return B1(n,e);throw Ll("To use ref(service, url), the first argument must be a Storage instance.")}else return $v(n,e)}function wv(n,e){let t=e?.[Rv];return t==null?null:ft.makeFromBucketSpec(t,n)}function W1(n,e,t,r={}){n.host=`${e}:${t}`;let i=Fe.isCloudWorkstation(e);i&&(Fe.pingServer(`https://${n.host}/b`),Fe.updateEmulatorBanner("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";let{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:Fe.createMockUserToken(s,n.app.options.projectId))}var Sa=class{constructor(e,t,r,i,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=bv,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=kO,this._maxUploadRetryTime=DO,this._requests=new Set,i!=null?this._bucket=ft.makeFromBucketSpec(i,this._host):this._bucket=wv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ft.makeFromBucketSpec(this._url,e):this._bucket=wv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){sm("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){sm("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ri._isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new _s(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new im(kv());{let o=ZO(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){let[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}},vv="@firebase/storage",Av="0.14.0";var Hv="storage";function z1(n,e){return n=Fe.getModularInstance(n),k1(n,e)}function j1(n,e,t){return n=Fe.getModularInstance(n),Wv(n,e,t)}function G1(n,e,t,r){return n=Fe.getModularInstance(n),V1(n,e,t,r)}function $1(n,e,t){return n=Fe.getModularInstance(n),N1(n,e,t)}function H1(n){return n=Fe.getModularInstance(n),x1(n)}function K1(n,e){return n=Fe.getModularInstance(n),L1(n,e)}function Q1(n,e){return n=Fe.getModularInstance(n),jv(n,e)}function J1(n){return n=Fe.getModularInstance(n),O1(n)}function Y1(n){return n=Fe.getModularInstance(n),M1(n)}function X1(n){return n=Fe.getModularInstance(n),F1(n)}function Z1(n,e){return n=Fe.getModularInstance(n),q1(n,e)}function ex(n,e){return Gv(n,e)}function tx(n=ri.getApp(),e){n=Fe.getModularInstance(n);let r=ri._getProvider(n,Hv).getImmediate({identifier:e}),i=Fe.getDefaultEmulatorHostnameAndPort("storage");return i&&Kv(r,...i),r}function Kv(n,e,t,r={}){W1(n,e,t,r)}function nx(n,e){return n=Fe.getModularInstance(n),D1(n,e)}function rx(n,e){throw new Error("getStream() is only supported by NodeJS builds")}function ix(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Sa(t,r,i,e,ri.SDK_VERSION)}function sx(){ri._registerComponent(new CO.Component(Hv,ix,"PUBLIC").setMultipleInstances(!0)),ri.registerVersion(vv,Av,""),ri.registerVersion(vv,Av,"cjs2020")}sx();ee.StorageError=Ae;ee.StringFormat=bt;ee._FbsBlob=gs;ee._Location=ft;ee._TaskEvent=P1;ee._TaskState=st;ee._UploadTask=Fl;ee._dataFromString=fm;ee._getChild=ex;ee._invalidArgument=Ll;ee._invalidRootOperation=Dv;ee.connectStorageEmulator=Kv;ee.deleteObject=X1;ee.getBlob=nx;ee.getBytes=z1;ee.getDownloadURL=Y1;ee.getMetadata=H1;ee.getStorage=tx;ee.getStream=rx;ee.list=Q1;ee.listAll=J1;ee.ref=Z1;ee.updateMetadata=K1;ee.uploadBytes=j1;ee.uploadBytesResumable=$1;ee.uploadString=G1});var Xv=Ne(_m=>{"use strict";Object.defineProperty(_m,"__esModule",{value:!0});var ox=js(),Pe=Qv(),ax=qt();function cx(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var ux=cx(ox);var Is=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var ql=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Is(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new Is(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new Is(o,this,this._ref)):s={next:t.next?o=>t.next(new Is(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},Wl=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new si(e,this._service))}get items(){return this._delegate.items.map(e=>new si(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var si=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=Pe._getChild(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new ql(Pe.uploadBytesResumable(this._delegate,e,t),this)}putString(e,t=Pe.StringFormat.RAW,r){this._throwIfRoot("putString");let i=Pe._dataFromString(t,e),s={...r};return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new ql(new Pe._UploadTask(this._delegate,new Pe._FbsBlob(i.data,!0),s),this)}listAll(){return Pe.listAll(this._delegate).then(e=>new Wl(e,this.storage))}list(e){return Pe.list(this._delegate,e||void 0).then(t=>new Wl(t,this.storage))}getMetadata(){return Pe.getMetadata(this._delegate)}updateMetadata(e){return Pe.updateMetadata(this._delegate,e)}getDownloadURL(){return Pe.getDownloadURL(this._delegate)}delete(){return this._throwIfRoot("delete"),Pe.deleteObject(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw Pe._invalidRootOperation(e)}};var zl=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(Jv(e))throw Pe._invalidArgument("ref() expected a child path but got a URL, use refFromURL instead.");return new si(Pe.ref(this._delegate,e),this)}refFromURL(e){if(!Jv(e))throw Pe._invalidArgument("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Pe._Location.makeFromUrl(e,this._delegate.host)}catch{throw Pe._invalidArgument("refFromUrl() expected a valid full URL but got an invalid one.")}return new si(Pe.ref(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){Pe.connectStorageEmulator(this._delegate,e,t,r)}};function Jv(n){return/^[A-Za-z]+:\/\//.test(n)}var lx="@firebase/storage-compat",hx="0.4.0";var dx="storage-compat";function fx(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new zl(t,r)}function Yv(n){let e={TaskState:Pe._TaskState,TaskEvent:Pe._TaskEvent,StringFormat:Pe.StringFormat,Storage:zl,Reference:si};n.INTERNAL.registerComponent(new ax.Component(dx,fx,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(lx,hx)}Yv(ux.default);_m.registerStorage=Yv});var Zv=Ne(()=>{"use strict";Xv()});var ym=cy();DI();mv();Zv();window.firebase=ym;var px={apiKey:"AIzaSyCfd3VJ64beQb2vazBHWCXJQuaOhwIWZk8",authDomain:"paginadoc-5a1fb.firebaseapp.com",projectId:"paginadoc-5a1fb",storageBucket:"paginadoc-5a1fb.firebasestorage.app",messagingSenderId:"896573390284",appId:"1:896573390284:web:5bcb1cd3f20001c119f169"};ym.apps.length||ym.initializeApp(px);window.firebaseConfigured=!0;console.log("\u2705 Firebase bundle cargado correctamente");})();
/*! Bundled license information:

@firebase/util/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/component/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/logger/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app-compat/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

firebase/compat/app/dist/index.cjs.js:
@firebase/auth-compat/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/browser-cjs/index-5213293b.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/browser-cjs/internal.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/webchannel-wrapper/dist/bloom-blob/bloom_blob_es2018.js:
@firebase/webchannel-wrapper/dist/webchannel-blob/webchannel_blob_es2018.js:
  (** @license
  Copyright The Closure Library Authors.
  SPDX-License-Identifier: Apache-2.0
  *)
  (** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  *)

@firebase/firestore/dist/common-352394f8.cjs.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law | agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore-compat/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage-compat/dist/index.cjs.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *  http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
